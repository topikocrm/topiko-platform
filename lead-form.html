<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topiko - Complete Business Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8f6ff 0%, #f0ebff 50%, #e8e0ff 100%);
            min-height: 100vh;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* üÜï BACK BUTTON STYLES */
        .back-button {
            position: fixed;
            top: 1rem;
            left: 1rem;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1010;
            color: rgba(107, 70, 193, 0.8);
            font-size: 1.2rem;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(107, 70, 193, 0.2);
        }

        .back-button.hidden {
            display: none;
        }

        /* üÜï RESPONSIVE PROGRESS BAR */
        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(139, 111, 205, 0.1);
            padding: 1rem;
            box-shadow: 0 2px 20px rgba(139, 111, 205, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .progress-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 0 0 auto;
            min-width: 70px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 12px;
        }

        .progress-step:hover {
            background: rgba(139, 111, 205, 0.05);
        }

        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 50px;
            width: 20px;
            height: 3px;
            background: #e5e7eb;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .progress-step.completed:not(:last-child)::after {
            background: linear-gradient(90deg, #8b6fcd, #6b46c1);
        }

        .progress-step.in-progress:not(:last-child)::after {
            background: linear-gradient(90deg, #8b6fcd 50%, #e5e7eb 50%);
        }

        .progress-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #e5e7eb;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.8rem;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .progress-step.completed .progress-circle {
            background: linear-gradient(135deg, #8b6fcd, #6b46c1);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.3);
        }

        .progress-step.in-progress .progress-circle {
            background: linear-gradient(135deg, #8b6fcd, #6b46c1);
            color: white;
            border-color: rgba(139, 111, 205, 0.3);
            animation: pulse 2s infinite;
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(139, 111, 205, 0.4);
        }

        .progress-label {
            margin-top: 0.5rem;
            font-size: 0.7rem;
            font-weight: 500;
            color: #6b7280;
            text-align: center;
            transition: all 0.3s ease;
            line-height: 1.2;
        }

        .progress-step.completed .progress-label {
            color: #6b46c1;
            font-weight: 600;
        }

        .progress-step.in-progress .progress-label {
            color: #6b46c1;
            font-weight: 700;
            font-size: 0.75rem;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1.15);
                box-shadow: 0 6px 20px rgba(139, 111, 205, 0.4);
            }
            50% { 
                transform: scale(1.2);
                box-shadow: 0 8px 25px rgba(139, 111, 205, 0.6);
            }
        }

        /* üÜï SIMPLIFIED LEAD SCORE WIDGET */
        .lead-score-widget {
            position: fixed;
            top: 100px;
            right: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(139, 111, 205, 0.2);
            border-radius: 50px;
            padding: 0.5rem 1rem;
            box-shadow: 0 8px 30px rgba(139, 111, 205, 0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .lead-score-widget:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(139, 111, 205, 0.3);
        }

        .score-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            color: white;
        }

        .score-circle.hot {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .score-circle.warm {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .score-circle.cold {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        .score-label {
            font-size: 0.8rem;
            color: #6b46c1;
            font-weight: 600;
        }

        /* ERROR DISPLAY */
        .error-display {
            position: fixed;
            top: 4rem;
            left: 1rem;
            right: 1rem;
            background: rgba(239, 68, 68, 0.95);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.8rem;
            z-index: 1001;
            display: none;
            max-width: 400px;
        }

        .error-display.show {
            display: block;
        }

        /* DEBUG PANEL */
        .debug-panel {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.7rem;
            max-width: 300px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
        }

        .debug-panel.show {
            display: block;
        }

        .debug-toggle {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1002;
            font-size: 0.7rem;
        }

        /* MAIN CONTENT - NO MORE SIDEBAR */
        .main-content {
            flex: 1;
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* CONTENT CARDS */
        .content-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(139, 111, 205, 0.1);
            border: 1px solid rgba(139, 111, 205, 0.1);
            margin-bottom: 2rem;
        }

        .content-card h2 {
            color: #6b46c1;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            letter-spacing: -1px;
            line-height: 1.2;
        }

        .content-card p {
            color: #553c9a;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        /* WELCOME SCREEN */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 60vh;
            background: linear-gradient(135deg, #faf9ff 0%, #f3f0ff 100%);
            border-radius: 20px;
            padding: 2rem;
        }

        .topiko-logo {
            font-size: 3rem;
            font-weight: 300;
            color: #6b46c1;
            letter-spacing: -2px;
            margin-bottom: 2rem;
        }

        /* BUTTONS */
        .try-free-button, .submit-button {
            background: linear-gradient(135deg, #8b6fcd 0%, #6b46c1 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 30px rgba(107, 70, 193, 0.3);
            width: 100%;
            max-width: 300px;
        }

        .try-free-button:hover, .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(107, 70, 193, 0.4);
        }

        .submit-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* FORM STYLING */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #6b46c1;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 1.5px solid rgba(139, 111, 205, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            color: #553c9a;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #8b6fcd;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 3px rgba(139, 111, 205, 0.1);
        }

        /* LANGUAGE SELECTION */
        .language-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .language-option {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .language-option:hover,
        .language-option.selected {
            background: rgba(139, 111, 205, 0.15);
            border-color: #8b6fcd;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 111, 205, 0.25);
        }

        .language-flag {
            font-size: 2rem;
            margin-right: 1rem;
            min-width: 40px;
            text-align: center;
        }

        .language-content h3 {
            color: #6b46c1;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .language-content p {
            color: #553c9a;
            font-size: 0.9rem;
            margin: 0;
        }

        /* GOALS SELECTION */
        .goals-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .goal-option {
            position: relative;
        }

        .goal-checkbox {
            display: none;
        }

        .goal-card {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.6);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .goal-card:hover {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(139, 111, 205, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(139, 111, 205, 0.15);
        }

        .goal-checkbox:checked + .goal-card {
            background: rgba(139, 111, 205, 0.1);
            border-color: #8b6fcd;
            box-shadow: 0 8px 30px rgba(139, 111, 205, 0.2);
        }

        .goal-icon {
            font-size: 2rem;
            margin-right: 1rem;
            min-width: 50px;
            text-align: center;
        }

        .goal-content h3 {
            color: #6b46c1;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .goal-content p {
            color: #553c9a;
            font-size: 0.85rem;
            margin: 0;
            line-height: 1.4;
        }

        .goal-checkmark {
            font-size: 1.5rem;
            color: #8b6fcd;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.3s ease;
            margin-left: auto;
        }

        .goal-checkbox:checked + .goal-card .goal-checkmark {
            opacity: 1;
            transform: scale(1);
        }

        /* QUALIFYING QUESTIONS */
        .qualifying-question {
            margin-bottom: 2rem;
        }

        .qualifying-question h3 {
            color: #6b46c1;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .radio-options {
            display: grid;
            gap: 0.8rem;
        }

        .radio-option {
            position: relative;
        }

        .radio-input {
            display: none;
        }

        .radio-card {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.6);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: #553c9a;
        }

        .radio-card:hover {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(139, 111, 205, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.1);
        }

        .radio-input:checked + .radio-card {
            background: rgba(139, 111, 205, 0.1);
            border-color: #8b6fcd;
            color: #6b46c1;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.2);
        }

        .radio-icon {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(139, 111, 205, 0.3);
            border-radius: 50%;
            margin-right: 0.8rem;
            position: relative;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .radio-input:checked + .radio-card .radio-icon {
            border-color: #8b6fcd;
            background: rgba(139, 111, 205, 0.1);
        }

        .radio-input:checked + .radio-card .radio-icon::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: #8b6fcd;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* CATEGORIES */
        .category-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .category-item {
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        .category-item:hover {
            border-color: rgba(139, 111, 205, 0.3);
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.1);
        }

        .category-checkbox {
            display: none;
        }

        .category-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            color: #6b46c1;
            margin-bottom: 0.5rem;
        }

        .category-checkbox:checked + .category-label {
            color: #8b6fcd;
        }

        .category-icon {
            font-size: 1.3rem;
            margin-right: 0.6rem;
        }

        .category-checkmark {
            margin-left: auto;
            color: #8b6fcd;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .category-checkbox:checked + .category-label .category-checkmark {
            opacity: 1;
        }

        .subcategory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        .subcategory-item {
            background: rgba(139, 111, 205, 0.05);
            border: 1px solid rgba(139, 111, 205, 0.1);
            border-radius: 8px;
            padding: 0.4rem;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .subcategory-checkbox {
            display: none;
        }

        .subcategory-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            color: #553c9a;
            font-size: 0.8rem;
        }

        .subcategory-checkbox:checked + .subcategory-label {
            color: #8b6fcd;
            font-weight: 600;
        }

        .subcategory-item:hover {
            background: rgba(139, 111, 205, 0.1);
            border-color: rgba(139, 111, 205, 0.2);
        }

        .subcategory-checkmark {
            margin-left: auto;
            font-size: 0.7rem;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .subcategory-checkbox:checked + .subcategory-label .subcategory-checkmark {
            opacity: 1;
        }

        /* üÜï DYNAMIC MOTIVATIONAL MESSAGES */
        .category-footer {
            margin-top: 2rem;
            display: flex;
            justify-content: flex-end;
            align-items: flex-end;
            gap: 2rem;
        }

        .motivational-messages {
            text-align: right;
            max-width: 350px;
            position: relative;
            height: 80px;
            overflow: hidden;
        }

        .motivational-message {
            background: rgba(34, 197, 94, 0.1);
            border-left: 3px solid #22c55e;
            padding: 0.8rem;
            border-radius: 0 8px 8px 0;
            color: #059669;
            font-size: 0.8rem;
            font-weight: 500;
            line-height: 1.3;
            position: absolute;
            width: 100%;
            top: 50%;
            transform: translate(100%, -50%);
            opacity: 0;
            transition: all 0.5s ease-in-out;
        }

        .motivational-message.active {
            transform: translate(0, -50%);
            opacity: 1;
        }

        .motivational-message.exit {
            transform: translate(-100%, -50%);
            opacity: 0;
        }

        /* üÜï PRODUCTS SCREEN HELP SECTION */
        .products-help-section {
            background: rgba(255, 165, 0, 0.1);
            border: 2px solid rgba(255, 165, 0, 0.3);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .products-help-section:hover {
            background: rgba(255, 165, 0, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.2);
        }

        .products-help-section.urgent {
            border-color: rgba(239, 68, 68, 0.5);
            background: rgba(239, 68, 68, 0.1);
        }

        .products-help-section.urgent:hover {
            background: rgba(239, 68, 68, 0.15);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);
        }

        .help-title {
            color: #d97706;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .products-help-section.urgent .help-title {
            color: #dc2626;
        }

        .help-progress {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .help-progress-fill {
            background: linear-gradient(90deg, #f59e0b, #d97706);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .products-help-section.urgent .help-progress-fill {
            background: linear-gradient(90deg, #ef4444, #dc2626);
        }

        .help-text {
            color: #92400e;
            font-size: 0.75rem;
            line-height: 1.3;
        }

        .products-help-section.urgent .help-text {
            color: #991b1b;
        }

        .urgent-text {
            color: #dc2626;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        /* SELECTION SUMMARY */
        .selection-summary {
            background: rgba(139, 111, 205, 0.1);
            border: 2px solid rgba(139, 111, 205, 0.2);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .summary-title {
            color: #6b46c1;
            font-weight: 600;
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
        }

        .summary-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.8rem;
            font-size: 0.8rem;
        }

        .summary-item {
            color: #553c9a;
        }

        .summary-count {
            font-weight: 600;
            color: #8b6fcd;
        }

        /* PRODUCTS */
        .product-form {
            background: rgba(255, 255, 255, 0.7);
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .product-image {
            height: 120px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .product-price {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255,255,255,0.9);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            color: #059669;
        }

        .product-content {
            padding: 1rem;
        }

        .product-name {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .product-description {
            color: #64748b;
            font-size: 0.8rem;
            margin-bottom: 0.8rem;
            line-height: 1.4;
        }

        /* THEMES */
        .theme-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .theme-option {
            border: 3px solid rgba(139, 111, 205, 0.2);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .theme-option:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(139, 111, 205, 0.2);
            border-color: #8b6fcd !important;
        }

        .theme-option.selected {
            border-color: #8b6fcd !important;
            box-shadow: 0 12px 40px rgba(139, 111, 205, 0.3);
            transform: translateY(-2px);
        }

        .theme-header {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .theme-header h3 {
            color: #1f2937;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            display: flex;
            align-items: center;
        }

        .theme-header p {
            color: #6b7280;
            font-size: 0.8rem;
            margin: 0;
        }

        .theme-preview {
            padding: 0.8rem;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .theme-preview-item {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 6px;
            padding: 0.4rem;
            font-size: 0.7rem;
            text-align: center;
            margin: 0.2rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* NOTIFICATIONS */
        .notification {
            position: fixed;
            top: 2rem;
            right: 1rem;
            left: 1rem;
            background: linear-gradient(135deg, #8b6fcd 0%, #6b46c1 100%);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(107, 70, 193, 0.3);
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: 1003;
            max-width: 400px;
            margin: 0 auto;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .notification.success {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        }

        .notification.info {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .notification.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        /* FOMO NOTIFICATIONS */
        .fomo-notification {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(34, 197, 94, 0.2);
            border-left: 4px solid #22c55e;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 8px 40px rgba(34, 197, 94, 0.15);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 1004;
            max-width: 400px;
            margin: 0 auto;
        }

        .fomo-notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .fomo-notification.hide {
            transform: translateY(100px);
            opacity: 0;
        }

        .fomo-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .fomo-icon {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            margin-right: 0.8rem;
            animation: pulse 2s infinite;
        }

        .fomo-status {
            color: #059669;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .fomo-content {
            color: #1f2937;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .business-name {
            font-weight: 600;
            color: #6b46c1;
        }

        .business-location {
            color: #6b7280;
            font-weight: 500;
        }

        .fomo-time {
            color: #9ca3af;
            font-size: 0.7rem;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .fomo-counter {
            position: fixed;
            top: 50%;
            left: 1rem;
            transform: translateY(-50%);
            background: rgba(34, 197, 94, 0.95);
            color: white;
            padding: 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.3);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1005;
            text-align: center;
            min-width: 100px;
        }

        .fomo-counter.show {
            opacity: 1;
        }

        .counter-number {
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
            margin-bottom: 0.2rem;
        }

        .counter-text {
            font-size: 0.7rem;
            opacity: 0.9;
        }

        /* üì± RESPONSIVE BREAKPOINTS */
        @media (min-width: 480px) {
            .language-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .goals-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .theme-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .content-card {
                padding: 3rem;
            }
            
            .content-card h2 {
                font-size: 2.5rem;
            }
            
            .language-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .category-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .theme-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .main-content {
                padding: 2rem;
            }
            
            .progress-bar {
                justify-content: center;
            }
            
            .progress-step {
                min-width: 90px;
            }
            
            .progress-step:not(:last-child)::after {
                width: 30px;
                left: 60px;
            }
            
            .lead-score-widget {
                top: 120px;
                right: 2rem;
            }
            
            .fomo-notification {
                left: 2rem;
                right: auto;
                max-width: 350px;
            }
            
            .notification {
                right: 2rem;
                left: auto;
                max-width: 400px;
            }

            .category-footer {
                flex-direction: row;
            }

            .motivational-messages {
                text-align: right;
            }
        }

        @media (min-width: 1024px) {
            .progress-step {
                min-width: 110px;
            }
            
            .progress-step:not(:last-child)::after {
                width: 40px;
                left: 75px;
            }
        }

        /* MOBILE SPECIFIC FIXES */
        @media (max-width: 767px) {
            .progress-bar {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .progress-bar::-webkit-scrollbar {
                display: none;
            }
            
            .lead-score-widget {
                top: 80px;
                right: 0.5rem;
                padding: 0.4rem 0.8rem;
            }
            
            .score-circle {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .score-label {
                font-size: 0.7rem;
            }
            
            .fomo-counter {
                left: 0.5rem;
                top: auto;
                bottom: 6rem;
                transform: none;
                padding: 0.6rem;
                min-width: 80px;
            }
            
            .counter-number {
                font-size: 1.2rem;
            }
            
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .category-footer {
                flex-direction: column;
                gap: 1rem;
            }

            .motivational-messages {
                text-align: left;
                max-width: 100%;
            }
        }

        /* UTILITY CLASSES */
        .btn-secondary {
            background: rgba(139, 111, 205, 0.1);
            color: #6b46c1;
            border: 2px solid rgba(139, 111, 205, 0.2);
            padding: 1rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-secondary:hover {
            background: rgba(139, 111, 205, 0.15);
            border-color: rgba(139, 111, 205, 0.3);
            transform: translateY(-1px);
        }

        .flex-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .flex-buttons > * {
            flex: 1;
        }

        /* ANIMATIONS */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        @keyframes sparkleFloat {
            0% { transform: translateY(0) scale(0) rotate(0deg); opacity: 1; }
            50% { transform: translateY(-30px) scale(1) rotate(180deg); opacity: 1; }
            100% { transform: translateY(-60px) scale(0) rotate(360deg); opacity: 0; }
        }

        /* üÜï MODAL OVERLAY STYLES */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #faf9ff 0%, #f3f0ff 100%);
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
            box-shadow: 0 20px 60px rgba(107, 70, 193, 0.3);
            border: 2px solid rgba(139, 111, 205, 0.2);
        }
        
        .modal-overlay.show .modal-content {
            transform: scale(1) translateY(0);
        }
        
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(139, 111, 205, 0.1);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #6b46c1;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: rgba(139, 111, 205, 0.2);
            transform: scale(1.1);
        }
        
        .goal-pill {
            background: linear-gradient(135deg, #8b6fcd, #6b46c1);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            margin: 0.3rem;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.3);
        }

        /* üÜï OTP MODAL STYLES */
        .otp-input-group {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin: 1.5rem 0;
        }

        .otp-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            border: 2px solid rgba(139, 111, 205, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #6b46c1;
            transition: all 0.3s ease;
        }

        .otp-input:focus {
            outline: none;
            border-color: #8b6fcd;
            box-shadow: 0 0 0 3px rgba(139, 111, 205, 0.1);
        }

        .otp-input.filled {
            background: rgba(139, 111, 205, 0.1);
            border-color: #8b6fcd;
        }
        
        @media (max-width: 767px) {
            .modal-content {
                padding: 1.5rem;
                margin: 0.5rem;
            }
            
            .modal-close {
                top: 0.5rem;
                right: 0.5rem;
                width: 35px;
                height: 35px;
            }

            .otp-input {
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Back Button -->
    <div class="back-button hidden" id="backButton" onclick="goBack()">
        ‚Üê
    </div>

    <!-- Error Display -->
    <div class="error-display" id="errorDisplay">
        <div id="errorContent"></div>
    </div>

    <!-- Debug Toggle -->
    <button class="debug-toggle" onclick="toggleDebugPanel()">üîç</button>

    <!-- Debug Panel -->
    <div class="debug-panel" id="debugPanel">
        <h4>üîç Debug Log</h4>
        <div id="debugLog"></div>
    </div>

    <!-- üÜï SIMPLIFIED LEAD SCORE WIDGET -->
    <div class="lead-score-widget" id="leadWidget" onclick="toggleScoreDetails()">
        <div class="score-circle cold" id="leadScoreCircle">
            <span id="leadScoreValue">0</span>
        </div>
        <div class="score-label" id="scoreLabel">Score</div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div id="notificationContent"></div>
    </div>

    <!-- FOMO Notification System -->
    <div class="fomo-notification" id="fomoNotification">
        <div class="fomo-header">
            <div class="fomo-icon"></div>
            <div class="fomo-status">Just Registered</div>
        </div>
        <div class="fomo-content" id="fomoContent">
            <span class="business-name">Vasavi Silks</span> from <span class="business-location">Mysore</span> just set up their online store
        </div>
        <div class="fomo-time" id="fomoTime">2 minutes ago</div>
    </div>

    <!-- FOMO Counter -->
    <div class="fomo-counter" id="fomoCounter">
        <span class="counter-number" id="counterNumber">247</span>
        <span class="counter-text">joined in<br>last 24 hours</span>
    </div>

    <div class="app-container">
        <!-- üÜï CLICKABLE PROGRESS BAR -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">
                <div class="progress-step" data-step="goals" onclick="navigateToStep('goals')">
                    <div class="progress-circle">1</div>
                    <div class="progress-label">Business Goals</div>
                </div>
                <div class="progress-step" data-step="registration" onclick="navigateToStep('registration')">
                    <div class="progress-circle">2</div>
                    <div class="progress-label">Sign Up</div>
                </div>
                <div class="progress-step" data-step="qualifying-questions" onclick="navigateToStep('qualifying-questions')">
                    <div class="progress-circle">3</div>
                    <div class="progress-label">Success Factors</div>
                </div>
                <div class="progress-step" data-step="categories" onclick="navigateToStep('categories')">
                    <div class="progress-circle">4</div>
                    <div class="progress-label">Business Live-1</div>
                </div>
                <div class="progress-step" data-step="products" onclick="navigateToStep('products')">
                    <div class="progress-circle">5</div>
                    <div class="progress-label">Business Live-2</div>
                </div>
                <div class="progress-step" data-step="themes" onclick="navigateToStep('themes')">
                    <div class="progress-circle">6</div>
                    <div class="progress-label">Business Live-3</div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Welcome Screen -->
            <section class="screen active" id="welcome">
                <div class="welcome-screen">
                    <h1 class="topiko-logo">Topiko</h1>
                    <p style="font-size: 1.1rem; color: #6b46c1; margin-bottom: 2rem;">Complete Business Platform for Indian SMBs</p>
                    <button class="try-free-button" onclick="startLeadFlow()">
                        Try for Free
                    </button>
                </div>
            </section>

            <!-- Language Selection Screen -->
            <section class="screen" id="language">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Choose Your Language</h2>
                    <p style="text-align: center; margin-bottom: 2rem; font-size: 0.9rem;">‡§Ö‡§™‡§®‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç | ‡∞Æ‡±Ä ‡∞≠‡∞æ‡∞∑‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø | ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç</p>
                    
                    <div class="language-grid">
                        <div class="language-option" onclick="selectLanguage('en', this)">
                            <div class="language-flag">üá¨üáß</div>
                            <div class="language-content">
                                <h3>English</h3>
                                <p>Continue in English</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguage('hi', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</h3>
                                <p>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguage('te', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</h3>
                                <p>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å‡∞≤‡±ã ‡∞ï‡±ä‡∞®‡∞∏‡∞æ‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguage('ta', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</h3>
                                <p>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Goals Selection Screen -->
            <section class="screen" id="goals">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Select Your Goals</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Choose what you want to achieve with Topiko (select all that apply)</p>
                    
                    <div class="goals-grid">
                        <div class="goal-option">
                            <input type="checkbox" id="goal-ecommerce" value="ecommerce" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-ecommerce" class="goal-card">
                                <div class="goal-icon">üõí</div>
                                <div class="goal-content">
                                    <h3>Sell Online (E-commerce)</h3>
                                    <p>Start selling your products online with a complete e-commerce solution</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-customers" value="customers" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-customers" class="goal-card">
                                <div class="goal-icon">üìà</div>
                                <div class="goal-content">
                                    <h3>Reach More Customers</h3>
                                    <p>Expand your customer base and grow your market reach</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-manage" value="manage" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-manage" class="goal-card">
                                <div class="goal-icon">üë•</div>
                                <div class="goal-content">
                                    <h3>Manage Customers</h3>
                                    <p>Keep track of your customers and build lasting relationships</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-search" value="search" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-search" class="goal-card">
                                <div class="goal-icon">üîç</div>
                                <div class="goal-content">
                                    <h3>Appear in Search Results</h3>
                                    <p>Improve your online visibility and get found by potential customers</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-brand" value="brand" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-brand" class="goal-card">
                                <div class="goal-icon">‚≠ê</div>
                                <div class="goal-content">
                                    <h3>Establish my Brand</h3>
                                    <p>Build a strong brand presence and professional image online</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>
                    </div>

                    <button class="submit-button" onclick="submitGoals()">
                        Next Step
                    </button>
                </div>
            </section>

            <!-- Registration Screen -->
            <section class="screen" id="registration">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Get Started with Topiko</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Tell us about your business to create your free account</p>
                    
                    <div class="form-group">
                        <label for="fullName">Your Name</label>
                        <input type="text" id="fullName" placeholder="Enter your full name" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" placeholder="Enter your email address" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="phoneNumber">Phone Number</label>
                        <input type="tel" id="phoneNumber" placeholder="Enter your phone number" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="businessName">Business Name</label>
                        <input type="text" id="businessName" placeholder="Enter your business name" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea id="address" rows="3" placeholder="Enter your business address" oninput="trackFormProgress()"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="businessType">Business Type</label>
                        <select id="businessType" onchange="trackFormProgress()">
                            <option value="">Select your business type</option>
                            <option value="startup">Startup</option>
                            <option value="small-business">Small Business</option>
                            <option value="medium-enterprise">Medium Enterprise</option>
                            <option value="large-enterprise">Large Enterprise</option>
                            <option value="freelancer">Freelancer</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="category">Business Category</label>
                        <select id="category" onchange="trackFormProgress()">
                            <option value="">Select your business category</option>
                            <option value="boutique">üè™ Boutique & Fashion</option>
                            <option value="home-foods">üçõ Home Foods & Catering</option>
                            <option value="salons">üíÑ Salons & Beauty</option>
                            <option value="grocery">üõí Grocery & Provisions</option>
                            <option value="furniture">üõãÔ∏è Furniture & Home Decor</option>
                            <option value="electronics">üì± Electronics & Gadgets</option>
                            <option value="jewellery">üíç Jewellery & Accessories</option>
                            <option value="restaurants">üçΩÔ∏è Restaurants & Cafes</option>
                            <option value="fitness">üí™ Fitness & Wellness</option>
                            <option value="education">üìö Education & Training</option>
                            <option value="automotive">üöó Automotive Services</option>
                            <option value="healthcare">üè• Healthcare Services</option>
                            <option value="professional">üíº Professional Services</option>
                            <option value="arts-crafts">üé® Arts & Crafts</option>
                            <option value="travel">‚úàÔ∏è Travel & Tourism</option>
                            <option value="pet-services">üêæ Pet Services & Supplies</option>
                            <option value="real-estate">üè† Real Estate Services</option>
                            <option value="event-services">üéâ Event & Wedding Services</option>
                            <option value="agriculture">üåæ Agriculture & Farming</option>
                            <option value="others">üîß Others</option>
                        </select>
                    </div>

                    <button class="submit-button" onclick="submitRegistration()">
                        Create Free Account
                    </button>
                </div>
            </section>

            <!-- Qualifying Questions Screen -->
            <section class="screen" id="qualifying-questions">
                <div class="content-card">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;" id="qualifyingTitle">
                            Let's setup things for you
                        </h2>
                        <p style="color: #553c9a; font-size: 1rem; font-weight: 500;">
                            Just need a couple of details about your business
                        </p>
                    </div>

                    <!-- Question 1: Online Presence -->
                    <div class="qualifying-question">
                        <h3>Do you currently have any online presence?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="presence-none" name="online_presence" value="none" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-none" class="radio-card">
                                    <div class="radio-icon"></div>
                                    No online presence at all
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-whatsapp" name="online_presence" value="whatsapp" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-whatsapp" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Only WhatsApp Business
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-social" name="online_presence" value="social" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-social" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Social media pages (Facebook/Instagram)
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-basic" name="online_presence" value="basic_website" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-basic" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Basic website
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-full" name="online_presence" value="full_website" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-full" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Full website with online ordering
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2: Budget -->
                    <div class="qualifying-question">
                        <h3>To meet your business goals, how much budget can you allocate per year?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="budget-low" name="budget" value="5000-10000" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-low" class="radio-card">
                                    <div class="radio-icon"></div>
                                    ‚Çπ5,000 to ‚Çπ10,000
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="budget-medium" name="budget" value="10000-25000" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-medium" class="radio-card">
                                    <div class="radio-icon"></div>
                                    ‚Çπ10,000 to ‚Çπ25,000
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="budget-high" name="budget" value="25000+" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-high" class="radio-card">
                                    <div class="radio-icon"></div>
                                    More than ‚Çπ25,000
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3: Decision Maker -->
                    <div class="qualifying-question">
                        <h3>Are you the decision maker for your business?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="decision-yes" name="decision_maker" value="yes" class="radio-input" onchange="updateQualifyingData()">
                                <label for="decision-yes" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Yes
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="decision-no" name="decision_maker" value="no" class="radio-input" onchange="updateQualifyingData()">
                                <label for="decision-no" class="radio-card">
                                    <div class="radio-icon"></div>
                                    No
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4: Timeline -->
                    <div class="qualifying-question">
                        <h3>How soon do you want to get started?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="timeline-immediate" name="timeline" value="immediately" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-immediate" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Immediately
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-week" name="timeline" value="within_week" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-week" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Within a week
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-month" name="timeline" value="this_month" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-month" class="radio-card">
                                    <div class="radio-icon"></div>
                                    This month
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-checking" name="timeline" value="just_checking" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-checking" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Just checking
                                </label>
                            </div>
                        </div>
                    </div>

                    <button class="submit-button" onclick="proceedToCategories()" id="qualifyingNextBtn" disabled style="opacity: 0.5;">
                        Create my Business üöÄ
                    </button>
                </div>
            </section>

            <!-- Categories Screen -->
            <section class="screen" id="categories">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" id="categoriesTitle">Select Your Business Categories</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Choose specific categories and subcategories that best describe your business</p>
                    
                    <!-- Selection Summary -->
                    <div class="selection-summary" id="selectionSummary" style="display: none;">
                        <div class="summary-title">üìä Your Selection Summary</div>
                        <div class="summary-content">
                            <div class="summary-item">
                                <span>Categories: </span>
                                <span class="summary-count" id="categoriesCount">0</span>
                            </div>
                            <div class="summary-item">
                                <span>Subcategories: </span>
                                <span class="summary-count" id="subcategoriesCount">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="categoriesContainer">
                        <!-- Categories will be populated dynamically -->
                    </div>

                    <!-- üÜï Category Footer with Dynamic Motivational Messages -->
                    <div class="category-footer">
                        <div class="motivational-messages" id="motivationalMessages">
                            <!-- Dynamic messages will be populated here -->
                        </div>
                    </div>

                    <button class="submit-button" onclick="proceedToProducts()" id="categoryNextBtn" disabled>
                        Continue to Add Products
                    </button>
                </div>
            </section>

            <!-- Products Screen -->
            <section class="screen" id="products">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" id="productsTitle">Add Your Products</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Build your catalog with products that represent your business</p>
                    
                    <!-- üÜï Help Section (Moved from Categories) -->
                    <div class="products-help-section" id="productsHelpSection" onclick="requestFollowup()">
                        <div class="help-title" id="productsHelpTitle">üéØ Free Professional Setup Available!</div>
                        <div class="help-progress">
                            <div class="help-progress-fill" id="productsHelpProgressFill"></div>
                        </div>
                        <div class="help-text" id="productsHelpText">
                            Topiko is helping with free setup for 75 businesses every month. <span id="productsClaimedCount">47</span> claimed for <span id="productsCurrentMonth">January</span>. Click here for help!
                        </div>
                    </div>
                    
                    <!-- Product Form -->
                    <div class="product-form">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;" id="productFormTitle">Add New Product/Service</h3>
                        
                        <div class="form-group">
                            <label for="productName">Product/Service Name</label>
                            <input type="text" id="productName" placeholder="e.g., Cotton Kurta, Masala Dosa, Haircut">
                        </div>
                        
                        <div class="form-group">
                            <label for="productPrice">Price (‚Çπ)</label>
                            <input type="number" id="productPrice" placeholder="e.g., 899">
                        </div>

                        <div class="form-group">
                            <label for="productCategory">Category</label>
                            <select id="productCategory">
                                <option value="">Select from your chosen categories</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="productSubcategory">Subcategory (Optional)</label>
                            <select id="productSubcategory">
                                <option value="">Select a subcategory</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productDescription">Description</label>
                            <textarea id="productDescription" rows="3" placeholder="Brief description of your product or service"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="productImage">Product Image URL (optional)</label>
                            <input type="url" id="productImage" placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <button type="button" onclick="addProduct()" class="btn-secondary" style="width: auto; margin-top: 1rem;">
                            ‚ûï Add Product
                        </button>
                    </div>

                    <!-- Products List -->
                    <div class="products-list">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;">Your Product Catalog (<span id="productCount">0</span>)</h3>
                        
                        <div class="product-grid" id="productsList">
                            <div style="text-align: center; padding: 2rem; color: #64748b; background: rgba(255, 255, 255, 0.5); border-radius: 12px;">
                                <div style="font-size: 3rem; margin-bottom: 1rem;">üì¶</div>
                                <p>No products added yet. Add your first product above!</p>
                            </div>
                        </div>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="navigateToStep('categories')" class="btn-secondary">
                            ‚Üê Back to Categories
                        </button>
                        <button onclick="proceedToThemes()" class="submit-button">
                            Choose Theme üé®
                        </button>
                    </div>
                </div>
            </section>

            <!-- Theme Selection Screen -->
            <section class="screen" id="themes">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" id="themesTitle">Choose Your Business Theme</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Select a theme that represents your business style. See how your products will look!</p>
                    
                    <div class="theme-grid">
                        <!-- Modern & Minimalist Theme -->
                        <div class="theme-option" onclick="selectTheme('modern', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">‚ú®</span>
                                    Modern & Minimalist
                                </h3>
                                <p>Clean, simple design that focuses on your products</p>
                            </div>
                            <div class="theme-preview" id="modern-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Colorful & Vibrant Theme -->
                        <div class="theme-option" onclick="selectTheme('vibrant', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üåà</span>
                                    Colorful & Vibrant
                                </h3>
                                <p>Bold colors and energetic design to attract customers</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #fecaca 100%);" id="vibrant-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Professional & Corporate Theme -->
                        <div class="theme-option" onclick="selectTheme('professional', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üíº</span>
                                    Professional & Corporate
                                </h3>
                                <p>Sophisticated design that builds trust and credibility</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white;" id="professional-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Traditional & Classic Theme -->
                        <div class="theme-option" onclick="selectTheme('traditional', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üèõÔ∏è</span>
                                    Traditional & Classic
                                </h3>
                                <p>Timeless design with warm, welcoming feel</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #fef7cd 0%, #fde68a 100%);" id="traditional-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Creative & Artistic Theme -->
                        <div class="theme-option" onclick="selectTheme('creative', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üé®</span>
                                    Creative & Artistic
                                </h3>
                                <p>Unique, artistic design that showcases creativity</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #ddd6fe 0%, #c7d2fe 50%, #bfdbfe 100%);" id="creative-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Elegant & Luxury Theme -->
                        <div class="theme-option" onclick="selectTheme('luxury', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üíé</span>
                                    Elegant & Luxury
                                </h3>
                                <p>Premium design for high-end products and services</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #1c1917 0%, #292524 100%); color: #d6d3d1;" id="luxury-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 1.5rem 0;">
                        <p style="color: #6b7280; font-size: 0.8rem; margin-bottom: 1rem;">
                            <span id="selectedThemeName">No theme selected</span> | You can change this anytime later
                        </p>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="navigateToStep('products')" class="btn-secondary">
                            ‚Üê Back to Products
                        </button>
                        <button onclick="completeSetup()" id="themeNextBtn" disabled style="opacity: 0.5;">
                            Complete Setup üöÄ
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // üéØ ENHANCED TOPIKO LEAD FORM WITH DYNAMIC MESSAGING AND EXPANDED CATEGORIES
        
        // ‚úÖ CORE VARIABLES
        let sessionStartTime = Date.now();
        let selectedGoals = [];
        let selectedLanguage = 'en';
        let selectedCategories = [];
        let selectedSubcategories = [];
        let userProducts = [];
        let currentUserId = null;
        let selectedTheme = null;
        let pageViews = 1;
        let leadScore = 0;
        let formProgress = 0;
        let utmParams = {};
        let deviceInfo = {};
        let debugLogs = [];
        let userName = '';
        let businessName = '';

        // Navigation tracking
        let currentStep = 'welcome';
        let navigationHistory = ['welcome'];

        // Step configuration
        const stepOrder = [
            'welcome',
            'language', 
            'goals',
            'registration',
            'qualifying-questions',
            'categories',
            'products',
            'themes'
        ];

        const progressSteps = ['goals', 'registration', 'qualifying-questions', 'categories', 'products', 'themes'];

        // Qualifying Questions Data
        let qualifyingAnswers = {
            online_presence: '',
            budget: '',
            decision_maker: '',
            timeline: ''
        };

        // FOMO system
        let fomoActive = true;
        let fomoTimer = null;
        let businessCounter = 247;
        let lastFomoShow = 0;
        let helpClaimedCount = 47; // For help section

        // üÜï DYNAMIC MESSAGING SYSTEM
        let currentMessageIndex = 0;
        let messageInterval = null;

        // üÜï MOTIVATIONAL MESSAGE TEMPLATES
        const motivationalMessageTemplates = [
            "Just {stepsLeft} more step{plural} to see {businessName} live online.",
            "You're almost there. See how your customers will see {businessName}.",
            "Businesses like {businessName} got 43% more customers after going online. Want to see how?",
            "Your products are almost ready to be seen online ‚Äì don't miss your next customer.",
            "Thousands of businesses in your {category} are already online. Don't be the last."
        ];

        // üáÆüá≥ EXPANDED BUSINESS DATA
        const indianBusinessNames = [
            // Traditional/Regional Names
            'Vasavi Silks', 'Lakshmi Textiles', 'Sree Krishna Stores', 'Ganesh Traders', 'Shiva Electronics',
            'Rama Jewellers', 'Vishnu Enterprises', 'Durga Fashions', 'Saraswati Boutique', 'Hanuman Hardware',
            'Ganesha Sweets', 'Murugan Stores', 'Balaji Textiles', 'Venkateswara Mills', 'Karthik Garments',
            
            // Modern Business Names
            'StyleHub Fashion', 'TechPoint Solutions', 'FreshMart Grocery', 'GlowUp Beauty', 'TasteBuds Cafe',
            'UrbanStyle Boutique', 'SmartTech Electronics', 'PureVibe Wellness', 'CreativeMinds Studio', 'EcoLife Products',
            'TrendyWear Collection', 'DigitalCraft Solutions', 'HealthFirst Pharmacy', 'SparkleClean Services', 'FlavorTown Restaurant',
            
            // Category-Specific Names
            'Royal Beauty Salon', 'Spice Garden Restaurant', 'Golden Touch Jewellery', 'Modern Home Furniture',
            'QuickFix Electronics', 'Fresh & Natural Foods', 'Elite Fashion House', 'Comfort Zone Interiors',
            'Wellness Plus Clinic', 'TechSavvy Computers', 'Artisan Craft Studio', 'Green Valley Organic',
            
            // Regional Variations
            'Mumbai Masala House', 'Delhi Darbar Restaurant', 'Bangalore IT Solutions', 'Chennai Silks Emporium',
            'Kolkata Sweet Corner', 'Hyderabad Biryani House', 'Pune Fashion Gallery', 'Jaipur Handicrafts',
            'Kochi Spice Mart', 'Mysore Silk Palace', 'Coimbatore Cotton Mills', 'Indore Jewelry Bazaar',
            
            // Contemporary Names
            'The Style Studio', 'Pixel Perfect Designs', 'Organic Harvest', 'Fitness First Gym',
            'Coffee Culture Cafe', 'Digital Dreams Agency', 'Wellness Warriors', 'Flavor Junction',
            'Style Statements', 'Tech Titans', 'Healthy Habits Store', 'Creative Canvas Studio'
        ];

        const indianCities = [
            'Mumbai', 'Delhi', 'Bangalore', 'Chennai', 'Kolkata', 'Hyderabad', 'Pune', 'Ahmedabad',
            'Mysore', 'Coimbatore', 'Kochi', 'Jaipur', 'Lucknow', 'Kanpur', 'Nagpur', 'Indore',
            'Surat', 'Vadodara', 'Visakhapatnam', 'Bhopal', 'Patna', 'Ludhiana', 'Agra', 'Nashik',
            'Faridabad', 'Ghaziabad', 'Rajkot', 'Meerut', 'Jabalpur', 'Thane', 'Howrah', 'Ranchi',
            'Allahabad', 'Vijayawada', 'Jodhpur', 'Madurai', 'Raipur', 'Kota', 'Guwahati', 'Chandigarh'
        ];

        const fomoMessageTemplates = [
            { text: '{business} from {city} just set up their online store', status: 'Just Registered' },
            { text: '{business} in {city} started selling online', status: 'Now Live' },
            { text: '{business} from {city} launched their digital presence', status: 'Just Launched' },
            { text: '{business} in {city} joined our platform', status: 'New Member' },
            { text: '{business} from {city} completed their business setup', status: 'Setup Complete' },
            { text: '{business} in {city} is now accepting online orders', status: 'Orders Live' },
            { text: '{business} from {city} went digital today', status: 'Digital Launch' }
        ];

        // üöÄ SUPABASE CONFIGURATION
        const SUPABASE_URL = 'https://xssbtsfjtwjholygdbqo.supabase.co'
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhzc2J0c2ZqdHdqaG9seWdkYnFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMxOTk5MjUsImV4cCI6MjA2ODc3NTkyNX0.eOSIHTpvllcH-fK6MARoe5HPiXlujsrzUWfAhmUh94k'

        // üáÆüá≥ EXPANDED BUSINESS CATEGORIES WITH NEW CATEGORIES
        const businessCategories = {
            boutique: {
                id: 'boutique',
                name: 'Boutique & Fashion',
                icon: 'üè™',
                categories: {
                    'mens-wear': {
                        name: "Men's Wear",
                        icon: 'üëî',
                        subcategories: ['shirts', 'pants', 'suits', 'ethnic-wear', 'casual-wear', 'formal-wear', 'kurtas', 'sherwanis']
                    },
                    'womens-wear': {
                        name: "Women's Wear",
                        icon: 'üëó',
                        subcategories: ['dresses', 'tops', 'bottoms', 'sarees', 'lehengas', 'salwar-suits', 'western-wear', 'ethnic-wear', 'kurtis']
                    },
                    'accessories': {
                        name: 'Fashion Accessories',
                        icon: 'üëú',
                        subcategories: ['bags', 'belts', 'wallets', 'scarves', 'hats', 'sunglasses', 'watches', 'jewelry']
                    },
                    'footwear': {
                        name: 'Footwear',
                        icon: 'üë†',
                        subcategories: ['mens-shoes', 'womens-shoes', 'sandals', 'boots', 'sneakers', 'ethnic-footwear']
                    }
                }
            },
            'home-foods': {
                id: 'home-foods',
                name: 'Home Foods & Catering',
                icon: 'üçõ',
                categories: {
                    'north-indian': {
                        name: 'North Indian Cuisine',
                        icon: 'üçõ',
                        subcategories: ['rotis-parathas', 'curries', 'dal-preparations', 'rice-dishes', 'snacks', 'biryanis', 'tandoor-items']
                    },
                    'south-indian': {
                        name: 'South Indian Cuisine',
                        icon: 'ü••',
                        subcategories: ['dosas', 'idlis', 'vadas', 'uttapam', 'sambar', 'rasam', 'chutneys', 'appams']
                    },
                    'sweets-desserts': {
                        name: 'Sweets & Desserts',
                        icon: 'üßÅ',
                        subcategories: ['traditional-sweets', 'cakes', 'pastries', 'ice-creams', 'mithai', 'cookies']
                    },
                    'beverages': {
                        name: 'Beverages',
                        icon: '‚òï',
                        subcategories: ['tea', 'coffee', 'fresh-juices', 'smoothies', 'traditional-drinks', 'lassi']
                    }
                }
            },
            salons: {
                id: 'salons',
                name: 'Salons & Beauty',
                icon: 'üíÑ',
                categories: {
                    'hair-services': {
                        name: 'Hair Services',
                        icon: 'üíá',
                        subcategories: ['haircuts', 'hair-coloring', 'hair-styling', 'hair-treatments', 'keratin', 'rebonding']
                    },
                    'beauty-services': {
                        name: 'Beauty Services',
                        icon: '‚ú®',
                        subcategories: ['facials', 'makeup', 'eyebrow-threading', 'manicure', 'pedicure', 'waxing']
                    },
                    'spa-wellness': {
                        name: 'Spa & Wellness',
                        icon: 'üßò',
                        subcategories: ['massages', 'body-treatments', 'aromatherapy', 'reflexology', 'steam-baths']
                    }
                }
            },
            grocery: {
                id: 'grocery',
                name: 'Grocery & Provisions',
                icon: 'üõí',
                categories: {
                    'fresh-produce': {
                        name: 'Fresh Produce',
                        icon: 'ü•¨',
                        subcategories: ['vegetables', 'fruits', 'herbs', 'organic-produce', 'seasonal-items']
                    },
                    'staples': {
                        name: 'Staples & Grains',
                        icon: 'üçö',
                        subcategories: ['rice', 'wheat', 'pulses', 'spices', 'oils', 'flour']
                    },
                    'packaged-foods': {
                        name: 'Packaged Foods',
                        icon: 'üì¶',
                        subcategories: ['snacks', 'beverages', 'dairy', 'frozen-foods', 'ready-to-eat']
                    }
                }
            },
            furniture: {
                id: 'furniture',
                name: 'Furniture & Home Decor',
                icon: 'üõãÔ∏è',
                categories: {
                    'living-room': {
                        name: 'Living Room',
                        icon: 'üõãÔ∏è',
                        subcategories: ['sofas', 'coffee-tables', 'tv-units', 'recliners', 'bean-bags']
                    },
                    'bedroom': {
                        name: 'Bedroom',
                        icon: 'üõèÔ∏è',
                        subcategories: ['beds', 'wardrobes', 'mattresses', 'dressing-tables', 'bedside-tables']
                    },
                    'home-decor': {
                        name: 'Home Decor',
                        icon: 'üé®',
                        subcategories: ['wall-art', 'curtains', 'lighting', 'plants', 'mirrors', 'rugs']
                    }
                }
            },
            electronics: {
                id: 'electronics',
                name: 'Electronics & Gadgets',
                icon: 'üì±',
                categories: {
                    'mobile-devices': {
                        name: 'Mobile Devices',
                        icon: 'üì±',
                        subcategories: ['smartphones', 'tablets', 'accessories', 'chargers', 'cases', 'headphones']
                    },
                    'computers': {
                        name: 'Computers & Laptops',
                        icon: 'üíª',
                        subcategories: ['laptops', 'desktops', 'monitors', 'keyboards', 'mice', 'printers']
                    },
                    'home-appliances': {
                        name: 'Home Appliances',
                        icon: 'üè†',
                        subcategories: ['refrigerators', 'washing-machines', 'air-conditioners', 'fans', 'heaters']
                    }
                }
            },
            jewellery: {
                id: 'jewellery',
                name: 'Jewellery & Accessories',
                icon: 'üíç',
                categories: {
                    'gold-jewelry': {
                        name: 'Gold Jewellery',
                        icon: 'üëë',
                        subcategories: ['necklaces', 'earrings', 'bangles', 'rings', 'chains', 'pendants']
                    },
                    'silver-jewelry': {
                        name: 'Silver Jewellery',
                        icon: '‚ú®',
                        subcategories: ['rings', 'bracelets', 'anklets', 'nose-pins', 'toe-rings']
                    },
                    'fashion-jewelry': {
                        name: 'Fashion Jewellery',
                        icon: 'üíé',
                        subcategories: ['artificial-jewelry', 'costume-jewelry', 'beaded-jewelry', 'oxidized-jewelry']
                    }
                }
            },
            restaurants: {
                id: 'restaurants',
                name: 'Restaurants & Cafes',
                icon: 'üçΩÔ∏è',
                categories: {
                    'fine-dining': {
                        name: 'Fine Dining',
                        icon: 'üçΩÔ∏è',
                        subcategories: ['multi-cuisine', 'continental', 'italian', 'chinese', 'thai', 'mexican']
                    },
                    'casual-dining': {
                        name: 'Casual Dining',
                        icon: 'üçï',
                        subcategories: ['pizza', 'burgers', 'sandwiches', 'wraps', 'pasta', 'grilled-items']
                    },
                    'cafes': {
                        name: 'Cafes & Bakeries',
                        icon: '‚òï',
                        subcategories: ['coffee', 'tea', 'pastries', 'cakes', 'cookies', 'breakfast-items']
                    }
                }
            },
            fitness: {
                id: 'fitness',
                name: 'Fitness & Wellness',
                icon: 'üí™',
                categories: {
                    'gym-fitness': {
                        name: 'Gym & Fitness',
                        icon: 'üèãÔ∏è',
                        subcategories: ['weight-training', 'cardio', 'group-classes', 'personal-training', 'crossfit']
                    },
                    'yoga-meditation': {
                        name: 'Yoga & Meditation',
                        icon: 'üßò',
                        subcategories: ['hatha-yoga', 'vinyasa', 'meditation', 'pranayama', 'therapeutic-yoga']
                    },
                    'sports': {
                        name: 'Sports Activities',
                        icon: '‚öΩ',
                        subcategories: ['badminton', 'tennis', 'swimming', 'cricket', 'football', 'basketball']
                    }
                }
            },
            education: {
                id: 'education',
                name: 'Education & Training',
                icon: 'üìö',
                categories: {
                    'academic-coaching': {
                        name: 'Academic Coaching',
                        icon: 'üéì',
                        subcategories: ['math-tutoring', 'science-coaching', 'language-classes', 'exam-prep', 'homework-help']
                    },
                    'skill-development': {
                        name: 'Skill Development',
                        icon: 'üíª',
                        subcategories: ['computer-courses', 'programming', 'digital-marketing', 'graphic-design', 'photography']
                    },
                    'arts-music': {
                        name: 'Arts & Music',
                        icon: 'üéµ',
                        subcategories: ['music-lessons', 'dance-classes', 'art-classes', 'crafts', 'singing']
                    }
                }
            },
            automotive: {
                id: 'automotive',
                name: 'Automotive Services',
                icon: 'üöó',
                categories: {
                    'repair-maintenance': {
                        name: 'Repair & Maintenance',
                        icon: 'üîß',
                        subcategories: ['engine-repair', 'brake-service', 'oil-change', 'tire-service', 'battery-replacement']
                    },
                    'car-accessories': {
                        name: 'Car Accessories',
                        icon: 'üöô',
                        subcategories: ['seat-covers', 'floor-mats', 'audio-systems', 'navigation', 'car-care-products']
                    }
                }
            },
            healthcare: {
                id: 'healthcare',
                name: 'Healthcare Services',
                icon: 'üè•',
                categories: {
                    'general-medicine': {
                        name: 'General Medicine',
                        icon: 'üë®‚Äç‚öïÔ∏è',
                        subcategories: ['consultations', 'health-checkups', 'vaccinations', 'prescriptions', 'diagnostics']
                    },
                    'specialty-care': {
                        name: 'Specialty Care',
                        icon: 'ü©∫',
                        subcategories: ['dentistry', 'orthopedics', 'cardiology', 'dermatology', 'ophthalmology']
                    }
                }
            },
            professional: {
                id: 'professional',
                name: 'Professional Services',
                icon: 'üíº',
                categories: {
                    'legal-services': {
                        name: 'Legal Services',
                        icon: '‚öñÔ∏è',
                        subcategories: ['legal-consultation', 'documentation', 'court-representation', 'contract-drafting']
                    },
                    'financial-services': {
                        name: 'Financial Services',
                        icon: 'üí∞',
                        subcategories: ['tax-filing', 'accounting', 'investment-advice', 'loan-assistance', 'insurance']
                    }
                }
            },
            'arts-crafts': {
                id: 'arts-crafts',
                name: 'Arts & Crafts',
                icon: 'üé®',
                categories: {
                    'handmade-items': {
                        name: 'Handmade Items',
                        icon: '‚úã',
                        subcategories: ['pottery', 'woodwork', 'textiles', 'paintings', 'sculptures', 'decorative-items']
                    },
                    'craft-supplies': {
                        name: 'Craft Supplies',
                        icon: 'üñåÔ∏è',
                        subcategories: ['paints', 'brushes', 'canvas', 'clay', 'fabrics', 'beads']
                    }
                }
            },
            travel: {
                id: 'travel',
                name: 'Travel & Tourism',
                icon: '‚úàÔ∏è',
                categories: {
                    'travel-planning': {
                        name: 'Travel Planning',
                        icon: 'üó∫Ô∏è',
                        subcategories: ['tour-packages', 'hotel-booking', 'flight-booking', 'visa-assistance', 'travel-insurance']
                    },
                    'local-tours': {
                        name: 'Local Tours',
                        icon: 'üöå',
                        subcategories: ['city-tours', 'adventure-tours', 'cultural-tours', 'food-tours', 'nature-walks']
                    }
                }
            },
            // üÜï NEW CATEGORIES
            'pet-services': {
                id: 'pet-services',
                name: 'Pet Services & Supplies',
                icon: 'üêæ',
                categories: {
                    'pet-grooming': {
                        name: 'Pet Grooming',
                        icon: '‚úÇÔ∏è',
                        subcategories: ['dog-grooming', 'cat-grooming', 'nail-trimming', 'pet-bathing', 'fur-styling']
                    },
                    'pet-supplies': {
                        name: 'Pet Supplies', 
                        icon: 'ü¶¥',
                        subcategories: ['pet-food', 'toys', 'leashes-collars', 'pet-beds', 'pet-accessories']
                    },
                    'veterinary': {
                        name: 'Veterinary Services',
                        icon: 'ü©∫', 
                        subcategories: ['health-checkups', 'vaccinations', 'pet-surgery', 'emergency-care']
                    }
                }
            },
            'real-estate': {
                id: 'real-estate',
                name: 'Real Estate Services',
                icon: 'üè†',
                categories: {
                    'property-sales': {
                        name: 'Property Sales',
                        icon: 'üèòÔ∏è',
                        subcategories: ['residential-sales', 'commercial-sales', 'plot-sales', 'investment-properties']
                    },
                    'rentals': {
                        name: 'Property Rentals',
                        icon: 'üîë',
                        subcategories: ['house-rentals', 'apartment-rentals', 'commercial-rentals', 'pg-hostels']
                    },
                    'property-management': {
                        name: 'Property Management',
                        icon: 'üìã',
                        subcategories: ['maintenance', 'tenant-management', 'property-valuation', 'legal-services']
                    }
                }
            },
            'event-services': {
                id: 'event-services', 
                name: 'Event & Wedding Services',
                icon: 'üéâ',
                categories: {
                    'wedding-planning': {
                        name: 'Wedding Planning',
                        icon: 'üíí',
                        subcategories: ['wedding-decor', 'catering', 'photography', 'venue-booking', 'invitation-cards']
                    },
                    'event-management': {
                        name: 'Event Management', 
                        icon: 'üé™',
                        subcategories: ['corporate-events', 'birthday-parties', 'cultural-events', 'exhibitions']
                    },
                    'entertainment': {
                        name: 'Entertainment Services',
                        icon: 'üéµ',
                        subcategories: ['dj-services', 'live-music', 'dance-performances', 'anchor-services']
                    }
                }
            },
            'agriculture': {
                id: 'agriculture',
                name: 'Agriculture & Farming', 
                icon: 'üåæ',
                categories: {
                    'crop-farming': {
                        name: 'Crop Farming',
                        icon: 'üå±',
                        subcategories: ['organic-vegetables', 'fruits', 'grains', 'spices', 'medicinal-plants']
                    },
                    'dairy-farming': {
                        name: 'Dairy & Livestock',
                        icon: 'üêÑ', 
                        subcategories: ['fresh-milk', 'dairy-products', 'poultry', 'goat-farming', 'fish-farming']
                    },
                    'farm-equipment': {
                        name: 'Farm Equipment',
                        icon: 'üöú',
                        subcategories: ['tractors', 'farming-tools', 'irrigation-systems', 'seeds-fertilizers']
                    }
                }
            },
            'others': {
                id: 'others',
                name: 'Other Services',
                icon: 'üîß', 
                categories: {
                    'general-services': {
                        name: 'General Services',
                        icon: '‚öôÔ∏è',
                        subcategories: ['consulting', 'maintenance', 'repairs', 'installations', 'custom-services']
                    },
                    'specialty-products': {
                        name: 'Specialty Products',
                        icon: 'üéÅ',
                        subcategories: ['custom-products', 'handmade-items', 'imported-goods', 'unique-services']
                    }
                }
            }
        };

        // Enhanced subcategory names with all new mappings
        const subcategoryNames = {
            // Fashion & Boutique
            'shirts': 'Shirts', 'pants': 'Pants', 'suits': 'Suits', 'ethnic-wear': 'Ethnic Wear',
            'casual-wear': 'Casual Wear', 'formal-wear': 'Formal Wear', 'kurtas': 'Kurtas', 'sherwanis': 'Sherwanis',
            'dresses': 'Dresses', 'tops': 'Tops', 'bottoms': 'Bottoms', 'sarees': 'Sarees',
            'lehengas': 'Lehengas', 'salwar-suits': 'Salwar Suits', 'western-wear': 'Western Wear', 'kurtis': 'Kurtis',
            'bags': 'Bags', 'belts': 'Belts', 'wallets': 'Wallets', 'scarves': 'Scarves',
            'hats': 'Hats', 'sunglasses': 'Sunglasses', 'watches': 'Watches', 'jewelry': 'Jewelry',
            'mens-shoes': "Men's Shoes", 'womens-shoes': "Women's Shoes", 'sandals': 'Sandals',
            'boots': 'Boots', 'sneakers': 'Sneakers', 'ethnic-footwear': 'Ethnic Footwear',

            // Food & Catering
            'rotis-parathas': 'Rotis & Parathas', 'curries': 'Curries', 'dal-preparations': 'Dal',
            'rice-dishes': 'Rice Dishes', 'snacks': 'Snacks', 'biryanis': 'Biryanis', 'tandoor-items': 'Tandoor Items',
            'dosas': 'Dosas', 'idlis': 'Idlis', 'vadas': 'Vadas', 'uttapam': 'Uttapam',
            'sambar': 'Sambar', 'rasam': 'Rasam', 'chutneys': 'Chutneys', 'appams': 'Appams',
            'traditional-sweets': 'Traditional Sweets', 'cakes': 'Cakes', 'pastries': 'Pastries',
            'ice-creams': 'Ice Creams', 'mithai': 'Mithai', 'cookies': 'Cookies',

            // Salon & Beauty
            'haircuts': 'Haircuts', 'hair-coloring': 'Hair Coloring', 'hair-styling': 'Hair Styling',
            'hair-treatments': 'Hair Treatments', 'keratin': 'Keratin Treatment', 'rebonding': 'Rebonding',
            'facials': 'Facials', 'makeup': 'Makeup', 'eyebrow-threading': 'Eyebrow Threading',
            'manicure': 'Manicure', 'pedicure': 'Pedicure', 'waxing': 'Waxing',

            // Electronics
            'smartphones': 'Smartphones', 'tablets': 'Tablets', 'accessories': 'Accessories',
            'chargers': 'Chargers', 'cases': 'Cases', 'headphones': 'Headphones',
            'laptops': 'Laptops', 'desktops': 'Desktops', 'monitors': 'Monitors',

            // üÜï PET SERVICES
            'dog-grooming': 'Dog Grooming', 'cat-grooming': 'Cat Grooming', 'nail-trimming': 'Nail Trimming',
            'pet-bathing': 'Pet Bathing', 'fur-styling': 'Fur Styling', 'pet-food': 'Pet Food', 'toys': 'Pet Toys',
            'leashes-collars': 'Leashes & Collars', 'pet-beds': 'Pet Beds', 'pet-accessories': 'Pet Accessories',
            'health-checkups': 'Health Checkups', 'vaccinations': 'Vaccinations', 'pet-surgery': 'Pet Surgery', 
            'emergency-care': 'Emergency Care',

            // üÜï REAL ESTATE  
            'residential-sales': 'Residential Sales', 'commercial-sales': 'Commercial Sales', 'plot-sales': 'Plot Sales',
            'investment-properties': 'Investment Properties', 'house-rentals': 'House Rentals', 
            'apartment-rentals': 'Apartment Rentals', 'commercial-rentals': 'Commercial Rentals', 'pg-hostels': 'PG & Hostels',
            'tenant-management': 'Tenant Management', 'property-valuation': 'Property Valuation',

            // üÜï EVENTS & WEDDINGS
            'wedding-decor': 'Wedding Decoration', 'catering': 'Catering Services', 'photography': 'Photography & Videography',
            'venue-booking': 'Venue Booking', 'invitation-cards': 'Invitation Cards', 'corporate-events': 'Corporate Events',
            'birthday-parties': 'Birthday Parties', 'cultural-events': 'Cultural Events', 'exhibitions': 'Exhibitions',
            'dj-services': 'DJ Services', 'live-music': 'Live Music', 'dance-performances': 'Dance Performances',
            'anchor-services': 'Anchor Services',

            // üÜï AGRICULTURE
            'organic-vegetables': 'Organic Vegetables', 'fruits': 'Fresh Fruits', 'grains': 'Grains & Cereals',
            'spices': 'Spices & Herbs', 'medicinal-plants': 'Medicinal Plants', 'fresh-milk': 'Fresh Milk',
            'dairy-products': 'Dairy Products', 'poultry': 'Poultry & Eggs', 'goat-farming': 'Goat Farming',
            'fish-farming': 'Fish Farming', 'tractors': 'Tractors', 'farming-tools': 'Farming Tools',
            'irrigation-systems': 'Irrigation Systems', 'seeds-fertilizers': 'Seeds & Fertilizers',

            // üÜï OTHERS
            'consulting': 'Consulting Services', 'maintenance': 'Maintenance Services', 'repairs': 'Repair Services',
            'installations': 'Installation Services', 'custom-services': 'Custom Services', 'custom-products': 'Custom Products',
            'handmade-items': 'Handmade Items', 'imported-goods': 'Imported Goods', 'unique-services': 'Unique Services'
        };

        // üÜï BACK BUTTON FUNCTIONALITY
        function updateBackButton() {
            const backButton = document.getElementById('backButton');
            const canGoBack = navigationHistory.length > 1 && currentStep !== 'welcome';
            
            if (canGoBack) {
                backButton.classList.remove('hidden');
            } else {
                backButton.classList.add('hidden');
            }
        }

        function goBack() {
            if (navigationHistory.length > 1) {
                // Remove current step from history
                navigationHistory.pop();
                // Get previous step
                const previousStep = navigationHistory[navigationHistory.length - 1];
                currentStep = previousStep;
                showScreen(previousStep);
                updateBackButton();
                addDebugLog(`üîô Navigated back to: ${previousStep}`);
            }
        }

        // üÜï RESPONSIVE NAVIGATION FUNCTIONS
        function navigateToStep(stepId) {
            if (!progressSteps.includes(stepId)) {
                addDebugLog(`‚ùå Navigation blocked: ${stepId} (not in progress steps)`);
                return;
            }
            
            const targetProgressIndex = progressSteps.indexOf(stepId);
            const currentProgressIndex = progressSteps.indexOf(currentStep);
            
            if (targetProgressIndex <= currentProgressIndex || currentStep === 'welcome' || currentStep === 'language') {
                showScreen(stepId);
                addDebugLog(`üì± Navigated to: ${stepId} via progress bar`);
            } else {
                showNotification('Complete current step first', 'warning');
                addDebugLog(`‚ùå Navigation blocked: ${stepId} (step not available yet)`);
            }
        }

        function updateProgressBar(activeStep) {
            const progressElements = document.querySelectorAll('.progress-step');
            const activeProgressIndex = progressSteps.indexOf(activeStep);
            
            progressElements.forEach((step, index) => {
                const stepData = step.getAttribute('data-step');
                const stepProgressIndex = progressSteps.indexOf(stepData);
                
                step.classList.remove('completed', 'in-progress');
                
                if (stepProgressIndex < activeProgressIndex) {
                    step.classList.add('completed');
                } else if (stepProgressIndex === activeProgressIndex) {
                    step.classList.add('in-progress');
                }
            });
            
            addDebugLog(`üìä Progress bar updated: ${activeStep} (${activeProgressIndex + 1}/${progressSteps.length})`);
        }

        // üîç DEBUG LOGGING
        function addDebugLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            debugLogs.push({ timestamp, message, type });
            
            console.log(`üîç DEBUG: ${message}`);
            
            const debugLogEl = document.getElementById('debugLog');
            if (debugLogEl) {
                debugLogEl.innerHTML = debugLogs.slice(-15).map(log => 
                    `<div style="color: ${log.type === 'error' ? '#ff6b6b' : log.type === 'success' ? '#51cf66' : '#74c0fc'}; margin-bottom: 3px; font-size: 0.7rem;">
                        [${log.timestamp.split(':').slice(-2).join(':')}] ${log.message}
                    </div>`
                ).join('');
                debugLogEl.scrollTop = debugLogEl.scrollHeight;
            }
        }

        function toggleDebugPanel() {
            const panel = document.getElementById('debugPanel');
            panel.classList.toggle('show');
        }

        // üîå DATABASE FUNCTIONS
        async function saveToSupabase(data, table) {
            try {
                addDebugLog(`üíæ Saving to ${table}`);
                
                const response = await fetch(`${SUPABASE_URL}/rest/v1/${table}`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=representation'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const result = await response.json();
                    addDebugLog(`‚úÖ Saved to ${table}`, 'success');
                    return { success: true, data: result };
                } else {
                    const errorText = await response.text();
                    addDebugLog(`‚ùå Save failed: ${response.status}`, 'error');
                    return { success: false, error: `${response.status}: ${errorText}` };
                }
            } catch (error) {
                addDebugLog(`‚ùå Save error: ${error.message}`, 'error');
                return { success: false, error: error.message };
            }
        }

        // üìä LEAD SCORING
        function calculateLeadScore() {
            let score = 0;
            
            if (selectedLanguage) score += 5;
            score += Math.min(selectedGoals.length * 10, 50);
            score += Math.floor(formProgress * 0.25);
            
            const sessionMinutes = (Date.now() - sessionStartTime) / 60000;
            if (sessionMinutes > 1) score += 5;
            if (sessionMinutes > 3) score += 5;
            
            score += Math.min(pageViews * 2, 10);
            score += Math.min(selectedCategories.length * 5, 25);
            score += Math.min(userProducts.length * 3, 15);
            if (selectedTheme) score += 5;
            
            // Qualifying questions scoring
            let qualifyingScore = 0;
            
            switch (qualifyingAnswers.online_presence) {
                case 'none': qualifyingScore += 8; break;
                case 'whatsapp': qualifyingScore += 6; break;
                case 'social': qualifyingScore += 4; break;
                case 'basic_website': qualifyingScore += 3; break;
                case 'full_website': qualifyingScore += 2; break;
            }
            
            switch (qualifyingAnswers.budget) {
                case '25000+': qualifyingScore += 8; break;
                case '10000-25000': qualifyingScore += 6; break;
                case '5000-10000': qualifyingScore += 4; break;
            }
            
            if (qualifyingAnswers.decision_maker === 'yes') qualifyingScore += 5;
            
            switch (qualifyingAnswers.timeline) {
                case 'immediately': qualifyingScore += 4; break;
                case 'within_week': qualifyingScore += 3; break;
                case 'this_month': qualifyingScore += 2; break;
                case 'just_checking': qualifyingScore += 1; break;
            }
            
            score += Math.min(qualifyingScore, 25);
            leadScore = Math.min(score, 100);
            
            updateLeadScoreWidget();
            addDebugLog(`üìä Lead Score: ${leadScore}/100`);
            return leadScore;
        }

        // üéØ LEAD SCORE WIDGET
        function updateLeadScoreWidget() {
            const scoreValue = document.getElementById('leadScoreValue');
            const scoreCircle = document.getElementById('leadScoreCircle');
            const scoreLabel = document.getElementById('scoreLabel');
            
            if (scoreValue) scoreValue.textContent = leadScore;
            
            let quality, circleClass;
            if (leadScore >= 70) {
                quality = 'Hot';
                circleClass = 'hot';
            } else if (leadScore >= 40) {
                quality = 'Warm';
                circleClass = 'warm';
            } else {
                quality = 'Cold';
                circleClass = 'cold';
            }
            
            if (scoreLabel) scoreLabel.textContent = quality;
            if (scoreCircle) {
                scoreCircle.className = `score-circle ${circleClass}`;
            }
        }

        function toggleScoreDetails() {
            const sessionMinutes = Math.round((Date.now() - sessionStartTime) / 60000);
            showNotification(`Score: ${leadScore}/100 | Quality: ${leadScore >= 70 ? 'Hot' : leadScore >= 40 ? 'Warm' : 'Cold'} | Session: ${sessionMinutes}m | Views: ${pageViews}`, 'info');
        }

        // üÜï DYNAMIC MOTIVATIONAL MESSAGES SYSTEM
        function updateMotivationalMessages() {
            if (currentStep !== 'categories') return;
            
            const messagesContainer = document.getElementById('motivationalMessages');
            if (!messagesContainer) return;
            
            // Stop any existing interval
            stopMotivationalMessages();
            
            // Start new message rotation
            currentMessageIndex = 0;
            showNextMessage();
            
            // Set interval for automatic rotation
            messageInterval = setInterval(() => {
                showNextMessage();
            }, 4000); // 4 second intervals
            
            addDebugLog('üîÑ Dynamic messages started', 'success');
        }

        function showNextMessage() {
            if (currentStep !== 'categories') {
                stopMotivationalMessages();
                return;
            }
            
            const messagesContainer = document.getElementById('motivationalMessages');
            if (!messagesContainer) return;
            
            const message = generatePersonalizedMessage(currentMessageIndex);
            showNewMessage(message, messagesContainer);
            
            currentMessageIndex = (currentMessageIndex + 1) % motivationalMessageTemplates.length;
        }

        function generatePersonalizedMessage(index) {
            const template = motivationalMessageTemplates[index];
            const currentProgressIndex = progressSteps.indexOf(currentStep);
            const stepsLeft = progressSteps.length - currentProgressIndex - 1;
            const plural = stepsLeft !== 1 ? 's' : '';
            const businessDisplayName = businessName || 'your business';
            
            // Get category name without emoji
            const categoryDropdown = document.getElementById('category');
            let categoryName = 'your category';
            if (categoryDropdown && categoryDropdown.value) {
                const categoryText = categoryDropdown.options[categoryDropdown.selectedIndex].text;
                categoryName = categoryText.replace(/^[^\w\s]+\s*/, ''); // Remove emoji and spaces
            }
            
            return template
                .replace('{stepsLeft}', stepsLeft.toString())
                .replace('{plural}', plural)
                .replace('{businessName}', businessDisplayName)
                .replace('{category}', categoryName);
        }

        function showNewMessage(messageText, container) {
            // Remove existing messages
            const existingMessages = container.querySelectorAll('.motivational-message');
            existingMessages.forEach(msg => {
                msg.classList.add('exit');
                setTimeout(() => {
                    if (msg.parentNode) {
                        msg.parentNode.removeChild(msg);
                    }
                }, 500);
            });
            
            // Create new message
            const messageEl = document.createElement('div');
            messageEl.className = 'motivational-message';
            messageEl.textContent = messageText;
            
            container.appendChild(messageEl);
            
            // Trigger animation
            setTimeout(() => {
                messageEl.classList.add('active');
            }, 100);
        }

        function stopMotivationalMessages() {
            if (messageInterval) {
                clearInterval(messageInterval);
                messageInterval = null;
                addDebugLog('üîÑ Dynamic messages stopped', 'info');
            }
        }

        // üÜï SMART HELP SECTION FOR PRODUCTS SCREEN
        function updateProductsHelpSection() {
            const dayOfMonth = new Date().getDate();
            const totalDaysInMonth = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0).getDate();
            
            // Calculate claimed percentage based on day (30-90%)
            const minPercentage = 30;
            const maxPercentage = 90;
            const dailyIncrease = (maxPercentage - minPercentage) / totalDaysInMonth;
            const currentPercentage = Math.min(minPercentage + (dailyIncrease * dayOfMonth), maxPercentage);
            
            const claimedCount = Math.floor((currentPercentage / 100) * 75);
            const remainingSlots = 75 - claimedCount;
            const isUrgent = remainingSlots <= 15;
            
            // Update DOM elements
            const helpSection = document.getElementById('productsHelpSection');
            const titleEl = document.getElementById('productsHelpTitle');
            const progressFillEl = document.getElementById('productsHelpProgressFill');
            const textEl = document.getElementById('productsHelpText');
            const claimedCountEl = document.getElementById('productsClaimedCount');
            const monthEl = document.getElementById('productsCurrentMonth');
            
            if (helpSection && titleEl && progressFillEl && textEl && claimedCountEl && monthEl) {
                // Update urgency styling
                if (isUrgent) {
                    helpSection.classList.add('urgent');
                    titleEl.innerHTML = `üö® Free Professional Setup Available! <span class="urgent-text">Only ${remainingSlots} spots left!</span>`;
                } else {
                    helpSection.classList.remove('urgent');
                    titleEl.textContent = 'üéØ Free Professional Setup Available!';
                }
                
                // Update progress bar
                progressFillEl.style.width = `${currentPercentage}%`;
                
                // Update text content
                claimedCountEl.textContent = claimedCount;
                monthEl.textContent = new Date().toLocaleString('en-US', { month: 'long' });
                
                if (isUrgent) {
                    textEl.innerHTML = `Topiko is helping with free setup for 75 businesses every month. <span class="urgent-text">${claimedCount} claimed for ${monthEl.textContent}. Only ${remainingSlots} spots left!</span> Click here for help!`;
                } else {
                    textEl.innerHTML = `Topiko is helping with free setup for 75 businesses every month. ${claimedCount} claimed for ${monthEl.textContent}. Click here for help!`;
                }
                
                addDebugLog(`üìä Help section updated: ${claimedCount}/75 claimed (${currentPercentage.toFixed(1)}%)`, 'info');
            }
        }

        // üîÑ SCREEN NAVIGATION
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                pageViews++;
                
                // Update navigation history
                if (currentStep !== screenId) {
                    currentStep = screenId;
                    if (navigationHistory[navigationHistory.length - 1] !== screenId) {
                        navigationHistory.push(screenId);
                    }
                }
                
                updateProgressBar(currentStep);
                updateBackButton();
                
                // Stop motivational messages when leaving categories
                if (screenId !== 'categories') {
                    stopMotivationalMessages();
                }
                
                if (screenId === 'categories') {
                    loadCategories();
                    updateMotivationalMessages();
                }
                
                if (screenId === 'products') {
                    updateProductsHelpSection();
                }
                
                if (screenId === 'themes') {
                    populateThemePreviews();
                }

                // Add personalization
                addPersonalization(screenId);
                
                addDebugLog(`üì± Screen: ${screenId} (views: ${pageViews})`);
                calculateLeadScore();
            }
        }

        // üÜï PERSONALIZATION FUNCTION
        function addPersonalization(screenId) {
            const name = userName || document.getElementById('fullName')?.value || '';
            const business = businessName || document.getElementById('businessName')?.value || '';
            
            if (screenId === 'qualifying-questions' && name) {
                const titleEl = document.getElementById('qualifyingTitle');
                if (titleEl) {
                    titleEl.innerHTML = `Hi ${name}! Let's setup things for you`;
                }
            }
            
            if (screenId === 'categories' && business) {
                const titleEl = document.getElementById('categoriesTitle');
                if (titleEl) {
                    titleEl.innerHTML = `Select Categories for ${business}`;
                }
            }
            
            if (screenId === 'products' && business) {
                const titleEl = document.getElementById('productsTitle');
                const formTitleEl = document.getElementById('productFormTitle');
                if (titleEl) {
                    titleEl.innerHTML = `Add Products for ${business}`;
                }
                if (formTitleEl) {
                    formTitleEl.innerHTML = `Add ${business}'s Products/Services`;
                }
            }
            
            if (screenId === 'themes' && business) {
                const titleEl = document.getElementById('themesTitle');
                if (titleEl) {
                    titleEl.innerHTML = `Choose ${business}'s Theme`;
                }
            }
        }

        // üöÄ LEAD FLOW FUNCTIONS
        function startLeadFlow() {
            addDebugLog('üöÄ Lead flow started');
            showScreen('language');
        }

        function selectLanguage(lang, element) {
            selectedLanguage = lang;
            
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            const languageNames = { 'en': 'English', 'hi': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', 'te': '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å', 'ta': '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç' };
            showNotification(`Language: ${languageNames[lang]}`, 'success');
            calculateLeadScore();
            
            setTimeout(() => showScreen('goals'), 1500);
        }

        function updateGoalsTracking() {
            const checkedGoals = document.querySelectorAll('.goal-checkbox:checked');
            selectedGoals = Array.from(checkedGoals).map(checkbox => checkbox.value);
            addDebugLog(`Goals: ${selectedGoals.length} selected`);
            calculateLeadScore();
        }

        function submitGoals() {
            if (selectedGoals.length === 0) {
                showNotification('Please select at least one goal', 'error');
                return;
            }
            
            showNotification(`Perfect! ${selectedGoals.length} goal${selectedGoals.length > 1 ? 's' : ''} selected!`, 'success');
            calculateLeadScore();
            
            setTimeout(() => {
                displayGoalsTransitionModal();
            }, 1500);
        }

        function trackFormProgress() {
            const formFields = ['fullName', 'email', 'phoneNumber', 'businessName', 'address', 'businessType', 'category'];
            let completedFields = 0;
            
            formFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && field.value.trim() !== '') {
                    completedFields++;
                }
            });
            
            formProgress = (completedFields / formFields.length) * 100;
            
            // Store names for personalization
            userName = document.getElementById('fullName')?.value || '';
            businessName = document.getElementById('businessName')?.value || '';
            
            addDebugLog(`Form progress: ${Math.round(formProgress)}%`);
            calculateLeadScore();
        }

        async function submitRegistration() {
            addDebugLog('üìù Registration submission');
            
            const name = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phoneNumber').value.trim();
            const business = document.getElementById('businessName').value.trim();
            const address = document.getElementById('address').value.trim();
            const type = document.getElementById('businessType').value;
            const category = document.getElementById('category').value;

            if (!name || !email || !phone || !business || !type || !category) {
                showNotification('Please fill all required fields', 'error');
                return;
            }

            // Store for personalization
            userName = name;
            businessName = business;

            // Show OTP verification modal
            showOtpModal();
        }

        // üÜï OTP VERIFICATION FUNCTIONS
        function showOtpModal() {
            showModal('otpVerificationModal');
            // Auto-fill with default OTP
            setTimeout(() => {
                const otpInputs = document.querySelectorAll('.otp-input');
                const defaultOtp = '1111';
                otpInputs.forEach((input, index) => {
                    input.value = defaultOtp[index];
                    input.classList.add('filled');
                });
            }, 500);
        }

        function handleOtpInput(input, index) {
            if (input.value) {
                input.classList.add('filled');
                // Move to next input
                const nextInput = input.nextElementSibling;
                if (nextInput) {
                    nextInput.focus();
                }
            } else {
                input.classList.remove('filled');
            }
            
            // Check if all inputs are filled
            const otpInputs = document.querySelectorAll('.otp-input');
            const otp = Array.from(otpInputs).map(input => input.value).join('');
            const verifyBtn = document.getElementById('verifyOtpBtn');
            
            if (otp.length === 4) {
                verifyBtn.disabled = false;
                verifyBtn.style.opacity = '1';
            } else {
                verifyBtn.disabled = true;
                verifyBtn.style.opacity = '0.5';
            }
        }

        async function verifyOtp() {
            const otpInputs = document.querySelectorAll('.otp-input');
            const otp = Array.from(otpInputs).map(input => input.value).join('');
            
            if (otp === '1111') {
                closeModal('otpVerificationModal');
                showNotification('‚úÖ Phone verified successfully!', 'success');
                
                // Proceed with actual registration
                await completeRegistration();
            } else {
                showNotification('Invalid OTP. Please try again.', 'error');
            }
        }

        async function completeRegistration() {
            const name = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phoneNumber').value.trim();
            const business = document.getElementById('businessName').value.trim();
            const address = document.getElementById('address').value.trim();
            const type = document.getElementById('businessType').value;
            const category = document.getElementById('category').value;

            showNotification('Creating your free account...', 'info');
            
            const userData = {
                name, email, phone,
                business_name: business,
                business_type: type,
                business_category: category,
                address: address || null,
                selected_language: selectedLanguage,
                selected_goals: selectedGoals,
                created_at: new Date().toISOString()
            };

            const userResult = await saveToSupabase(userData, 'users');
            
            if (userResult.success && userResult.data && userResult.data.length > 0) {
                currentUserId = userResult.data[0].id;
                addDebugLog(`‚úÖ User created: ${currentUserId}`, 'success');
                
                const leadData = {
                    user_id: currentUserId,
                    lead_score: leadScore,
                    lead_quality: leadScore >= 70 ? 'Hot' : leadScore >= 40 ? 'Warm' : 'Cold',
                    session_duration_minutes: Math.round((Date.now() - sessionStartTime) / 60000),
                    page_views: pageViews,
                    selected_goals: selectedGoals,
                    lead_status: 'New'
                };
                
                await saveToSupabase(leadData, 'lead_intelligence');
                
                showNotification(`üéâ Welcome ${name}! Account created successfully!`, 'success');
                setTimeout(() => {
                    displaySetupIntroModal();
                }, 2000);
            } else {
                showNotification('‚ùå Registration failed. Please try again.', 'error');
            }
        }

        function updateQualifyingData() {
            qualifyingAnswers.online_presence = document.querySelector('input[name="online_presence"]:checked')?.value || '';
            qualifyingAnswers.budget = document.querySelector('input[name="budget"]:checked')?.value || '';
            qualifyingAnswers.decision_maker = document.querySelector('input[name="decision_maker"]:checked')?.value || '';  
            qualifyingAnswers.timeline = document.querySelector('input[name="timeline"]:checked')?.value || '';
            
            calculateLeadScore();
            
            const allAnswered = Object.values(qualifyingAnswers).every(answer => answer !== '');
            const nextBtn = document.getElementById('qualifyingNextBtn');
            
            if (allAnswered) {
                nextBtn.disabled = false;
                nextBtn.style.opacity = '1';
            } else {
                nextBtn.disabled = true;
                nextBtn.style.opacity = '0.5';
            }
        }

        async function proceedToCategories() {
            if (Object.values(qualifyingAnswers).some(answer => answer === '')) {
                showNotification('Please answer all questions', 'error');
                return;
            }
            
            addDebugLog(`Qualifying complete: ${JSON.stringify(qualifyingAnswers)}`);
            showNotification('Perfect! Moving to categories...', 'success');
            setTimeout(() => showScreen('categories'), 1000);
        }

        async function requestFollowup() {
            if (!currentUserId) {
                showNotification('Please complete registration first', 'warning');
                return;
            }

            const followupData = {
                user_id: currentUserId,
                requested_followup: true,
                followup_type: 'free_setup_help',
                requested_at: new Date().toISOString(),
                lead_status: 'Requested Followup'
            };

            const result = await saveToSupabase(followupData, 'followup_requests');
            
            if (result.success) {
                showNotification('üéØ Great! Our team will contact you within 2 hours for free setup assistance!', 'success');
                helpClaimedCount++;
                updateProductsHelpSection();
                addDebugLog('‚úÖ Followup requested successfully', 'success');
                
                // Update help section text
                const helpSection = document.getElementById('productsHelpSection');
                if (helpSection) {
                    helpSection.innerHTML = `
                        <div class="help-title">‚úÖ Help Requested!</div>
                        <div class="help-text" style="color: #059669; font-weight: 600;">
                            Our team will contact you within 2 hours for free setup assistance!
                        </div>
                    `;
                    helpSection.onclick = null;
                    helpSection.style.cursor = 'default';
                }
            } else {
                showNotification('‚ùå Failed to request help. Please try again.', 'error');
            }
        }

        function loadCategories() {
            const businessCategory = document.getElementById('category')?.value;
            const categoriesContainer = document.getElementById('categoriesContainer');
            
            if (!categoriesContainer) return;
            
            if (!businessCategory || !businessCategories[businessCategory]) {
                categoriesContainer.innerHTML = '<p style="text-align: center; color: #64748b;">Loading categories...</p>';
                
                // Fix mobile issue - retry after short delay
                setTimeout(() => {
                    const retryCategory = document.getElementById('category')?.value;
                    if (retryCategory && businessCategories[retryCategory]) {
                        loadCategoriesContent(retryCategory, categoriesContainer);
                    } else {
                        categoriesContainer.innerHTML = '<p style="text-align: center; color: #64748b;">Please complete registration first.</p>';
                    }
                }, 100);
                return;
            }
            
            loadCategoriesContent(businessCategory, categoriesContainer);
        }

        function loadCategoriesContent(businessCategory, categoriesContainer) {
            const categoryData = businessCategories[businessCategory];
            
            let categoriesHTML = `
                <div class="category-section">
                    <h3><span style="margin-right: 0.5rem;">${categoryData.icon}</span>${categoryData.name} Categories</h3>
                    <p style="color: #553c9a; margin-bottom: 1.5rem; font-size: 0.9rem;">Select categories that apply to your business (this helps us create your perfect online store):</p>
                    
                    <div class="category-grid">
            `;
            
            Object.keys(categoryData.categories).forEach(categoryKey => {
                const category = categoryData.categories[categoryKey];
                const isSelected = selectedCategories.includes(categoryKey);
                
                categoriesHTML += `
                    <div class="category-item">
                        <input type="checkbox" id="cat-${categoryKey}" value="${categoryKey}" class="category-checkbox" 
                               ${isSelected ? 'checked' : ''} onchange="toggleCategorySelection('${categoryKey}')">
                        <label for="cat-${categoryKey}" class="category-label">
                            <span class="category-icon">${category.icon}</span>
                            ${category.name}
                            <span class="category-checkmark">‚úì</span>
                        </label>
                        
                        <div class="subcategory-grid">
                `;
                
                category.subcategories.forEach(subcategoryKey => {
                    const subcategoryName = subcategoryNames[subcategoryKey] || subcategoryKey.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
                    const isSubSelected = selectedSubcategories.includes(subcategoryKey);
                    
                    categoriesHTML += `
                        <div class="subcategory-item">
                            <input type="checkbox" id="sub-${subcategoryKey}" value="${subcategoryKey}" class="subcategory-checkbox"
                                   ${isSubSelected ? 'checked' : ''} onchange="toggleSubcategorySelection('${subcategoryKey}')">
                            <label for="sub-${subcategoryKey}" class="subcategory-label">
                                ${subcategoryName}
                                <span class="subcategory-checkmark">‚úì</span>
                            </label>
                        </div>
                    `;
                });
                
                categoriesHTML += `
                        </div>
                    </div>
                `;
            });
            
            categoriesHTML += `
                    </div>
                </div>
            `;
            
            categoriesContainer.innerHTML = categoriesHTML;
            updateProductCategoriesDropdown();
            updateSelectionSummary();
        }

        function toggleCategorySelection(categoryKey) {
            if (selectedCategories.includes(categoryKey)) {
                selectedCategories = selectedCategories.filter(cat => cat !== categoryKey);
            } else {
                selectedCategories.push(categoryKey);
            }
            
            updateSelectionSummary();
            updateProductCategoriesDropdown();
            calculateLeadScore();
            updateNextButton();
        }

        function toggleSubcategorySelection(subcategoryKey) {
            if (selectedSubcategories.includes(subcategoryKey)) {
                selectedSubcategories = selectedSubcategories.filter(sub => sub !== subcategoryKey);
            } else {
                selectedSubcategories.push(subcategoryKey);
            }
            
            updateSelectionSummary();
            calculateLeadScore();
        }

        function updateSelectionSummary() {
            const summaryEl = document.getElementById('selectionSummary');
            const categoriesCountEl = document.getElementById('categoriesCount');
            const subcategoriesCountEl = document.getElementById('subcategoriesCount');
            
            if (selectedCategories.length > 0 || selectedSubcategories.length > 0) {
                summaryEl.style.display = 'block';
                categoriesCountEl.textContent = selectedCategories.length;
                subcategoriesCountEl.textContent = selectedSubcategories.length;
            } else {
                summaryEl.style.display = 'none';
            }
        }

        function updateNextButton() {
            const nextBtn = document.getElementById('categoryNextBtn');
            if (selectedCategories.length > 0) {
                nextBtn.disabled = false;
                nextBtn.style.opacity = '1';
            } else {
                nextBtn.disabled = true;
                nextBtn.style.opacity = '0.5';
            }
        }

        function updateProductCategoriesDropdown() {
            const productCategorySelect = document.getElementById('productCategory');
            const productSubcategorySelect = document.getElementById('productSubcategory');
            
            if (!productCategorySelect || !productSubcategorySelect) return;
            
            productCategorySelect.innerHTML = '<option value="">Select from your chosen categories</option>';
            productSubcategorySelect.innerHTML = '<option value="">Select a subcategory</option>';
            
            const businessCategory = document.getElementById('category')?.value;
            if (!businessCategory || !businessCategories[businessCategory]) return;
            
            const categoryData = businessCategories[businessCategory];
            
            selectedCategories.forEach(categoryKey => {
                const category = categoryData.categories[categoryKey];
                if (category) {
                    productCategorySelect.innerHTML += `<option value="${categoryKey}">${category.name}</option>`;
                }
            });
            
            productCategorySelect.onchange = function() {
                const selectedCat = this.value;
                productSubcategorySelect.innerHTML = '<option value="">Select a subcategory</option>';
                
                if (selectedCat && categoryData.categories[selectedCat]) {
                    const category = categoryData.categories[selectedCat];
                    category.subcategories.forEach(subcategoryKey => {
                        const subcategoryName = subcategoryNames[subcategoryKey] || subcategoryKey.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
                        productSubcategorySelect.innerHTML += `<option value="${subcategoryKey}">${subcategoryName}</option>`;
                    });
                }
            };
        }

        async function proceedToProducts() {
            if (selectedCategories.length === 0) {
                showNotification('Please select at least one category to continue', 'error');
                return;
            }
            
            showNotification(`Perfect! Moving to products with ${selectedCategories.length} categories selected...`, 'success');
            setTimeout(() => showScreen('products'), 1000);
        }

        async function addProduct() {
            const name = document.getElementById('productName').value.trim();
            const price = document.getElementById('productPrice').value.trim();
            const description = document.getElementById('productDescription').value.trim();
            const categoryKey = document.getElementById('productCategory').value;
            const subcategoryKey = document.getElementById('productSubcategory').value;
            const imageUrl = document.getElementById('productImage').value.trim();
            
            if (!name || !price || !description || !categoryKey) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            if (isNaN(price) || price <= 0) {
                showNotification('Please enter a valid price', 'error');
                return;
            }
            
            const product = {
                name, price: parseFloat(price), description, categoryKey,
                subcategoryKey: subcategoryKey || null,
                imageUrl: imageUrl || getDefaultProductImage(),
                createdAt: new Date().toISOString()
            };
            
            userProducts.push(product);
            
            if (currentUserId) {
                const productDbData = {
                    user_id: currentUserId, name, price: parseFloat(price), description,
                    category_key: categoryKey, subcategory_key: subcategoryKey || null,
                    image_url: imageUrl || null
                };
                
                const productResult = await saveToSupabase(productDbData, 'products');
                if (productResult.success) {
                    showNotification(`‚úÖ "${name}" added successfully!`, 'success');
                } else {
                    showNotification(`‚ö†Ô∏è "${name}" saved locally (will sync later)`, 'warning');
                }
            }
            
            // Clear form
            ['productName', 'productPrice', 'productDescription', 'productCategory', 'productSubcategory', 'productImage'].forEach(id => {
                const field = document.getElementById(id);
                if (field) field.value = '';
            });
            
            displayProducts();
            calculateLeadScore();
        }

        function getDefaultProductImage() {
            return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjFmNWY5Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNjM2NjcwIiBmb250LWZhbWlseT0iYXJpYWwiIGZvbnQtc2l6ZT0iNDAiPvCfk6Y8L3RleHQ+PC9zdmc+';
        }

        function displayProducts() {
            const productsList = document.getElementById('productsList');
            const productCount = document.getElementById('productCount');
            
            if (!productsList || !productCount) return;
            
            productCount.textContent = userProducts.length;
            
            if (userProducts.length === 0) {
                productsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #64748b; background: rgba(255, 255, 255, 0.5); border-radius: 12px;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üì¶</div>
                        <p>Add your first product to see how it will look online!</p>
                    </div>
                `;
                return;
            }
            
            const businessCategory = document.getElementById('category')?.value;
            const categoryData = businessCategories[businessCategory];
            
            productsList.innerHTML = userProducts.map(product => {
                const categoryName = categoryData?.categories[product.categoryKey]?.name || product.categoryKey;
                const subcategoryName = product.subcategoryKey ? 
                    (subcategoryNames[product.subcategoryKey] || product.subcategoryKey) : '';
                
                return `
                    <div class="product-card">
                        <div class="product-image" style="background-image: url('${product.imageUrl}');">
                            <div class="product-price">‚Çπ${product.price.toLocaleString()}</div>
                        </div>
                        <div class="product-content">
                            <div class="product-name">${product.name}</div>
                            <div class="product-description">${product.description}</div>
                            <div style="display: flex; justify-content: space-between; font-size: 0.7rem; color: #64748b; margin-top: 0.5rem;">
                                <span>üìÅ ${categoryName}</span>
                                ${subcategoryName ? `<span>üè∑Ô∏è ${subcategoryName}</span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function proceedToThemes() {
            if (userProducts.length === 0) {
                showNotification('Add at least one product to see how your store will look!', 'warning');
                return;
            }
            
            showNotification('Excellent! Loading beautiful themes for your store...', 'success');
            setTimeout(() => {
                showScreen('themes');
                populateThemePreviews();
            }, 1000);
        }

        function selectTheme(themeName, element) {
            selectedTheme = themeName;
            
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            const themeNames = {
                'modern': 'Modern & Minimalist',
                'vibrant': 'Colorful & Vibrant', 
                'professional': 'Professional & Corporate',
                'traditional': 'Traditional & Classic',
                'creative': 'Creative & Artistic',
                'luxury': 'Elegant & Luxury'
            };
            
            document.getElementById('selectedThemeName').textContent = themeNames[themeName];
            
            const nextBtn = document.getElementById('themeNextBtn');
            nextBtn.disabled = false;
            nextBtn.style.opacity = '1';
            
            showNotification(`Perfect choice! ${themeNames[themeName]} theme selected!`, 'success');
            calculateLeadScore();
        }

        function populateThemePreviews() {
            const themePreviewIds = ['modern-preview', 'vibrant-preview', 'professional-preview', 'traditional-preview', 'creative-preview', 'luxury-preview'];
            
            if (userProducts.length === 0) {
                themePreviewIds.forEach(previewId => {
                    const previewEl = document.getElementById(previewId);
                    if (previewEl) {
                        previewEl.innerHTML = `
                            <div class="theme-preview-item">Sample Product</div>
                            <div class="theme-preview-item">‚Çπ999</div>
                        `;
                    }
                });
                return;
            }
            
            const previewProducts = userProducts.slice(0, 2);
            
            themePreviewIds.forEach(previewId => {
                const previewEl = document.getElementById(previewId);
                if (previewEl) {
                    previewEl.innerHTML = previewProducts.map(product => 
                        `<div class="theme-preview-item">
                            <div style="font-weight: 600; margin-bottom: 2px; font-size: 0.7rem;">${product.name.substring(0, 15)}${product.name.length > 15 ? '...' : ''}</div>
                            <div style="color: #059669; font-weight: bold; font-size: 0.7rem;">‚Çπ${product.price.toLocaleString()}</div>
                        </div>`
                    ).join('');
                }
            });
        }

        async function completeSetup() {
            const finalScore = calculateLeadScore() + 10;
            
            const leadData = {
                user_id: currentUserId,
                name: userName,
                email: document.getElementById('email')?.value,
                phone: document.getElementById('phoneNumber')?.value,
                business_name: businessName,
                selected_goals: selectedGoals,
                selected_categories: selectedCategories,
                products_count: userProducts.length,
                selected_theme: selectedTheme,
                qualifying_answers: qualifyingAnswers,
                lead_score: finalScore,
                lead_quality: finalScore >= 70 ? 'Hot' : finalScore >= 40 ? 'Warm' : 'Cold',
                setup_completed: true,
                completed_at: new Date().toISOString()
            };
            
            // Save to database
            if (currentUserId) {
                await saveToSupabase(leadData, 'completed_setups');
            }
            
            // Save locally as backup
            const existingLeads = JSON.parse(localStorage.getItem('topiko_local_leads') || '[]');
            existingLeads.push(leadData);
            localStorage.setItem('topiko_local_leads', JSON.stringify(existingLeads));
            
            showNotification(`üéâ Congratulations ${userName}! Your business is ready to go online!`, 'success');
            
            setTimeout(() => {
                showCompletionSummary(finalScore);
            }, 2000);
        }

        function showCompletionSummary(finalScore) {
            const completionHTML = `
                <div class="content-card" style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 1rem; animation: bounce 2s infinite;">üéâ</div>
                    
                    <h2 style="color: #059669; font-size: 2rem; font-weight: 700; margin-bottom: 1rem;">
                        ${businessName} is Ready to Go Online!
                    </h2>
                    
                    <p style="color: #064e3b; font-size: 1rem; margin-bottom: 2rem;">
                        Your complete business setup is finished and ready to attract customers!
                    </p>

                    <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 16px; padding: 1.5rem; margin: 1.5rem 0;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                            <div style="background: rgba(255, 255, 255, 0.8); padding: 1rem; border-radius: 12px;">
                                <div style="font-size: 1.5rem; margin-bottom: 0.3rem;">üéØ</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: #059669;">${finalScore}</div>
                                <div style="color: #064e3b; font-size: 0.8rem;">Lead Score</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.8); padding: 1rem; border-radius: 12px;">
                                <div style="font-size: 1.5rem; margin-bottom: 0.3rem;">üì¶</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: #059669;">${userProducts.length}</div>
                                <div style="color: #064e3b; font-size: 0.8rem;">Products Ready</div>
                            </div>
                        </div>

                        <div style="background: rgba(34, 197, 94, 0.15); border-radius: 12px; padding: 1rem; text-align: left; font-size: 0.85rem;">
                            <h4 style="color: #059669; margin-bottom: 0.8rem;">üöÄ What Happens Next?</h4>
                            <p style="color: #064e3b; margin-bottom: 0.5rem;">‚úÖ Your business profile is now live and searchable</p>
                            <p style="color: #064e3b; margin-bottom: 0.5rem;">‚úÖ Our expert team will contact you within 24 hours</p>
                            <p style="color: #064e3b; margin-bottom: 0.5rem;">‚úÖ Free professional setup assistance included</p>
                            <p style="color: #064e3b;">‚úÖ Start attracting customers immediately!</p>
                        </div>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="goToDashboard()" class="submit-button">
                            View Your Business üìä
                        </button>
                        <button onclick="startOver()" class="btn-secondary">
                            Help Another Business üîÑ
                        </button>
                    </div>
                </div>
            `;
            
            const themesScreen = document.getElementById('themes');
            if (themesScreen) {
                themesScreen.innerHTML = completionHTML;
            }
        }

        function goToDashboard() {
            showNotification('Opening your business dashboard...', 'info');
            setTimeout(() => {
                // In production, this would redirect to the actual dashboard
                window.location.href = './dashboard.html';
            }, 1500);
        }

        function startOver() {
            if (confirm('Are you sure you want to start over? This will reset all progress.')) {
                location.reload();
            }
        }

        // üì¢ NOTIFICATION SYSTEM
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const content = document.getElementById('notificationContent');
            
            if (!notification || !content) {
                console.log(`Notification: ${message}`);
                return;
            }
            
            content.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // üéØ FOMO FUNCTIONS
        function getRandomBusinessData() {
            const business = indianBusinessNames[Math.floor(Math.random() * indianBusinessNames.length)];
            const city = indianCities[Math.floor(Math.random() * indianCities.length)];
            const template = fomoMessageTemplates[Math.floor(Math.random() * fomoMessageTemplates.length)];
            
            return {
                business, city, template,
                message: template.text.replace('{business}', business).replace('{city}', city)
            };
        }

        function showFomoNotification() {
            if (Date.now() - lastFomoShow < 10000) return;
            
            const fomoEl = document.getElementById('fomoNotification');
            const contentEl = document.getElementById('fomoContent');
            const timeEl = document.getElementById('fomoTime');
            const statusEl = document.querySelector('.fomo-status');
            
            if (!fomoEl || !contentEl || !timeEl || !statusEl) return;
            
            const data = getRandomBusinessData();
            
            contentEl.innerHTML = `<span class="business-name">${data.business}</span> from <span class="business-location">${data.city}</span> ${data.template.text.split('{business}')[1].split('{city}')[1]}`;
            timeEl.textContent = `${Math.floor(Math.random() * 15) + 1} minutes ago`;
            statusEl.textContent = data.template.status;
            
            fomoEl.classList.add('show');
            lastFomoShow = Date.now();
            
            setTimeout(() => {
                fomoEl.classList.remove('show');
                fomoEl.classList.add('hide');
                setTimeout(() => fomoEl.classList.remove('hide'), 500);
            }, 5000);
            
            businessCounter += Math.floor(Math.random() * 2) + 1;
            updateBusinessCounter();
        }

        function updateBusinessCounter() {
            const counterEl = document.getElementById('counterNumber');
            if (counterEl) {
                counterEl.textContent = businessCounter.toLocaleString();
            }
        }

        function showBusinessCounter() {
            const counterEl = document.getElementById('fomoCounter');
            if (counterEl) {
                counterEl.classList.add('show');
                setTimeout(() => counterEl.classList.remove('show'), 4000);
            }
        }

        function startFomoSystem() {
            setTimeout(() => showFomoNotification(), 8000);
            setTimeout(() => showBusinessCounter(), 15000);
            
            setInterval(() => {
                const randomDelay = Math.random() * 20000 + 25000;
                setTimeout(() => showFomoNotification(), randomDelay);
            }, 45000);
            
            setInterval(() => showBusinessCounter(), 90000);
        }

        // üÜï MODAL FUNCTIONS
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('show');
                addDebugLog(`üì± Modal shown: ${modalId}`);
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                addDebugLog(`üì± Modal closed: ${modalId}`);
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.classList.remove('show');
            }
        });

        // Goals transition modal
        function displayGoalsTransitionModal() {
            const goalNames = {
                ecommerce: 'üõí Sell Online',
                customers: 'üìà Reach More Customers', 
                manage: 'üë• Manage Customers',
                search: 'üîç Appear in Search Results',
                brand: '‚≠ê Establish Brand'
            };

            const modalGoalsList = document.getElementById('modalGoalsList');
            if (modalGoalsList) {
                modalGoalsList.innerHTML = selectedGoals.map(goal => 
                    `<div class="goal-pill">${goalNames[goal] || goal}</div>`
                ).join('');
            }
            
            showModal('goalsTransitionModal');
            addDebugLog(`Goals transition modal shown for: ${selectedGoals.join(', ')}`);
        }

        function proceedFromGoalsModal() {
            closeModal('goalsTransitionModal');
            setTimeout(() => showScreen('registration'), 500);
        }

        // Setup intro modal
        function displaySetupIntroModal() {
            const goalNames = {
                ecommerce: 'üõí Sell Online',
                customers: 'üìà Reach More Customers', 
                manage: 'üë• Manage Customers',
                search: 'üîç Appear in Search Results',
                brand: '‚≠ê Establish Brand'
            };

            const modalSetupGoalsList = document.getElementById('modalSetupGoalsList');
            if (modalSetupGoalsList) {
                modalSetupGoalsList.innerHTML = selectedGoals.map(goal => 
                    `<div style="background: rgba(34, 197, 94, 0.15); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 8px; padding: 0.8rem; color: #059669; font-weight: 600; font-size: 0.9rem; text-align: center;">
                        ${goalNames[goal] || goal}
                    </div>`
                ).join('');
            }
            
            showModal('setupIntroModal');
            addDebugLog(`Setup intro modal shown for: ${selectedGoals.join(', ')}`);
        }

        function proceedFromSetupModal() {
            closeModal('setupIntroModal');
            setTimeout(() => showScreen('qualifying-questions'), 500);
        }

        // üöÄ INITIALIZATION
        function initializeApp() {
            addDebugLog('üöÄ Enhanced Topiko Lead Form initializing', 'info');
            
            updateLeadScoreWidget();
            pageViews = 1;
            sessionStartTime = Date.now();
            updateProgressBar(currentStep);
            updateBackButton();
            
            setTimeout(() => startFomoSystem(), 3000);
            
            addDebugLog('‚úÖ Enhanced app initialized successfully', 'success');
        }

        // üéØ EVENT LISTENERS
        document.addEventListener('DOMContentLoaded', function() {
            addDebugLog('üì± DOM loaded - starting enhanced app');
            initializeApp();
            
            // Auto-save session data
            setInterval(() => {
                const currentData = {
                    selectedGoals, selectedLanguage, selectedCategories, selectedSubcategories,
                    userProducts, selectedTheme, qualifyingAnswers, leadScore, formProgress,
                    sessionStartTime, currentStep, navigationHistory, userName, businessName,
                    lastSaved: Date.now()
                };
                localStorage.setItem('topiko_current_session', JSON.stringify(currentData));
            }, 30000);
        });

        // Save data on page unload
        window.addEventListener('beforeunload', function(e) {
            const currentData = {
                selectedGoals, selectedLanguage, selectedCategories, selectedSubcategories,
                userProducts, selectedTheme, qualifyingAnswers, leadScore, formProgress,
                sessionStartTime, currentStep, navigationHistory, userName, businessName,
                lastSaved: Date.now()
            };
            localStorage.setItem('topiko_current_session', JSON.stringify(currentData));
            
            // Clean up intervals
            stopMotivationalMessages();
        });

        window.addEventListener('error', function(e) {
            addDebugLog(`‚ùå Error: ${e.error?.message || e.message}`, 'error');
        });

        addDebugLog('üì± Enhanced Topiko Lead Form loaded', 'success');
        console.log('üì± Enhanced Topiko Lead Form Ready');
        console.log('üéØ Features: Dynamic messages, smart help section, expanded categories, back buttons, OTP verification');
        
    </script>

    <!-- Modal HTML Structures -->
    
    <!-- Goals Transition Modal -->
    <div class="modal-overlay" id="goalsTransitionModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('goalsTransitionModal')">√ó</button>
            
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem; animation: bounce 2s infinite;">üéØ</div>
                
                <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem; line-height: 1.3;">
                    Perfect! You've chosen the most important goals for business growth
                </h2>
                
                <p style="color: #553c9a; font-size: 1rem; font-weight: 500; margin-bottom: 1.5rem; line-height: 1.4;">
                    These strategic choices will help us create the perfect online presence for your business!
                </p>

                <div style="background: rgba(139, 111, 205, 0.1); border: 2px solid rgba(139, 111, 205, 0.2); border-radius: 12px; padding: 1rem; margin: 1rem 0;">
                    <h3 style="color: #6b46c1; font-size: 1rem; font-weight: 600; margin-bottom: 1rem;">üéØ Your Selected Goals:</h3>
                    <div style="text-align: center;" id="modalGoalsList">
                        <!-- Goals will be populated here -->
                    </div>
                </div>

                <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0; color: #059669; font-weight: 600; font-size: 0.9rem; text-align: center;">
                    üöÄ Over 5,200 businesses launched this month with our free setup!
                </div>

                <button class="submit-button" onclick="proceedFromGoalsModal()" style="animation: pulse 2s infinite; margin-top: 1rem;">
                    Get My Free Setup! üöÄ
                </button>
            </div>
        </div>
    </div>

    <!-- Setup Intro Modal -->
    <div class="modal-overlay" id="setupIntroModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('setupIntroModal')">√ó</button>
            
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚ú®</div>
                
                <h2 style="color: #059669; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;">
                    Excellent! We have everything we need to get started
                </h2>
                
                <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.2); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;">
                    <p style="color: #059669; font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem;">
                        Just 3 more quick steps and we'll show you exactly how your business will look online!
                    </p>
                    <p style="color: #064e3b; font-size: 0.95rem; margin-bottom: 1rem;">
                        üíØ Completely free setup ‚Ä¢ ‚ö° No technical knowledge needed ‚Ä¢ üéØ Professional results guaranteed
                    </p>
                    
                    <div id="modalSetupGoalsList" style="display: flex; flex-direction: column; gap: 0.6rem;">
                        <!-- Goals will be populated here -->
                    </div>
                </div>

                <button class="submit-button" onclick="proceedFromSetupModal()" style="animation: pulse 2s infinite; font-size: 1.1rem;">
                    Let's Create Something Amazing! üéØ
                </button>
            </div>
        </div>
    </div>

    <!-- OTP Verification Modal -->
    <div class="modal-overlay" id="otpVerificationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('otpVerificationModal')">√ó</button>
            
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üì±</div>
                
                <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;">
                    Verify Your Phone Number
                </h2>
                
                <p style="color: #553c9a; font-size: 1rem; margin-bottom: 1.5rem;">
                    We've sent a 4-digit code to your phone. Enter it below to secure your account.
                </p>

                <div class="otp-input-group">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 0)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 1)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 2)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 3)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                </div>

                <p style="color: #6b7280; font-size: 0.8rem; margin-bottom: 1.5rem;">
                    Didn't receive the code? <a href="#" style="color: #6b46c1; text-decoration: none;" onclick="showNotification('Code resent!', 'info')">Resend OTP</a>
                </p>

                <button class="submit-button" id="verifyOtpBtn" onclick="verifyOtp()" disabled style="opacity: 0.5;">
                    Verify & Continue
                </button>
            </div>
        </div>
    </div>

</body>
</html>