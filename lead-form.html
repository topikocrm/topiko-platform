<<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topiko - Complete Business Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8f6ff 0%, #f0ebff 50%, #e8e0ff 100%);
            min-height: 100vh;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* üÜï RESPONSIVE PROGRESS BAR */
        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(139, 111, 205, 0.1);
            padding: 1rem;
            box-shadow: 0 2px 20px rgba(139, 111, 205, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .progress-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 0 0 auto;
            min-width: 70px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 12px;
        }

        .progress-step:hover {
            background: rgba(139, 111, 205, 0.05);
        }

        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 50px;
            width: 20px;
            height: 3px;
            background: #e5e7eb;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .progress-step.completed:not(:last-child)::after {
            background: linear-gradient(90deg, #8b6fcd, #6b46c1);
        }

        .progress-step.in-progress:not(:last-child)::after {
            background: linear-gradient(90deg, #8b6fcd 50%, #e5e7eb 50%);
        }

        .progress-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #e5e7eb;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.8rem;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .progress-step.completed .progress-circle {
            background: linear-gradient(135deg, #8b6fcd, #6b46c1);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.3);
        }

        .progress-step.in-progress .progress-circle {
            background: linear-gradient(135deg, #8b6fcd, #6b46c1);
            color: white;
            border-color: rgba(139, 111, 205, 0.3);
            animation: pulse 2s infinite;
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(139, 111, 205, 0.4);
        }

        .progress-label {
            margin-top: 0.5rem;
            font-size: 0.7rem;
            font-weight: 500;
            color: #6b7280;
            text-align: center;
            transition: all 0.3s ease;
            line-height: 1.2;
        }

        .progress-step.completed .progress-label {
            color: #6b46c1;
            font-weight: 600;
        }

        .progress-step.in-progress .progress-label {
            color: #6b46c1;
            font-weight: 700;
            font-size: 0.75rem;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1.15);
                box-shadow: 0 6px 20px rgba(139, 111, 205, 0.4);
            }
            50% { 
                transform: scale(1.2);
                box-shadow: 0 8px 25px rgba(139, 111, 205, 0.6);
            }
        }

        /* üÜï SIMPLIFIED LEAD SCORE WIDGET */
        .lead-score-widget {
            position: fixed;
            top: 100px;
            right: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(139, 111, 205, 0.2);
            border-radius: 50px;
            padding: 0.5rem 1rem;
            box-shadow: 0 8px 30px rgba(139, 111, 205, 0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .lead-score-widget:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(139, 111, 205, 0.3);
        }

        .score-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            color: white;
        }

        .score-circle.hot {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .score-circle.warm {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .score-circle.cold {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }

        .score-label {
            font-size: 0.8rem;
            color: #6b46c1;
            font-weight: 600;
        }

        /* DATABASE STATUS */
        .db-status {
            position: fixed;
            top: 1rem;
            left: 1rem;
            background: rgba(34, 197, 94, 0.9);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .db-status.testing {
            background: rgba(59, 130, 246, 0.9);
        }

        .db-status.error {
            background: rgba(239, 68, 68, 0.9);
        }

        /* ERROR DISPLAY */
        .error-display {
            position: fixed;
            top: 4rem;
            left: 1rem;
            right: 1rem;
            background: rgba(239, 68, 68, 0.95);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.8rem;
            z-index: 1001;
            display: none;
            max-width: 400px;
        }

        .error-display.show {
            display: block;
        }

        /* DEBUG PANEL */
        .debug-panel {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.7rem;
            max-width: 300px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
        }

        .debug-panel.show {
            display: block;
        }

        .debug-toggle {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1002;
            font-size: 0.7rem;
        }

        /* MAIN CONTENT - NO MORE SIDEBAR */
        .main-content {
            flex: 1;
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* CONTENT CARDS */
        .content-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(139, 111, 205, 0.1);
            border: 1px solid rgba(139, 111, 205, 0.1);
            margin-bottom: 2rem;
        }

        .content-card h2 {
            color: #6b46c1;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            letter-spacing: -1px;
            line-height: 1.2;
        }

        .content-card p {
            color: #553c9a;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        /* WELCOME SCREEN */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 60vh;
            background: linear-gradient(135deg, #faf9ff 0%, #f3f0ff 100%);
            border-radius: 20px;
            padding: 2rem;
        }

        .topiko-logo {
            font-size: 3rem;
            font-weight: 300;
            color: #6b46c1;
            letter-spacing: -2px;
            margin-bottom: 2rem;
        }

        /* BUTTONS */
        .try-free-button, .submit-button {
            background: linear-gradient(135deg, #8b6fcd 0%, #6b46c1 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 30px rgba(107, 70, 193, 0.3);
            width: 100%;
            max-width: 300px;
        }

        .try-free-button:hover, .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(107, 70, 193, 0.4);
        }

        .submit-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* FORM STYLING */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #6b46c1;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 1.5px solid rgba(139, 111, 205, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            color: #553c9a;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #8b6fcd;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 0 3px rgba(139, 111, 205, 0.1);
        }

        /* LANGUAGE SELECTION */
        .language-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .language-option {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .language-option:hover,
        .language-option.selected {
            background: rgba(139, 111, 205, 0.15);
            border-color: #8b6fcd;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 111, 205, 0.25);
        }

        .language-flag {
            font-size: 2rem;
            margin-right: 1rem;
            min-width: 40px;
            text-align: center;
        }

        .language-content h3 {
            color: #6b46c1;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .language-content p {
            color: #553c9a;
            font-size: 0.9rem;
            margin: 0;
        }

        /* GOALS SELECTION */
        .goals-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .goal-option {
            position: relative;
        }

        .goal-checkbox {
            display: none;
        }

        .goal-card {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.6);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .goal-card:hover {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(139, 111, 205, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(139, 111, 205, 0.15);
        }

        .goal-checkbox:checked + .goal-card {
            background: rgba(139, 111, 205, 0.1);
            border-color: #8b6fcd;
            box-shadow: 0 8px 30px rgba(139, 111, 205, 0.2);
        }

        .goal-icon {
            font-size: 2rem;
            margin-right: 1rem;
            min-width: 50px;
            text-align: center;
        }

        .goal-content h3 {
            color: #6b46c1;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .goal-content p {
            color: #553c9a;
            font-size: 0.85rem;
            margin: 0;
            line-height: 1.4;
        }

        .goal-checkmark {
            font-size: 1.5rem;
            color: #8b6fcd;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.3s ease;
            margin-left: auto;
        }

        .goal-checkbox:checked + .goal-card .goal-checkmark {
            opacity: 1;
            transform: scale(1);
        }

        /* QUALIFYING QUESTIONS */
        .qualifying-question {
            margin-bottom: 2rem;
        }

        .qualifying-question h3 {
            color: #6b46c1;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .radio-options {
            display: grid;
            gap: 0.8rem;
        }

        .radio-option {
            position: relative;
        }

        .radio-input {
            display: none;
        }

        .radio-card {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.6);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: #553c9a;
        }

        .radio-card:hover {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(139, 111, 205, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.1);
        }

        .radio-input:checked + .radio-card {
            background: rgba(139, 111, 205, 0.1);
            border-color: #8b6fcd;
            color: #6b46c1;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.2);
        }

        .radio-icon {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(139, 111, 205, 0.3);
            border-radius: 50%;
            margin-right: 0.8rem;
            position: relative;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .radio-input:checked + .radio-card .radio-icon {
            border-color: #8b6fcd;
            background: rgba(139, 111, 205, 0.1);
        }

        .radio-input:checked + .radio-card .radio-icon::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: #8b6fcd;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* CATEGORIES */
        .category-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .category-item {
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid rgba(139, 111, 205, 0.1);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        .category-item:hover {
            border-color: rgba(139, 111, 205, 0.3);
            box-shadow: 0 4px 15px rgba(139, 111, 205, 0.1);
        }

        .category-checkbox {
            display: none;
        }

        .category-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            color: #6b46c1;
            margin-bottom: 0.5rem;
        }

        .category-checkbox:checked + .category-label {
            color: #8b6fcd;
        }

        .category-icon {
            font-size: 1.3rem;
            margin-right: 0.6rem;
        }

        .category-checkmark {
            margin-left: auto;
            color: #8b6fcd;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .category-checkbox:checked + .category-label .category-checkmark {
            opacity: 1;
        }

        .subcategory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        .subcategory-item {
            background: rgba(139, 111, 205, 0.05);
            border: 1px solid rgba(139, 111, 205, 0.1);
            border-radius: 8px;
            padding: 0.4rem;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .subcategory-checkbox {
            display: none;
        }

        .subcategory-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            color: #553c9a;
            font-size: 0.8rem;
        }

        .subcategory-checkbox:checked + .subcategory-label {
            color: #8b6fcd;
            font-weight: 600;
        }

        .subcategory-item:hover {
            background: rgba(139, 111, 205, 0.1);
            border-color: rgba(139, 111, 205, 0.2);
        }

        .subcategory-checkmark {
            margin-left: auto;
            font-size: 0.7rem;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .subcategory-checkbox:checked + .subcategory-label .subcategory-checkmark {
            opacity: 1;
        }

        /* PRODUCTS */
        .product-form {
            background: rgba(255, 255, 255, 0.7);
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .product-image {
            height: 120px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .product-price {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255,255,255,0.9);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            color: #059669;
        }

        .product-content {
            padding: 1rem;
        }

        .product-name {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .product-description {
            color: #64748b;
            font-size: 0.8rem;
            margin-bottom: 0.8rem;
            line-height: 1.4;
        }

        /* THEMES */
        .theme-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .theme-option {
            border: 3px solid rgba(139, 111, 205, 0.2);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .theme-option:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(139, 111, 205, 0.2);
            border-color: #8b6fcd !important;
        }

        .theme-option.selected {
            border-color: #8b6fcd !important;
            box-shadow: 0 12px 40px rgba(139, 111, 205, 0.3);
            transform: translateY(-2px);
        }

        .theme-header {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .theme-header h3 {
            color: #1f2937;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            display: flex;
            align-items: center;
        }

        .theme-header p {
            color: #6b7280;
            font-size: 0.8rem;
            margin: 0;
        }

        .theme-preview {
            padding: 0.8rem;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .theme-preview-item {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 6px;
            padding: 0.4rem;
            font-size: 0.7rem;
            text-align: center;
            margin: 0.2rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* NOTIFICATIONS */
        .notification {
            position: fixed;
            top: 2rem;
            right: 1rem;
            left: 1rem;
            background: linear-gradient(135deg, #8b6fcd 0%, #6b46c1 100%);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(107, 70, 193, 0.3);
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: 1003;
            max-width: 400px;
            margin: 0 auto;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .notification.success {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        }

        .notification.info {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .notification.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        /* FOMO NOTIFICATIONS */
        .fomo-notification {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(34, 197, 94, 0.2);
            border-left: 4px solid #22c55e;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 8px 40px rgba(34, 197, 94, 0.15);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 1004;
            max-width: 400px;
            margin: 0 auto;
        }

        .fomo-notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .fomo-notification.hide {
            transform: translateY(100px);
            opacity: 0;
        }

        .fomo-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .fomo-icon {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            margin-right: 0.8rem;
            animation: pulse 2s infinite;
        }

        .fomo-status {
            color: #059669;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .fomo-content {
            color: #1f2937;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .business-name {
            font-weight: 600;
            color: #6b46c1;
        }

        .business-location {
            color: #6b7280;
            font-weight: 500;
        }

        .fomo-time {
            color: #9ca3af;
            font-size: 0.7rem;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .fomo-counter {
            position: fixed;
            top: 50%;
            left: 1rem;
            transform: translateY(-50%);
            background: rgba(34, 197, 94, 0.95);
            color: white;
            padding: 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.3);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1005;
            text-align: center;
            min-width: 100px;
        }

        .fomo-counter.show {
            opacity: 1;
        }

        .counter-number {
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
            margin-bottom: 0.2rem;
        }

        .counter-text {
            font-size: 0.7rem;
            opacity: 0.9;
        }

        /* SELECTION SUMMARY */
        .selection-summary {
            background: rgba(139, 111, 205, 0.1);
            border: 2px solid rgba(139, 111, 205, 0.2);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .summary-title {
            color: #6b46c1;
            font-weight: 600;
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
        }

        .summary-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.8rem;
            font-size: 0.8rem;
        }

        .summary-item {
            color: #553c9a;
        }

        .summary-count {
            font-weight: 600;
            color: #8b6fcd;
        }

        /* üì± RESPONSIVE BREAKPOINTS */
        @media (min-width: 480px) {
            .language-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .goals-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .theme-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .content-card {
                padding: 3rem;
            }
            
            .content-card h2 {
                font-size: 2.5rem;
            }
            
            .language-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .category-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .theme-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .main-content {
                padding: 2rem;
            }
            
            .progress-bar {
                justify-content: center;
            }
            
            .progress-step {
                min-width: 90px;
            }
            
            .progress-step:not(:last-child)::after {
                width: 30px;
                left: 60px;
            }
            
            .lead-score-widget {
                top: 120px;
                right: 2rem;
            }
            
            .fomo-notification {
                left: 2rem;
                right: auto;
                max-width: 350px;
            }
            
            .notification {
                right: 2rem;
                left: auto;
                max-width: 400px;
            }
        }

        @media (min-width: 1024px) {
            .progress-step {
                min-width: 110px;
            }
            
            .progress-step:not(:last-child)::after {
                width: 40px;
                left: 75px;
            }
        }

        /* MOBILE SPECIFIC FIXES */
        @media (max-width: 767px) {
            .progress-bar {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .progress-bar::-webkit-scrollbar {
                display: none;
            }
            
            .lead-score-widget {
                top: 80px;
                right: 0.5rem;
                padding: 0.4rem 0.8rem;
            }
            
            .score-circle {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .score-label {
                font-size: 0.7rem;
            }
            
            .fomo-counter {
                left: 0.5rem;
                top: auto;
                bottom: 6rem;
                transform: none;
                padding: 0.6rem;
                min-width: 80px;
            }
            
            .counter-number {
                font-size: 1.2rem;
            }
            
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
        }

        /* UTILITY CLASSES */
        .btn-secondary {
            background: rgba(139, 111, 205, 0.1);
            color: #6b46c1;
            border: 2px solid rgba(139, 111, 205, 0.2);
            padding: 1rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-secondary:hover {
            background: rgba(139, 111, 205, 0.15);
            border-color: rgba(139, 111, 205, 0.3);
            transform: translateY(-1px);
        }

        .flex-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .flex-buttons > * {
            flex: 1;
        }

        /* ANIMATIONS */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        @keyframes sparkleFloat {
            0% { transform: translateY(0) scale(0) rotate(0deg); opacity: 1; }
            50% { transform: translateY(-30px) scale(1) rotate(180deg); opacity: 1; }
            100% { transform: translateY(-60px) scale(0) rotate(360deg); opacity: 0; }
        }
        /* üÜï MODAL OVERLAY STYLES */
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(10px);
                z-index: 2000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 1rem;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
            }
            
            .modal-overlay.show {
                opacity: 1;
                visibility: visible;
            }
            
            .modal-content {
                background: linear-gradient(135deg, #faf9ff 0%, #f3f0ff 100%);
                border-radius: 20px;
                padding: 2rem;
                max-width: 500px;
                width: 100%;
                max-height: 80vh;
                overflow-y: auto;
                position: relative;
                transform: scale(0.9) translateY(20px);
                transition: all 0.3s ease;
                box-shadow: 0 20px 60px rgba(107, 70, 193, 0.3);
                border: 2px solid rgba(139, 111, 205, 0.2);
            }
            
            .modal-overlay.show .modal-content {
                transform: scale(1) translateY(0);
            }
            
            .modal-close {
                position: absolute;
                top: 1rem;
                right: 1rem;
                background: rgba(139, 111, 205, 0.1);
                border: none;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.2rem;
                color: #6b46c1;
                transition: all 0.3s ease;
            }
            
            .modal-close:hover {
                background: rgba(139, 111, 205, 0.2);
                transform: scale(1.1);
            }
            
            .goal-pill {
                background: linear-gradient(135deg, #8b6fcd, #6b46c1);
                color: white;
                padding: 0.5rem 1rem;
                border-radius: 15px;
                font-size: 0.85rem;
                font-weight: 500;
                margin: 0.3rem;
                display: inline-block;
                box-shadow: 0 4px 15px rgba(139, 111, 205, 0.3);
            }
            
            @media (max-width: 767px) {
                .modal-content {
                    padding: 1.5rem;
                    margin: 0.5rem;
                }
                
                .modal-close {
                    top: 0.5rem;
                    right: 0.5rem;
                    width: 35px;
                    height: 35px;
                }
            }
    </style>
</head>
<body>
    <!-- Database Status Indicator -->
    <div class="db-status testing" id="dbStatus">
        üîÑ Testing...
    </div>

    <!-- Error Display -->
    <div class="error-display" id="errorDisplay">
        <div id="errorContent"></div>
    </div>

    <!-- Debug Toggle -->
    <button class="debug-toggle" onclick="toggleDebugPanel()">üîç</button>
    
    <!-- Test Button -->
    <button onclick="testDatabaseSave()" style="position: fixed; top: 4rem; right: 1rem; background: rgba(34, 197, 94, 0.8); color: white; border: none; padding: 0.4rem 0.8rem; border-radius: 8px; cursor: pointer; z-index: 1002; font-size: 0.7rem;">
        üß™ Test
    </button>

    <!-- Debug Panel -->
    <div class="debug-panel" id="debugPanel">
        <h4>üîç Debug Log</h4>
        <div id="debugLog"></div>
    </div>

    <!-- üÜï SIMPLIFIED LEAD SCORE WIDGET -->
    <div class="lead-score-widget" id="leadWidget" onclick="toggleScoreDetails()">
        <div class="score-circle cold" id="leadScoreCircle">
            <span id="leadScoreValue">0</span>
        </div>
        <div class="score-label" id="scoreLabel">Score</div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div id="notificationContent"></div>
    </div>

    <!-- FOMO Notification System -->
    <div class="fomo-notification" id="fomoNotification">
        <div class="fomo-header">
            <div class="fomo-icon"></div>
            <div class="fomo-status">Just Registered</div>
        </div>
        <div class="fomo-content" id="fomoContent">
            <span class="business-name">Vasavi Silks</span> from <span class="business-location">Mysore</span> just set up their online store
        </div>
        <div class="fomo-time" id="fomoTime">2 minutes ago</div>
    </div>

    <!-- FOMO Counter -->
    <div class="fomo-counter" id="fomoCounter">
        <span class="counter-number" id="counterNumber">1,247</span>
        <span class="counter-text">joined<br>today</span>
    </div>

    <div class="app-container">
        <!-- üÜï CLICKABLE PROGRESS BAR (NO MORE SIDEBAR) -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">
                <div class="progress-step" data-step="welcome" onclick="navigateToStep('welcome')">
                    <div class="progress-circle">1</div>
                    <div class="progress-label">Home</div>
                </div>
                <div class="progress-step" data-step="language" onclick="navigateToStep('language')">
                    <div class="progress-circle">2</div>
                    <div class="progress-label">Language</div>
                </div>
                <div class="progress-step" data-step="goals" onclick="navigateToStep('goals')">
                    <div class="progress-circle">3</div>
                    <div class="progress-label">Goals</div>
                </div>
                <div class="progress-step" data-step="registration" onclick="navigateToStep('registration')">
                    <div class="progress-circle">4</div>
                    <div class="progress-label">Sign Up</div>
                </div>
                <div class="progress-step" data-step="qualifying-questions" onclick="navigateToStep('qualifying-questions')">
                    <div class="progress-circle">5</div>
                    <div class="progress-label">Questions</div>
                </div>
                <div class="progress-step" data-step="categories" onclick="navigateToStep('categories')">
                    <div class="progress-circle">6</div>
                    <div class="progress-label">Categories</div>
                </div>
                <div class="progress-step" data-step="products" onclick="navigateToStep('products')">
                    <div class="progress-circle">7</div>
                    <div class="progress-label">Products</div>
                </div>
                <div class="progress-step" data-step="themes" onclick="navigateToStep('themes')">
                    <div class="progress-circle">8</div>
                    <div class="progress-label">Themes</div>
                </div>
            </div>
        </div>

        <!-- Main Content Area (No Sidebar) -->
        <main class="main-content">
            <!-- Welcome Screen -->
            <section class="screen active" id="welcome">
                <div class="welcome-screen">
                    <h1 class="topiko-logo">Topiko</h1>
                    <p style="font-size: 1.1rem; color: #6b46c1; margin-bottom: 1rem;">Complete Business Platform for Indian SMBs</p>
                    <p style="font-size: 0.9rem; color: #059669; margin-bottom: 2rem; font-weight: bold;">‚úÖ Mobile-First Responsive Design</p>
                    <button class="try-free-button" onclick="startLeadFlow()">
                        Try for Free
                    </button>
                </div>
            </section>

            <!-- Language Selection Screen -->
            <section class="screen" id="language">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Choose Your Language</h2>
                    <p style="text-align: center; margin-bottom: 2rem; font-size: 0.9rem;">‡§Ö‡§™‡§®‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç | ‡∞Æ‡±Ä ‡∞≠‡∞æ‡∞∑‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø | ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç</p>
                    
                    <div class="language-grid">
                        <div class="language-option" onclick="selectLanguage('en', this)">
                            <div class="language-flag">üá¨üáß</div>
                            <div class="language-content">
                                <h3>English</h3>
                                <p>Continue in English</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguage('hi', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</h3>
                                <p>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguage('te', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</h3>
                                <p>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å‡∞≤‡±ã ‡∞ï‡±ä‡∞®‡∞∏‡∞æ‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguage('ta', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</h3>
                                <p>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Goals Selection Screen -->
            <section class="screen" id="goals">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Select Your Goals</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Choose what you want to achieve with Topiko (select all that apply)</p>
                    
                    <div class="goals-grid">
                        <div class="goal-option">
                            <input type="checkbox" id="goal-ecommerce" value="ecommerce" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-ecommerce" class="goal-card">
                                <div class="goal-icon">üõí</div>
                                <div class="goal-content">
                                    <h3>Sell Online (E-commerce)</h3>
                                    <p>Start selling your products online with a complete e-commerce solution</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-customers" value="customers" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-customers" class="goal-card">
                                <div class="goal-icon">üìà</div>
                                <div class="goal-content">
                                    <h3>Reach More Customers</h3>
                                    <p>Expand your customer base and grow your market reach</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-manage" value="manage" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-manage" class="goal-card">
                                <div class="goal-icon">üë•</div>
                                <div class="goal-content">
                                    <h3>Manage Customers</h3>
                                    <p>Keep track of your customers and build lasting relationships</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-search" value="search" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-search" class="goal-card">
                                <div class="goal-icon">üîç</div>
                                <div class="goal-content">
                                    <h3>Appear in Search Results</h3>
                                    <p>Improve your online visibility and get found by potential customers</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-brand" value="brand" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-brand" class="goal-card">
                                <div class="goal-icon">‚≠ê</div>
                                <div class="goal-content">
                                    <h3>Establish my Brand</h3>
                                    <p>Build a strong brand presence and professional image online</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>
                    </div>

                    <button class="submit-button" onclick="submitGoals()">
                        Next Step
                    </button>
                </div>
            </section>

            <!-- Registration Screen -->
            <section class="screen" id="registration">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Get Started with Topiko</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Tell us about your business to create your free account</p>
                    
                    <div class="form-group">
                        <label for="fullName">Your Name</label>
                        <input type="text" id="fullName" placeholder="Enter your full name" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" placeholder="Enter your email address" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="phoneNumber">Phone Number</label>
                        <input type="tel" id="phoneNumber" placeholder="Enter your phone number" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="businessName">Business Name</label>
                        <input type="text" id="businessName" placeholder="Enter your business name" oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea id="address" rows="3" placeholder="Enter your business address" oninput="trackFormProgress()"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="businessType">Business Type</label>
                        <select id="businessType" onchange="trackFormProgress()">
                            <option value="">Select your business type</option>
                            <option value="startup">Startup</option>
                            <option value="small-business">Small Business</option>
                            <option value="medium-enterprise">Medium Enterprise</option>
                            <option value="large-enterprise">Large Enterprise</option>
                            <option value="freelancer">Freelancer</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="category">Business Category</label>
                        <select id="category" onchange="trackFormProgress()">
                            <option value="">Select your business category</option>
                            <option value="boutique">üè™ Boutique</option>
                            <option value="home-foods">üçõ Home Foods</option>
                            <option value="salons">üíÑ Salons & Beauty</option>
                            <option value="grocery">üõí Grocery & Provisions</option>
                            <option value="furniture">üõãÔ∏è Furniture & Home Decor</option>
                            <option value="fashion">üëó Fashion & Apparel</option>
                            <option value="jewellery">üíç Jewellery & Accessories</option>
                            <option value="electronics">üì± Electronics & Gadgets</option>
                        </select>
                    </div>

                    <button class="submit-button" onclick="submitRegistration()">
                        Create Free Account
                    </button>
                </div>
            </section>

            <!-- Qualifying Questions Screen -->
            <section class="screen" id="qualifying-questions">
                <div class="content-card">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;">
                            Let's setup things for you
                        </h2>
                        <p style="color: #553c9a; font-size: 1rem; font-weight: 500;">
                            Just need a couple of details about your business
                        </p>
                    </div>

                    <!-- Question 1: Online Presence -->
                    <div class="qualifying-question">
                        <h3>Do you currently have any online presence?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="presence-none" name="online_presence" value="none" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-none" class="radio-card">
                                    <div class="radio-icon"></div>
                                    No online presence at all
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-whatsapp" name="online_presence" value="whatsapp" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-whatsapp" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Only WhatsApp Business
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-social" name="online_presence" value="social" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-social" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Social media pages (Facebook/Instagram)
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-basic" name="online_presence" value="basic_website" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-basic" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Basic website
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-full" name="online_presence" value="full_website" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-full" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Full website with online ordering
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2: Budget -->
                    <div class="qualifying-question">
                        <h3>To meet your business goals, how much budget can you allocate per year?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="budget-low" name="budget" value="5000-10000" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-low" class="radio-card">
                                    <div class="radio-icon"></div>
                                    ‚Çπ5,000 to ‚Çπ10,000
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="budget-medium" name="budget" value="10000-25000" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-medium" class="radio-card">
                                    <div class="radio-icon"></div>
                                    ‚Çπ10,000 to ‚Çπ25,000
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="budget-high" name="budget" value="25000+" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-high" class="radio-card">
                                    <div class="radio-icon"></div>
                                    More than ‚Çπ25,000
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3: Decision Maker -->
                    <div class="qualifying-question">
                        <h3>Are you the decision maker for your business?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="decision-yes" name="decision_maker" value="yes" class="radio-input" onchange="updateQualifyingData()">
                                <label for="decision-yes" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Yes
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="decision-no" name="decision_maker" value="no" class="radio-input" onchange="updateQualifyingData()">
                                <label for="decision-no" class="radio-card">
                                    <div class="radio-icon"></div>
                                    No
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4: Timeline -->
                    <div class="qualifying-question">
                        <h3>How soon do you want to get started?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="timeline-immediate" name="timeline" value="immediately" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-immediate" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Immediately
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-week" name="timeline" value="within_week" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-week" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Within a week
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-month" name="timeline" value="this_month" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-month" class="radio-card">
                                    <div class="radio-icon"></div>
                                    This month
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-checking" name="timeline" value="just_checking" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-checking" class="radio-card">
                                    <div class="radio-icon"></div>
                                    Just checking
                                </label>
                            </div>
                        </div>
                    </div>

                    <button class="submit-button" onclick="proceedToCategories()" id="qualifyingNextBtn" disabled style="opacity: 0.5;">
                        Create my Business üöÄ
                    </button>
                </div>
            </section>

            <!-- Categories Screen -->
            <section class="screen" id="categories">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Select Your Business Categories</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Choose specific categories and subcategories that best describe your business</p>
                    
                    <!-- Selection Summary -->
                    <div class="selection-summary" id="selectionSummary" style="display: none;">
                        <div class="summary-title">üìä Your Selection Summary</div>
                        <div class="summary-content">
                            <div class="summary-item">
                                <span>Categories: </span>
                                <span class="summary-count" id="categoriesCount">0</span>
                            </div>
                            <div class="summary-item">
                                <span>Subcategories: </span>
                                <span class="summary-count" id="subcategoriesCount">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="categoriesContainer">
                        <!-- Categories will be populated dynamically -->
                    </div>

                    <button class="submit-button" onclick="proceedToProducts()" id="categoryNextBtn" disabled>
                        Continue to Add Products
                    </button>
                </div>
            </section>

            <!-- Products Screen -->
            <section class="screen" id="products">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Add Your Products</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Build your catalog with products that represent your business</p>
                    
                    <!-- Product Form -->
                    <div class="product-form">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;">Add New Product/Service</h3>
                        
                        <div class="form-group">
                            <label for="productName">Product/Service Name</label>
                            <input type="text" id="productName" placeholder="e.g., Cotton Kurta, Masala Dosa, Haircut">
                        </div>
                        
                        <div class="form-group">
                            <label for="productPrice">Price (‚Çπ)</label>
                            <input type="number" id="productPrice" placeholder="e.g., 899">
                        </div>

                        <div class="form-group">
                            <label for="productCategory">Category</label>
                            <select id="productCategory">
                                <option value="">Select from your chosen categories</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="productSubcategory">Subcategory (Optional)</label>
                            <select id="productSubcategory">
                                <option value="">Select a subcategory</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productDescription">Description</label>
                            <textarea id="productDescription" rows="3" placeholder="Brief description of your product or service"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="productImage">Product Image URL (optional)</label>
                            <input type="url" id="productImage" placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <button type="button" onclick="addProduct()" class="btn-secondary" style="width: auto; margin-top: 1rem;">
                            ‚ûï Add Product
                        </button>
                    </div>

                    <!-- Products List -->
                    <div class="products-list">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;">Your Product Catalog (<span id="productCount">0</span>)</h3>
                        
                        <div class="product-grid" id="productsList">
                            <div style="text-align: center; padding: 2rem; color: #64748b; background: rgba(255, 255, 255, 0.5); border-radius: 12px;">
                                <div style="font-size: 3rem; margin-bottom: 1rem;">üì¶</div>
                                <p>No products added yet. Add your first product above!</p>
                            </div>
                        </div>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="navigateToStep('categories')" class="btn-secondary">
                            ‚Üê Back to Categories
                        </button>
                        <button onclick="proceedToThemes()" class="submit-button">
                            Choose Theme üé®
                        </button>
                    </div>
                </div>
            </section>

            <!-- Theme Selection Screen -->
            <section class="screen" id="themes">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;">Choose Your Business Theme</h2>
                    <p style="text-align: center; margin-bottom: 2rem;">Select a theme that represents your business style. See how your products will look!</p>
                    
                    <div class="theme-grid">
                        <!-- Modern & Minimalist Theme -->
                        <div class="theme-option" onclick="selectTheme('modern', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">‚ú®</span>
                                    Modern & Minimalist
                                </h3>
                                <p>Clean, simple design that focuses on your products</p>
                            </div>
                            <div class="theme-preview" id="modern-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Colorful & Vibrant Theme -->
                        <div class="theme-option" onclick="selectTheme('vibrant', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üåà</span>
                                    Colorful & Vibrant
                                </h3>
                                <p>Bold colors and energetic design to attract customers</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #fecaca 100%);" id="vibrant-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Professional & Corporate Theme -->
                        <div class="theme-option" onclick="selectTheme('professional', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üíº</span>
                                    Professional & Corporate
                                </h3>
                                <p>Sophisticated design that builds trust and credibility</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white;" id="professional-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Traditional & Classic Theme -->
                        <div class="theme-option" onclick="selectTheme('traditional', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üèõÔ∏è</span>
                                    Traditional & Classic
                                </h3>
                                <p>Timeless design with warm, welcoming feel</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #fef7cd 0%, #fde68a 100%);" id="traditional-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Creative & Artistic Theme -->
                        <div class="theme-option" onclick="selectTheme('creative', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üé®</span>
                                    Creative & Artistic
                                </h3>
                                <p>Unique, artistic design that showcases creativity</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #ddd6fe 0%, #c7d2fe 50%, #bfdbfe 100%);" id="creative-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>

                        <!-- Elegant & Luxury Theme -->
                        <div class="theme-option" onclick="selectTheme('luxury', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üíé</span>
                                    Elegant & Luxury
                                </h3>
                                <p>Premium design for high-end products and services</p>
                            </div>
                            <div class="theme-preview" style="background: linear-gradient(135deg, #1c1917 0%, #292524 100%); color: #d6d3d1;" id="luxury-preview">
                                <!-- Products preview will be populated here -->
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 1.5rem 0;">
                        <p style="color: #6b7280; font-size: 0.8rem; margin-bottom: 1rem;">
                            <span id="selectedThemeName">No theme selected</span> | You can change this anytime later
                        </p>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="navigateToStep('products')" class="btn-secondary">
                            ‚Üê Back to Products
                        </button>
                        <button onclick="completeSetup()" id="themeNextBtn" disabled style="opacity: 0.5;">
                            Complete Setup üöÄ
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // üéØ TOPIKO RESPONSIVE LEAD FORM WITH CLICKABLE PROGRESS BAR
        
        // ‚úÖ CORE VARIABLES
        let sessionStartTime = Date.now();
        let selectedGoals = [];
        let selectedLanguage = 'en';
        let selectedCategories = [];
        let selectedSubcategories = [];
        let userProducts = [];
        let currentUserId = null;
        let selectedTheme = null;
        let pageViews = 1;
        let leadScore = 0;
        let formProgress = 0;
        let utmParams = {};
        let deviceInfo = {};
        let databaseConnected = false;
        let debugLogs = [];

        // üÜï NEW: Current Step Tracking
        let currentStep = 'welcome';

        // üÜï NEW: Step Configuration
        const stepOrder = [
            'welcome',
            'language', 
            'goals',
            'registration',
            'qualifying-questions',
            'categories',
            'products',
            'themes'
        ];

        // üÜï NEW: Qualifying Questions Data
        let qualifyingAnswers = {
            online_presence: '',
            budget: '',
            decision_maker: '',
            timeline: ''
        };

        // üöÄ FOMO NOTIFICATION SYSTEM
        let fomoActive = true;
        let fomoTimer = null;
        let businessCounter = 1247;
        let lastFomoShow = 0;

        // üáÆüá≥ BUSINESS DATA
        const indianBusinessNames = [
            'Vasavi Silks', 'Lakshmi Textiles', 'Sree Krishna Stores', 'Ganesh Traders', 'Shiva Electronics',
            'Rama Jewellers', 'Vishnu Enterprises', 'Durga Fashions', 'StyleHub Fashion', 'TechPoint Solutions',
            'FreshMart Grocery', 'GlowUp Beauty', 'TasteBuds Cafe', 'UrbanStyle Boutique', 'SmartTech Electronics',
            'Royal Beauty Salon', 'Spice Garden Restaurant', 'Golden Touch Jewellery', 'Modern Home Furniture'
        ];

        const indianCities = [
            'Mumbai', 'Delhi', 'Bangalore', 'Chennai', 'Kolkata', 'Hyderabad', 'Pune', 'Ahmedabad',
            'Mysore', 'Coimbatore', 'Kochi', 'Jaipur', 'Lucknow', 'Kanpur', 'Nagpur', 'Indore',
            'Surat', 'Vadodara', 'Visakhapatnam', 'Bhopal', 'Patna', 'Ludhiana', 'Agra', 'Nashik'
        ];

        const fomoMessageTemplates = [
            { text: '{business} from {city} just set up their online store', status: 'Just Registered' },
            { text: '{business} in {city} started selling online', status: 'Now Live' },
            { text: '{business} from {city} launched their digital presence', status: 'Just Launched' },
            { text: '{business} in {city} joined our platform', status: 'New Member' },
            { text: '{business} from {city} completed their business setup', status: 'Setup Complete' }
        ];

        // üöÄ SUPABASE CONFIGURATION
        const SUPABASE_URL = 'https://xssbtsfjtwjholygdbqo.supabase.co'
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhzc2J0c2ZqdHdqaG9seWdkYnFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMxOTk5MjUsImV4cCI6MjA2ODc3NTkyNX0.eOSIHTpvllcH-fK6MARoe5HPiXlujsrzUWfAhmUh94k'

        // üáÆüá≥ BUSINESS CATEGORIES
        const businessCategories = {
            boutique: {
                id: 'boutique',
                name: 'Boutique & Fashion',
                icon: 'üè™',
                categories: {
                    'mens-wear': {
                        name: "Men's Wear",
                        icon: 'üëî',
                        subcategories: ['shirts', 'pants', 'suits', 'ethnic-wear', 'casual-wear', 'formal-wear']
                    },
                    'womens-wear': {
                        name: "Women's Wear",
                        icon: 'üëó',
                        subcategories: ['dresses', 'tops', 'bottoms', 'sarees', 'lehengas', 'salwar-suits', 'western-wear']
                    },
                    'accessories': {
                        name: 'Fashion Accessories',
                        icon: 'üëú',
                        subcategories: ['bags', 'belts', 'wallets', 'scarves', 'hats', 'sunglasses']
                    },
                    'footwear': {
                        name: 'Footwear',
                        icon: 'üë†',
                        subcategories: ['mens-shoes', 'womens-shoes', 'sandals', 'boots', 'sneakers']
                    }
                }
            },
            'home-foods': {
                id: 'home-foods',
                name: 'Home Foods & Catering',
                icon: 'üçõ',
                categories: {
                    'north-indian': {
                        name: 'North Indian Cuisine',
                        icon: 'üçõ',
                        subcategories: ['rotis-parathas', 'curries', 'dal-preparations', 'rice-dishes', 'snacks']
                    },
                    'south-indian': {
                        name: 'South Indian Cuisine',
                        icon: 'ü••',
                        subcategories: ['dosas', 'idlis', 'vadas', 'uttapam', 'sambar', 'rasam']
                    },
                    'sweets-desserts': {
                        name: 'Sweets & Desserts',
                        icon: 'üßÅ',
                        subcategories: ['traditional-sweets', 'cakes', 'pastries', 'ice-creams']
                    }
                }
            }
            // Add more categories as needed...
        };

        // üìä SUBCATEGORY NAMES
        const subcategoryNames = {
            'shirts': 'Shirts', 'pants': 'Pants', 'suits': 'Suits', 'ethnic-wear': 'Ethnic Wear',
            'dresses': 'Dresses', 'tops': 'Tops', 'bottoms': 'Bottoms', 'sarees': 'Sarees',
            'bags': 'Bags', 'belts': 'Belts', 'wallets': 'Wallets', 'scarves': 'Scarves',
            'mens-shoes': "Men's Shoes", 'womens-shoes': "Women's Shoes", 'sandals': 'Sandals',
            'rotis-parathas': 'Rotis & Parathas', 'curries': 'Curries', 'dal-preparations': 'Dal',
            'dosas': 'Dosas', 'idlis': 'Idlis', 'vadas': 'Vadas', 'traditional-sweets': 'Traditional Sweets'
        };

        // üÜï NEW: RESPONSIVE NAVIGATION FUNCTIONS
        function navigateToStep(stepId) {
            // Only allow navigation to completed or current steps
            const targetIndex = stepOrder.indexOf(stepId);
            const currentIndex = stepOrder.indexOf(currentStep);
            
            if (targetIndex <= currentIndex || targetIndex === 0) {
                showScreen(stepId);
                addDebugLog(`üì± Navigated to: ${stepId} via progress bar`);
            } else {
                showNotification('Complete current step first', 'warning');
                addDebugLog(`‚ùå Navigation blocked: ${stepId} (step not available yet)`);
            }
        }

        function updateProgressBar(activeStep) {
            const progressSteps = document.querySelectorAll('.progress-step');
            const activeIndex = stepOrder.indexOf(activeStep);
            
            progressSteps.forEach((step, index) => {
                const stepData = step.getAttribute('data-step');
                const stepIndex = stepOrder.indexOf(stepData);
                
                // Remove all classes
                step.classList.remove('completed', 'in-progress');
                
                if (stepIndex < activeIndex) {
                    step.classList.add('completed');
                } else if (stepIndex === activeIndex) {
                    step.classList.add('in-progress');
                }
            });
            
            addDebugLog(`üìä Progress bar updated: ${activeStep} (${activeIndex + 1}/${stepOrder.length})`);
        }

        // üîç ENHANCED DEBUG LOGGING
        function addDebugLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            debugLogs.push({ timestamp, message, type });
            
            console.log(`üîç DEBUG: ${message}`);
            
            const debugLogEl = document.getElementById('debugLog');
            if (debugLogEl) {
                debugLogEl.innerHTML = debugLogs.slice(-15).map(log => 
                    `<div style="color: ${log.type === 'error' ? '#ff6b6b' : log.type === 'success' ? '#51cf66' : '#74c0fc'}; margin-bottom: 3px; font-size: 0.7rem;">
                        [${log.timestamp.split(':').slice(-2).join(':')}] ${log.message}
                    </div>`
                ).join('');
                debugLogEl.scrollTop = debugLogEl.scrollHeight;
            }
        }

        function toggleDebugPanel() {
            const panel = document.getElementById('debugPanel');
            panel.classList.toggle('show');
        }

        // üîå DATABASE FUNCTIONS
        function updateDatabaseStatus(status, message) {
            const statusEl = document.getElementById('dbStatus');
            statusEl.className = `db-status ${status}`;
            statusEl.textContent = message;
            databaseConnected = (status === '' || status === 'connected');
            addDebugLog(`DB: ${message}`, status === 'error' ? 'error' : 'info');
        }

        async function testDatabaseConnection() {
            try {
                updateDatabaseStatus('testing', 'üîÑ Testing...');
                const response = await fetch(`${SUPABASE_URL}/rest/v1/users?limit=1`, {
                    method: 'GET',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok || response.status === 400 || response.status === 401) {
                    updateDatabaseStatus('', '‚úÖ Ready');
                    return true;
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                updateDatabaseStatus('', '‚úÖ Ready');
                return true;
            }
        }

        async function saveToSupabase(data, table) {
            try {
                addDebugLog(`üíæ Saving to ${table}`);
                
                const response = await fetch(`${SUPABASE_URL}/rest/v1/${table}`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=representation'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const result = await response.json();
                    addDebugLog(`‚úÖ Saved to ${table}`, 'success');
                    updateDatabaseStatus('', '‚úÖ Saved');
                    return { success: true, data: result };
                } else {
                    const errorText = await response.text();
                    addDebugLog(`‚ùå Save failed: ${response.status}`, 'error');
                    return { success: false, error: `${response.status}: ${errorText}` };
                }
            } catch (error) {
                addDebugLog(`‚ùå Save error: ${error.message}`, 'error');
                return { success: false, error: error.message };
            }
        }

        async function testDatabaseSave() {
            addDebugLog('üß™ Testing save...', 'info');
            showNotification('üß™ Testing...', 'info');
            
            const testData = {
                name: 'Test User Mobile',
                email: `test-mobile-${Date.now()}@example.com`,
                phone: '9876543210',
                business_name: 'Test Business Mobile',
                business_type: 'startup',
                business_category: 'boutique',
                selected_language: 'en',
                selected_goals: ['ecommerce']
            };
            
            const result = await saveToSupabase(testData, 'users');
            
            if (result.success) {
                showNotification('‚úÖ Save test successful!', 'success');
                addDebugLog('‚úÖ Test passed', 'success');
            } else {
                showNotification(`‚ùå Save failed: ${result.error}`, 'error');
                addDebugLog(`‚ùå Test failed: ${result.error}`, 'error');
            }
        }

        // üìä LEAD SCORING
        function calculateLeadScore() {
            let score = 0;
            
            if (selectedLanguage) score += 5;
            score += Math.min(selectedGoals.length * 10, 50);
            score += Math.floor(formProgress * 0.25);
            
            const sessionMinutes = (Date.now() - sessionStartTime) / 60000;
            if (sessionMinutes > 1) score += 5;
            if (sessionMinutes > 3) score += 5;
            
            score += Math.min(pageViews * 2, 10);
            score += Math.min(selectedCategories.length * 5, 25);
            score += Math.min(userProducts.length * 3, 15);
            if (selectedTheme) score += 5;
            
            // Qualifying questions scoring
            let qualifyingScore = 0;
            
            switch (qualifyingAnswers.online_presence) {
                case 'none': qualifyingScore += 8; break;
                case 'whatsapp': qualifyingScore += 6; break;
                case 'social': qualifyingScore += 4; break;
                case 'basic_website': qualifyingScore += 3; break;
                case 'full_website': qualifyingScore += 2; break;
            }
            
            switch (qualifyingAnswers.budget) {
                case '25000+': qualifyingScore += 8; break;
                case '10000-25000': qualifyingScore += 6; break;
                case '5000-10000': qualifyingScore += 4; break;
            }
            
            if (qualifyingAnswers.decision_maker === 'yes') qualifyingScore += 5;
            
            switch (qualifyingAnswers.timeline) {
                case 'immediately': qualifyingScore += 4; break;
                case 'within_week': qualifyingScore += 3; break;
                case 'this_month': qualifyingScore += 2; break;
                case 'just_checking': qualifyingScore += 1; break;
            }
            
            score += Math.min(qualifyingScore, 25);
            leadScore = Math.min(score, 100);
            
            updateLeadScoreWidget();
            addDebugLog(`üìä Lead Score: ${leadScore}/100`);
            return leadScore;
        }

        // üéØ SIMPLIFIED LEAD SCORE WIDGET
        function updateLeadScoreWidget() {
            const scoreValue = document.getElementById('leadScoreValue');
            const scoreCircle = document.getElementById('leadScoreCircle');
            const scoreLabel = document.getElementById('scoreLabel');
            
            if (scoreValue) scoreValue.textContent = leadScore;
            
            let quality, circleClass;
            if (leadScore >= 70) {
                quality = 'Hot';
                circleClass = 'hot';
            } else if (leadScore >= 40) {
                quality = 'Warm';
                circleClass = 'warm';
            } else {
                quality = 'Cold';
                circleClass = 'cold';
            }
            
            if (scoreLabel) scoreLabel.textContent = quality;
            if (scoreCircle) {
                scoreCircle.className = `score-circle ${circleClass}`;
            }
        }

        function toggleScoreDetails() {
            const sessionMinutes = Math.round((Date.now() - sessionStartTime) / 60000);
            showNotification(`Score: ${leadScore}/100 | Quality: ${leadScore >= 70 ? 'Hot' : leadScore >= 40 ? 'Warm' : 'Cold'} | Session: ${sessionMinutes}m | Views: ${pageViews}`, 'info');
        }

        // üîÑ SCREEN NAVIGATION
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                pageViews++;
                currentStep = screenId;
                
                updateProgressBar(currentStep);
                
                if (screenId === 'categories') {
                    loadCategories();
                }
                
                if (screenId === 'themes') {
                    populateThemePreviews();
                }
                
                addDebugLog(`üì± Screen: ${screenId} (views: ${pageViews})`);
                calculateLeadScore();
            }
        }

        // üöÄ LEAD FLOW FUNCTIONS
        function startLeadFlow() {
            addDebugLog('üöÄ Lead flow started');
            showScreen('language');
        }

        function selectLanguage(lang, element) {
            selectedLanguage = lang;
            
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            const languageNames = { 'en': 'English', 'hi': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', 'te': '‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å', 'ta': '‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç' };
            showNotification(`Language: ${languageNames[lang]}`, 'success');
            calculateLeadScore();
            
            setTimeout(() => showScreen('goals'), 1500);
        }

        function updateGoalsTracking() {
            const checkedGoals = document.querySelectorAll('.goal-checkbox:checked');
            selectedGoals = Array.from(checkedGoals).map(checkbox => checkbox.value);
            addDebugLog(`Goals: ${selectedGoals.length} selected`);
            calculateLeadScore();
        }

        // üîÑ UPDATE: submitGoals function
        function submitGoals() {
            if (selectedGoals.length === 0) {
                showNotification('Please select at least one goal', 'error');
                return;
            }
            
            showNotification(`${selectedGoals.length} goal${selectedGoals.length > 1 ? 's' : ''} selected!`, 'success');
            calculateLeadScore();
            
            // Show goals transition modal instead of going directly to registration
            setTimeout(() => {
                displayGoalsTransitionModal();
            }, 1500);
        }

        function trackFormProgress() {
            const formFields = ['fullName', 'email', 'phoneNumber', 'businessName', 'address', 'businessType', 'category'];
            let completedFields = 0;
            
            formFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && field.value.trim() !== '') {
                    completedFields++;
                }
            });
            
            formProgress = (completedFields / formFields.length) * 100;
            addDebugLog(`Form progress: ${Math.round(formProgress)}%`);
            calculateLeadScore();
        }

        async function submitRegistration() {
            addDebugLog('üìù Registration submission');
            
            const name = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phoneNumber').value.trim();
            const business = document.getElementById('businessName').value.trim();
            const address = document.getElementById('address').value.trim();
            const type = document.getElementById('businessType').value;
            const category = document.getElementById('category').value;

            if (!name || !email || !phone || !business || !type || !category) {
                showNotification('Please fill all required fields', 'error');
                return;
            }

            showNotification('Creating account...', 'info');
            
            const userData = {
                name, email, phone,
                business_name: business,
                business_type: type,
                business_category: category,
                selected_language: selectedLanguage,
                selected_goals: selectedGoals
            };
            
            if (address) userData.address = address;

            const userResult = await saveToSupabase(userData, 'users');
            
            if (userResult.success && userResult.data && userResult.data.length > 0) {
                currentUserId = userResult.data[0].id;
                addDebugLog(`‚úÖ User created: ${currentUserId}`, 'success');
                
                const leadData = {
                    user_id: currentUserId,
                    lead_score: leadScore,
                    lead_quality: leadScore >= 70 ? 'Hot' : leadScore >= 40 ? 'Warm' : 'Cold',
                    session_duration_minutes: Math.round((Date.now() - sessionStartTime) / 60000),
                    page_views: pageViews,
                    selected_goals: selectedGoals,
                    lead_status: 'New'
                };
                
                await saveToSupabase(leadData, 'lead_intelligence');
                
                showNotification('‚úÖ Registration completed!', 'success');
                // Replace this line:
                // setTimeout(() => showScreen('qualifying-questions'), 2000);
                // With this:
                setTimeout(() => {
                    displaySetupIntroModal();
                }, 2000);
            } else {
                showNotification('‚ùå Registration failed. Please try again.', 'error');
            }
        }

        function updateQualifyingData() {
            qualifyingAnswers.online_presence = document.querySelector('input[name="online_presence"]:checked')?.value || '';
            qualifyingAnswers.budget = document.querySelector('input[name="budget"]:checked')?.value || '';
            qualifyingAnswers.decision_maker = document.querySelector('input[name="decision_maker"]:checked')?.value || '';  
            qualifyingAnswers.timeline = document.querySelector('input[name="timeline"]:checked')?.value || '';
            
            calculateLeadScore();
            
            const allAnswered = Object.values(qualifyingAnswers).every(answer => answer !== '');
            const nextBtn = document.getElementById('qualifyingNextBtn');
            
            if (allAnswered) {
                nextBtn.disabled = false;
                nextBtn.style.opacity = '1';
            } else {
                nextBtn.disabled = true;
                nextBtn.style.opacity = '0.5';
            }
        }

        async function proceedToCategories() {
            if (Object.values(qualifyingAnswers).some(answer => answer === '')) {
                showNotification('Please answer all questions', 'error');
                return;
            }
            
            addDebugLog(`Qualifying complete: ${JSON.stringify(qualifyingAnswers)}`);
            showNotification('Moving to categories...', 'success');
            setTimeout(() => showScreen('categories'), 1000);
        }

        function loadCategories() {
            const businessCategory = document.getElementById('category').value;
            const categoriesContainer = document.getElementById('categoriesContainer');
            
            if (!businessCategory || !businessCategories[businessCategory]) {
                categoriesContainer.innerHTML = '<p style="text-align: center; color: #64748b;">Please complete registration first.</p>';
                return;
            }
            
            const categoryData = businessCategories[businessCategory];
            
            let categoriesHTML = `
                <div class="category-section">
                    <h3><span style="margin-right: 0.5rem;">${categoryData.icon}</span>${categoryData.name} Categories</h3>
                    <p style="color: #553c9a; margin-bottom: 1.5rem; font-size: 0.9rem;">Select categories that apply to your business:</p>
                    
                    <div class="category-grid">
            `;
            
            Object.keys(categoryData.categories).forEach(categoryKey => {
                const category = categoryData.categories[categoryKey];
                const isSelected = selectedCategories.includes(categoryKey);
                
                categoriesHTML += `
                    <div class="category-item">
                        <input type="checkbox" id="cat-${categoryKey}" value="${categoryKey}" class="category-checkbox" 
                               ${isSelected ? 'checked' : ''} onchange="toggleCategorySelection('${categoryKey}')">
                        <label for="cat-${categoryKey}" class="category-label">
                            <span class="category-icon">${category.icon}</span>
                            ${category.name}
                            <span class="category-checkmark">‚úì</span>
                        </label>
                        
                        <div class="subcategory-grid">
                `;
                
                category.subcategories.forEach(subcategoryKey => {
                    const subcategoryName = subcategoryNames[subcategoryKey] || subcategoryKey.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
                    const isSubSelected = selectedSubcategories.includes(subcategoryKey);
                    
                    categoriesHTML += `
                        <div class="subcategory-item">
                            <input type="checkbox" id="sub-${subcategoryKey}" value="${subcategoryKey}" class="subcategory-checkbox"
                                   ${isSubSelected ? 'checked' : ''} onchange="toggleSubcategorySelection('${subcategoryKey}')">
                            <label for="sub-${subcategoryKey}" class="subcategory-label">
                                ${subcategoryName}
                                <span class="subcategory-checkmark">‚úì</span>
                            </label>
                        </div>
                    `;
                });
                
                categoriesHTML += `
                        </div>
                    </div>
                `;
            });
            
            categoriesHTML += `
                    </div>
                </div>
            `;
            
            categoriesContainer.innerHTML = categoriesHTML;
            updateProductCategoriesDropdown();
            updateSelectionSummary();
        }

        function toggleCategorySelection(categoryKey) {
            if (selectedCategories.includes(categoryKey)) {
                selectedCategories = selectedCategories.filter(cat => cat !== categoryKey);
            } else {
                selectedCategories.push(categoryKey);
            }
            
            updateSelectionSummary();
            updateProductCategoriesDropdown();
            calculateLeadScore();
            updateNextButton();
        }

        function toggleSubcategorySelection(subcategoryKey) {
            if (selectedSubcategories.includes(subcategoryKey)) {
                selectedSubcategories = selectedSubcategories.filter(sub => sub !== subcategoryKey);
            } else {
                selectedSubcategories.push(subcategoryKey);
            }
            
            updateSelectionSummary();
            calculateLeadScore();
        }

        function updateSelectionSummary() {
            const summaryEl = document.getElementById('selectionSummary');
            const categoriesCountEl = document.getElementById('categoriesCount');
            const subcategoriesCountEl = document.getElementById('subcategoriesCount');
            
            if (selectedCategories.length > 0 || selectedSubcategories.length > 0) {
                summaryEl.style.display = 'block';
                categoriesCountEl.textContent = selectedCategories.length;
                subcategoriesCountEl.textContent = selectedSubcategories.length;
            } else {
                summaryEl.style.display = 'none';
            }
        }

        function updateNextButton() {
            const nextBtn = document.getElementById('categoryNextBtn');
            if (selectedCategories.length > 0) {
                nextBtn.disabled = false;
                nextBtn.style.opacity = '1';
            } else {
                nextBtn.disabled = true;
                nextBtn.style.opacity = '0.5';
            }
        }

        function updateProductCategoriesDropdown() {
            const productCategorySelect = document.getElementById('productCategory');
            const productSubcategorySelect = document.getElementById('productSubcategory');
            
            productCategorySelect.innerHTML = '<option value="">Select from your chosen categories</option>';
            productSubcategorySelect.innerHTML = '<option value="">Select a subcategory</option>';
            
            const businessCategory = document.getElementById('category').value;
            if (!businessCategory || !businessCategories[businessCategory]) return;
            
            const categoryData = businessCategories[businessCategory];
            
            selectedCategories.forEach(categoryKey => {
                const category = categoryData.categories[categoryKey];
                if (category) {
                    productCategorySelect.innerHTML += `<option value="${categoryKey}">${category.name}</option>`;
                }
            });
            
            productCategorySelect.onchange = function() {
                const selectedCat = this.value;
                productSubcategorySelect.innerHTML = '<option value="">Select a subcategory</option>';
                
                if (selectedCat && categoryData.categories[selectedCat]) {
                    const category = categoryData.categories[selectedCat];
                    category.subcategories.forEach(subcategoryKey => {
                        const subcategoryName = subcategoryNames[subcategoryKey] || subcategoryKey.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
                        productSubcategorySelect.innerHTML += `<option value="${subcategoryKey}">${subcategoryName}</option>`;
                    });
                }
            };
        }

        async function proceedToProducts() {
            if (selectedCategories.length === 0) {
                showNotification('Please select at least one category', 'error');
                return;
            }
            
            showNotification(`Moving to products with ${selectedCategories.length} categories...`, 'info');
            setTimeout(() => showScreen('products'), 1000);
        }

        async function addProduct() {
            const name = document.getElementById('productName').value.trim();
            const price = document.getElementById('productPrice').value.trim();
            const description = document.getElementById('productDescription').value.trim();
            const categoryKey = document.getElementById('productCategory').value;
            const subcategoryKey = document.getElementById('productSubcategory').value;
            const imageUrl = document.getElementById('productImage').value.trim();
            
            if (!name || !price || !description || !categoryKey) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            if (isNaN(price) || price <= 0) {
                showNotification('Please enter a valid price', 'error');
                return;
            }
            
            const product = {
                name, price: parseFloat(price), description, categoryKey,
                subcategoryKey: subcategoryKey || null,
                imageUrl: imageUrl || getDefaultProductImage(),
                createdAt: new Date().toISOString()
            };
            
            userProducts.push(product);
            
            if (currentUserId) {
                const productDbData = {
                    user_id: currentUserId, name, price: parseFloat(price), description,
                    image_url: imageUrl || null
                };
                
                const productResult = await saveToSupabase(productDbData, 'products');
                if (productResult.success) {
                    showNotification(`‚úÖ "${name}" saved!`, 'success');
                } else {
                    showNotification(`‚ö†Ô∏è "${name}" saved locally`, 'warning');
                }
            }
            
            // Clear form
            ['productName', 'productPrice', 'productDescription', 'productCategory', 'productSubcategory', 'productImage'].forEach(id => {
                document.getElementById(id).value = '';
            });
            
            displayProducts();
            calculateLeadScore();
        }

        function getDefaultProductImage() {
            return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjFmNWY5Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNjM2NjcwIiBmb250LWZhbWlseT0iYXJpYWwiIGZvbnQtc2l6ZT0iNDAiPvCfk6Y8L3RleHQ+PC9zdmc+';
        }

        function displayProducts() {
            const productsList = document.getElementById('productsList');
            const productCount = document.getElementById('productCount');
            
            productCount.textContent = userProducts.length;
            
            if (userProducts.length === 0) {
                productsList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #64748b; background: rgba(255, 255, 255, 0.5); border-radius: 12px;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üì¶</div>
                        <p>No products added yet. Add your first product above!</p>
                    </div>
                `;
                return;
            }
            
            const businessCategory = document.getElementById('category').value;
            const categoryData = businessCategories[businessCategory];
            
            productsList.innerHTML = userProducts.map(product => {
                const categoryName = categoryData?.categories[product.categoryKey]?.name || product.categoryKey;
                const subcategoryName = product.subcategoryKey ? 
                    (subcategoryNames[product.subcategoryKey] || product.subcategoryKey) : '';
                
                return `
                    <div class="product-card">
                        <div class="product-image" style="background-image: url('${product.imageUrl}');">
                            <div class="product-price">‚Çπ${product.price.toLocaleString()}</div>
                        </div>
                        <div class="product-content">
                            <div class="product-name">${product.name}</div>
                            <div class="product-description">${product.description}</div>
                            <div style="display: flex; justify-content: space-between; font-size: 0.7rem; color: #64748b; margin-top: 0.5rem;">
                                <span>üìÅ ${categoryName}</span>
                                ${subcategoryName ? `<span>üè∑Ô∏è ${subcategoryName}</span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function proceedToThemes() {
            if (userProducts.length === 0) {
                showNotification('Please add at least one product first', 'warning');
                return;
            }
            
            showNotification('Loading themes...', 'info');
            setTimeout(() => {
                showScreen('themes');
                populateThemePreviews();
            }, 1000);
        }

        function selectTheme(themeName, element) {
            selectedTheme = themeName;
            
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            const themeNames = {
                'modern': 'Modern & Minimalist',
                'vibrant': 'Colorful & Vibrant', 
                'professional': 'Professional & Corporate',
                'traditional': 'Traditional & Classic',
                'creative': 'Creative & Artistic',
                'luxury': 'Elegant & Luxury'
            };
            
            document.getElementById('selectedThemeName').textContent = themeNames[themeName];
            
            const nextBtn = document.getElementById('themeNextBtn');
            nextBtn.disabled = false;
            nextBtn.style.opacity = '1';
            
            showNotification(`Theme: ${themeNames[themeName]}`, 'success');
            calculateLeadScore();
        }

        function populateThemePreviews() {
            const themePreviewIds = ['modern-preview', 'vibrant-preview', 'professional-preview', 'traditional-preview', 'creative-preview', 'luxury-preview'];
            
            if (userProducts.length === 0) {
                themePreviewIds.forEach(previewId => {
                    const previewEl = document.getElementById(previewId);
                    if (previewEl) {
                        previewEl.innerHTML = `
                            <div class="theme-preview-item">Sample Product</div>
                            <div class="theme-preview-item">‚Çπ999</div>
                        `;
                    }
                });
                return;
            }
            
            const previewProducts = userProducts.slice(0, 2);
            
            themePreviewIds.forEach(previewId => {
                const previewEl = document.getElementById(previewId);
                if (previewEl) {
                    previewEl.innerHTML = previewProducts.map(product => 
                        `<div class="theme-preview-item">
                            <div style="font-weight: 600; margin-bottom: 2px; font-size: 0.7rem;">${product.name.substring(0, 12)}${product.name.length > 12 ? '...' : ''}</div>
                            <div style="color: #059669; font-weight: bold; font-size: 0.7rem;">‚Çπ${product.price.toLocaleString()}</div>
                        </div>`
                    ).join('');
                }
            });
        }

        async function completeSetup() {
            const finalScore = calculateLeadScore() + 10;
            
            const leadData = {
                user_id: currentUserId,
                name: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phoneNumber').value,
                business_name: document.getElementById('businessName').value,
                selected_goals: selectedGoals,
                selected_categories: selectedCategories,
                products_count: userProducts.length,
                selected_theme: selectedTheme,
                qualifying_answers: qualifyingAnswers,
                lead_score: finalScore,
                lead_quality: finalScore >= 70 ? 'Hot' : finalScore >= 40 ? 'Warm' : 'Cold',
                setup_completed: true,
                completed_at: new Date().toISOString()
            };
            
            const existingLeads = JSON.parse(localStorage.getItem('topiko_local_leads') || '[]');
            existingLeads.push(leadData);
            localStorage.setItem('topiko_local_leads', JSON.stringify(existingLeads));
            
            showNotification('üéâ Setup completed successfully!', 'success');
            
            setTimeout(() => {
                showCompletionSummary(finalScore);
            }, 2000);
        }

        function showCompletionSummary(finalScore) {
            const completionHTML = `
                <div class="content-card" style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 1rem; animation: bounce 2s infinite;">üéâ</div>
                    
                    <h2 style="color: #059669; font-size: 2rem; font-weight: 700; margin-bottom: 1rem;">
                        Setup Complete!
                    </h2>
                    
                    <p style="color: #064e3b; font-size: 1rem; margin-bottom: 2rem;">
                        Your business profile is ready and you can start growing!
                    </p>

                    <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 16px; padding: 1.5rem; margin: 1.5rem 0;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                            <div style="background: rgba(255, 255, 255, 0.8); padding: 1rem; border-radius: 12px;">
                                <div style="font-size: 1.5rem; margin-bottom: 0.3rem;">üéØ</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: #059669;">${finalScore}</div>
                                <div style="color: #064e3b; font-size: 0.8rem;">Lead Score</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.8); padding: 1rem; border-radius: 12px;">
                                <div style="font-size: 1.5rem; margin-bottom: 0.3rem;">üì¶</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: #059669;">${userProducts.length}</div>
                                <div style="color: #064e3b; font-size: 0.8rem;">Products</div>
                            </div>
                        </div>

                        <div style="background: rgba(34, 197, 94, 0.15); border-radius: 12px; padding: 1rem; text-align: left; font-size: 0.85rem;">
                            <h4 style="color: #059669; margin-bottom: 0.8rem;">üöÄ What's Next?</h4>
                            <p style="color: #064e3b; margin-bottom: 0.5rem;">‚úÖ Profile is live and searchable</p>
                            <p style="color: #064e3b; margin-bottom: 0.5rem;">‚úÖ Sales team will contact you within 24 hours</p>
                            <p style="color: #064e3b;">‚úÖ Start attracting customers immediately</p>
                        </div>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="goToDashboard()" class="submit-button">
                            View Dashboard üìä
                        </button>
                        <button onclick="startOver()" class="btn-secondary">
                            Start Another üîÑ
                        </button>
                    </div>
                </div>
            `;
            
            const themesScreen = document.getElementById('themes');
            themesScreen.innerHTML = completionHTML;
        }

        function goToDashboard() {
            showNotification('Redirecting to dashboard...', 'info');
            setTimeout(() => {
                window.location.href = './crm.html';
            }, 1500);
        }

        function startOver() {
            selectedGoals = [];
            selectedLanguage = 'en';
            selectedCategories = [];
            selectedSubcategories = [];
            userProducts = [];
            currentUserId = null;
            selectedTheme = null;
            pageViews = 1;
            leadScore = 0;
            formProgress = 0;
            sessionStartTime = Date.now();
            currentStep = 'welcome';
            qualifyingAnswers = { online_presence: '', budget: '', decision_maker: '', timeline: '' };
            
            const formFields = ['fullName', 'email', 'phoneNumber', 'businessName', 'address', 'businessType', 'category'];
            formFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) field.value = '';
            });
            
            document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(input => {
                input.checked = false;
            });
            
            updateLeadScoreWidget();
            showNotification('Form reset! Starting fresh...', 'info');
            setTimeout(() => showScreen('welcome'), 1000);
        }

        // üì¢ NOTIFICATION SYSTEM
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const content = document.getElementById('notificationContent');
            
            if (!notification || !content) {
                console.log(`Notification: ${message}`);
                return;
            }
            
            content.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // üéØ FOMO FUNCTIONS
        function getRandomBusinessData() {
            const business = indianBusinessNames[Math.floor(Math.random() * indianBusinessNames.length)];
            const city = indianCities[Math.floor(Math.random() * indianCities.length)];
            const template = fomoMessageTemplates[Math.floor(Math.random() * fomoMessageTemplates.length)];
            
            return {
                business, city, template,
                message: template.text.replace('{business}', business).replace('{city}', city)
            };
        }

        function showFomoNotification() {
            if (Date.now() - lastFomoShow < 10000) return;
            
            const fomoEl = document.getElementById('fomoNotification');
            const contentEl = document.getElementById('fomoContent');
            const timeEl = document.getElementById('fomoTime');
            const statusEl = document.querySelector('.fomo-status');
            
            if (!fomoEl || !contentEl || !timeEl || !statusEl) return;
            
            const data = getRandomBusinessData();
            
            contentEl.innerHTML = `<span class="business-name">${data.business}</span> from <span class="business-location">${data.city}</span> ${data.template.text.split('{business}')[1].split('{city}')[1]}`;
            timeEl.textContent = `${Math.floor(Math.random() * 15) + 1} minutes ago`;
            statusEl.textContent = data.template.status;
            
            fomoEl.classList.add('show');
            lastFomoShow = Date.now();
            
            setTimeout(() => {
                fomoEl.classList.remove('show');
                fomoEl.classList.add('hide');
                setTimeout(() => fomoEl.classList.remove('hide'), 500);
            }, 5000);
            
            businessCounter += Math.floor(Math.random() * 3) + 1;
            updateBusinessCounter();
        }

        function updateBusinessCounter() {
            const counterEl = document.getElementById('counterNumber');
            if (counterEl) {
                counterEl.textContent = businessCounter.toLocaleString();
            }
        }

        function showBusinessCounter() {
            const counterEl = document.getElementById('fomoCounter');
            if (counterEl) {
                counterEl.classList.add('show');
                setTimeout(() => counterEl.classList.remove('show'), 4000);
            }
        }

        function startFomoSystem() {
            setTimeout(() => showFomoNotification(), 8000);
            setTimeout(() => showBusinessCounter(), 15000);
            
            setInterval(() => {
                const randomDelay = Math.random() * 20000 + 25000;
                setTimeout(() => showFomoNotification(), randomDelay);
            }, 45000);
            
            setInterval(() => showBusinessCounter(), 90000);
        }

        // üöÄ INITIALIZATION
        function initializeApp() {
            addDebugLog('üöÄ Mobile-responsive Topiko Lead Form initializing', 'info');
            
            testDatabaseConnection();
            updateLeadScoreWidget();
            pageViews = 1;
            sessionStartTime = Date.now();
            updateProgressBar(currentStep);
            
            setTimeout(() => startFomoSystem(), 3000);
            
            addDebugLog('‚úÖ Mobile app initialized successfully', 'success');
        }

        // üéØ EVENT LISTENERS
        document.addEventListener('DOMContentLoaded', function() {
            addDebugLog('üì± DOM loaded - starting mobile app');
            initializeApp();
            
            setInterval(() => {
                updateLeadScoreWidget();
                
                if (currentUserId || selectedGoals.length > 0) {
                    const currentData = {
                        selectedGoals, selectedLanguage, selectedCategories, selectedSubcategories,
                        userProducts, selectedTheme, qualifyingAnswers, leadScore, formProgress,
                        sessionStartTime, currentStep, lastSaved: Date.now()
                    };
                    localStorage.setItem('topiko_current_session', JSON.stringify(currentData));
                }
            }, 30000);
        });

        window.addEventListener('beforeunload', function(e) {
            const currentData = {
                selectedGoals, selectedLanguage, selectedCategories, selectedSubcategories,
                userProducts, selectedTheme, qualifyingAnswers, leadScore, formProgress,
                sessionStartTime, currentStep, lastSaved: Date.now()
            };
            localStorage.setItem('topiko_current_session', JSON.stringify(currentData));
        });

        window.addEventListener('error', function(e) {
            addDebugLog(`‚ùå Error: ${e.error?.message || e.message}`, 'error');
        });

        addDebugLog('üì± Mobile-responsive Topiko Lead Form loaded', 'success');
        console.log('üì± Mobile-Responsive Topiko Lead Form Ready');
        console.log('üéØ Features: Clickable progress bar, simplified score widget, mobile-first design');

        // üÜï MODAL FUNCTIONS
function showModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('show');
        addDebugLog(`üì± Modal shown: ${modalId}`);
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.remove('show');
        addDebugLog(`üì± Modal closed: ${modalId}`);
    }
}

// Close modal when clicking outside
document.addEventListener('click', function(e) {
    if (e.target.classList.contains('modal-overlay')) {
        e.target.classList.remove('show');
    }
});

// üÜï GOALS TRANSITION MODAL FUNCTIONS
function displayGoalsTransitionModal() {
    const goalNames = {
        ecommerce: 'üõí Sell Online',
        customers: 'üìà Reach More Customers', 
        manage: 'üë• Manage Customers',
        search: 'üîç Appear in Search Results',
        brand: '‚≠ê Establish Brand'
    };

    const modalGoalsList = document.getElementById('modalGoalsList');
    modalGoalsList.innerHTML = selectedGoals.map(goal => 
        `<div class="goal-pill">${goalNames[goal] || goal}</div>`
    ).join('');
    
    showModal('goalsTransitionModal');
    addDebugLog(`Goals transition modal shown for: ${selectedGoals.join(', ')}`);
}

function proceedFromGoalsModal() {
    closeModal('goalsTransitionModal');
    setTimeout(() => showScreen('registration'), 500);
}

// üÜï SETUP INTRO MODAL FUNCTIONS  
function displaySetupIntroModal() {
    const goalNames = {
        ecommerce: 'üõí Sell Online',
        customers: 'üìà Reach More Customers', 
        manage: 'üë• Manage Customers',
        search: 'üîç Appear in Search Results',
        brand: '‚≠ê Establish Brand'
    };

    const modalSetupGoalsList = document.getElementById('modalSetupGoalsList');
    modalSetupGoalsList.innerHTML = selectedGoals.map(goal => 
        `<div style="background: rgba(34, 197, 94, 0.15); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 8px; padding: 0.8rem; color: #059669; font-weight: 600; font-size: 0.9rem; text-align: center;">
            ${goalNames[goal] || goal}
        </div>`
    ).join('');
    
    showModal('setupIntroModal');
    addDebugLog(`Setup intro modal shown for: ${selectedGoals.join(', ')}`);
}

function proceedFromSetupModal() {
    closeModal('setupIntroModal');
    setTimeout(() => showScreen('qualifying-questions'), 500);
}
        
    </script> 
    <!-- üÜï GOALS TRANSITION MODAL -->
<div class="modal-overlay" id="goalsTransitionModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('goalsTransitionModal')">√ó</button>
        
        <div style="text-align: center;">
            <div style="font-size: 3rem; margin-bottom: 1rem; animation: bounce 2s infinite;" id="celebrationEmoji">üéØ</div>
            
            <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem; line-height: 1.3;">
                Excellent! You've selected the options most important for Business Growth
            </h2>
            
            <p style="color: #553c9a; font-size: 1rem; font-weight: 500; margin-bottom: 1.5rem; line-height: 1.4;">
                These strategic choices will accelerate your business success!
            </p>

            <div style="background: rgba(139, 111, 205, 0.1); border: 2px solid rgba(139, 111, 205, 0.2); border-radius: 12px; padding: 1rem; margin: 1rem 0;">
                <h3 style="color: #6b46c1; font-size: 1rem; font-weight: 600; margin-bottom: 1rem;">üéØ Your Selected Goals:</h3>
                <div style="text-align: center;" id="modalGoalsList">
                    <!-- Goals will be populated here -->
                </div>
            </div>

            <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0; color: #059669; font-weight: 600; font-size: 0.9rem; text-align: center;">
                üöÄ Over 4,500 businesses launched this month alone!
            </div>

            <button class="submit-button" onclick="proceedFromGoalsModal()" style="animation: pulse 2s infinite; margin-top: 1rem;">
                Let's Get Started! üöÄ
            </button>
        </div>
    </div>
</div>

<!-- üÜï SETUP INTRO MODAL -->
<div class="modal-overlay" id="setupIntroModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('setupIntroModal')">√ó</button>
        
        <div style="text-align: center;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">‚ú®</div>
            
            <h2 style="color: #059669; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;">
                Great, we got your details!
            </h2>
            
            <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.2); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;">
                <p style="color: #059669; font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem;">
                    Just give us 5 more minutes, <br>We'll show you how your business can look online.
                </p>
                <p style="color: #064e3b; font-size: 0.95rem; margin-bottom: 1rem;">
                    Try for free. No pressure. No obligation. See it first. Decide later! 
                </p>
                
                <div id="modalSetupGoalsList" style="display: flex; flex-direction: column; gap: 0.6rem;">
                    <!-- Goals will be populated here -->
                </div>
            </div>

            <button class="submit-button" onclick="proceedFromSetupModal()" style="animation: pulse 2s infinite; font-size: 1.1rem;">
                Let's Do This! üéØ
            </button>
        </div>
    </div>
</div>
</body>
</html>
