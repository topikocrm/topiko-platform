<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topiko - Complete Business Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="css/styles_css.css">
</head>
<body>
    <!-- Back Button -->
    <div class="back-button hidden" id="backButton" onclick="goBack()">
        ‚Üê
    </div>

    <!-- Error Display -->
    <div class="error-display" id="errorDisplay">
        <div id="errorContent"></div>
    </div>

    <!-- Debug Toggle -->
    <button class="debug-toggle" onclick="toggleDebugPanel()">üîç</button>

    <!-- Debug Panel -->
    <div class="debug-panel" id="debugPanel">
        <h4>üîç Debug Log</h4>
        <div id="debugLog"></div>
    </div>

    <!-- Lead Score Widget -->
    <div class="lead-score-widget" id="leadWidget" onclick="toggleScoreDetails()">
        <div class="score-circle cold" id="leadScoreCircle">
            <span id="leadScoreValue">0</span>
        </div>
        <div class="score-label" id="scoreLabel">Score</div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div id="notificationContent"></div>
    </div>

    <!-- FOMO Notification System -->
    <div class="fomo-notification" id="fomoNotification" style="position: fixed; bottom: 20px; left: 20px; transform: translateX(-400px); z-index: 999; max-width: 320px; transition: all 0.5s ease;">
        <div class="fomo-header">
            <div class="fomo-icon"></div>
            <div class="fomo-status">New Member</div>
        </div>
        <div class="fomo-content" id="fomoContent">
            <span class="business-name">TrendyWear Collection</span> from <span class="business-location">Pune</span> joined our platform with help of Topiko
        </div>
        <div class="fomo-time" id="fomoTime">5 minutes ago</div>
    </div>

    <!-- FOMO Counter -->
    <div class="fomo-counter" id="fomoCounter">
        <span class="counter-number" id="counterNumber">247</span>
        <span class="counter-text">joined in<br>last 24 hours</span>
    </div>

    <div class="app-container">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">
                <div class="progress-step" data-step="goals" onclick="navigateToStep('goals')">
                    <div class="progress-circle">1</div>
                    <div class="progress-label" data-translate="progress.businessGoals">Business Goals</div>
                </div>
                <div class="progress-step" data-step="registration" onclick="navigateToStep('registration')">
                    <div class="progress-circle">2</div>
                    <div class="progress-label" data-translate="progress.signUp">Sign Up</div>
                </div>
                <div class="progress-step" data-step="qualifying-questions" onclick="navigateToStep('qualifying-questions')">
                    <div class="progress-circle">3</div>
                    <div class="progress-label" data-translate="progress.successFactors">Success Factors</div>
                </div>
                <div class="progress-step" data-step="categories" onclick="navigateToStep('categories')">
                    <div class="progress-circle">4</div>
                    <div class="progress-label" data-translate="progress.businessLive1">Business Live-1</div>
                </div>
                <div class="progress-step" data-step="products" onclick="navigateToStep('products')">
                    <div class="progress-circle">5</div>
                    <div class="progress-label" data-translate="progress.businessLive2">Business Live-2</div>
                </div>
                <div class="progress-step" data-step="themes" onclick="navigateToStep('themes')">
                    <div class="progress-circle">6</div>
                    <div class="progress-label" data-translate="progress.businessLive3">Business Live-3</div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Welcome Screen -->
            <section class="screen active" id="welcome">
                <div class="welcome-screen">
                    <h1 class="topiko-logo">Topiko CRM</h1>
                    <p style="font-size: 1.1rem; color: #6b46c1; margin-bottom: 2rem;" 
                       data-translate="welcome.tagline">Complete Business Platform for Indian small SMBs</p>
                    <button class="try-free-button" onclick="startLeadFlow()" 
                            data-translate="welcome.tryFreeButton">
                        Try for Free
                    </button>
                </div>
            </section>

            <!-- Language Selection Screen -->
            <section class="screen" id="language">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" 
                        data-translate="language.title">Choose Your Language</h2>
                    <p style="text-align: center; margin-bottom: 2rem; font-size: 0.9rem;" 
                       data-translate="language.subtitle">‡§Ö‡§™‡§®‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç | ‡∞Æ‡±Ä ‡∞≠‡∞æ‡∞∑‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø | ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡§°‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç</p>
                    
                    <div class="language-grid">
                        <div class="language-option" onclick="selectLanguageWithTranslation('en', this)">
                            <div class="language-flag">üá¨üáß</div>
                            <div class="language-content">
                                <h3>English</h3>
                                <p data-translate="language.options.en">Continue in English</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguageWithTranslation('hi', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</h3>
                                <p data-translate="language.options.hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguageWithTranslation('te', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</h3>
                                <p data-translate="language.options.te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å‡∞≤‡±ã ‡∞ï‡±ä‡∞®‡∞∏‡∞æ‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø</p>
                            </div>
                        </div>

                        <div class="language-option" onclick="selectLanguageWithTranslation('ta', this)">
                            <div class="language-flag">üáÆüá≥</div>
                            <div class="language-content">
                                <h3>‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</h3>
                                <p data-translate="language.options.ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡¶∞‡™µ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Goals Selection Screen -->
            <section class="screen" id="goals">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" 
                        data-translate="goals.title">Select Your Goals</h2>
                    <p style="text-align: center; margin-bottom: 2rem;" 
                       data-translate="goals.subtitle">Choose what you want to achieve with Topiko (select all that apply)</p>
                    
                    <div class="goals-grid">
                        <div class="goal-option">
                            <input type="checkbox" id="goal-ecommerce" value="ecommerce" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-ecommerce" class="goal-card">
                                <div class="goal-icon">üõí</div>
                                <div class="goal-content">
                                    <h3 data-translate="goals.options.ecommerce.title">Sell Online (E-commerce)</h3>
                                    <p data-translate="goals.options.ecommerce.description">Start selling your products online with a complete e-commerce solution</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-customers" value="customers" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-customers" class="goal-card">
                                <div class="goal-icon">üìà</div>
                                <div class="goal-content">
                                    <h3 data-translate="goals.options.customers.title">Reach More Customers</h3>
                                    <p data-translate="goals.options.customers.description">Expand your customer base and grow your market reach</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-manage" value="manage" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-manage" class="goal-card">
                                <div class="goal-icon">üë•</div>
                                <div class="goal-content">
                                    <h3 data-translate="goals.options.manage.title">Manage Customers</h3>
                                    <p data-translate="goals.options.manage.description">Keep track of your customers and build lasting relationships</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-search" value="search" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-search" class="goal-card">
                                <div class="goal-icon">üîç</div>
                                <div class="goal-content">
                                    <h3 data-translate="goals.options.search.title">Appear in Search Results</h3>
                                    <p data-translate="goals.options.search.description">Improve your online visibility and get found by potential customers</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>

                        <div class="goal-option">
                            <input type="checkbox" id="goal-brand" value="brand" class="goal-checkbox" onchange="updateGoalsTracking()">
                            <label for="goal-brand" class="goal-card">
                                <div class="goal-icon">‚≠ê</div>
                                <div class="goal-content">
                                    <h3 data-translate="goals.options.brand.title">Establish my Brand</h3>
                                    <p data-translate="goals.options.brand.description">Build a strong brand presence and professional image online</p>
                                </div>
                                <div class="goal-checkmark">‚úì</div>
                            </label>
                        </div>
                    </div>

                    <button class="submit-button" onclick="showGoalsTransitionModal()" 
                            data-translate="goals.nextButton">
                        Next Step
                    </button>
                </div>
            </section>

            <!-- Registration Screen -->
            <section class="screen" id="registration">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" 
                        data-translate="registration.title">Get Started with Topiko</h2>
                    <p style="text-align: center; margin-bottom: 2rem;" 
                       data-translate="registration.subtitle">Tell us about your business to create your free account</p>
                    
                    <div class="form-group">
                        <label for="fullName" data-translate="registration.fields.fullName.label">Your Name</label>
                        <input type="text" id="fullName" 
                               data-translate="registration.fields.fullName.placeholder" 
                               placeholder="Enter your full name" 
                               oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="email" data-translate="registration.fields.email.label">Email Address</label>
                        <input type="email" id="email" 
                               data-translate="registration.fields.email.placeholder"
                               placeholder="Enter your email address" 
                               oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="phoneNumber" data-translate="registration.fields.phoneNumber.label">Phone Number</label>
                        <input type="tel" id="phoneNumber" 
                               data-translate="registration.fields.phoneNumber.placeholder"
                               placeholder="Enter your phone number" 
                               oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="businessName" data-translate="registration.fields.businessName.label">Business Name</label>
                        <input type="text" id="businessName" 
                               data-translate="registration.fields.businessName.placeholder"
                               placeholder="Enter your business name" 
                               oninput="trackFormProgress()">
                    </div>

                    <div class="form-group">
                        <label for="address" data-translate="registration.fields.address.label">Address</label>
                        <textarea id="address" rows="3" 
                                  data-translate="registration.fields.address.placeholder"
                                  placeholder="Enter your business address" 
                                  oninput="trackFormProgress()"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="businessType" data-translate="registration.fields.businessType.label">Business Type</label>
                        <select id="businessType" onchange="trackFormProgress()">
                            <option value="" data-translate="registration.fields.businessType.placeholder">Select your business type</option>
                            <option value="startup" data-translate="registration.fields.businessType.options.startup">Startup</option>
                            <option value="small-business" data-translate="registration.fields.businessType.options.smallBusiness">Small Business</option>
                            <option value="medium-enterprise" data-translate="registration.fields.businessType.options.mediumEnterprise">Medium Enterprise</option>
                            <option value="large-enterprise" data-translate="registration.fields.businessType.options.largeEnterprise">Large Enterprise</option>
                            <option value="freelancer" data-translate="registration.fields.businessType.options.freelancer">Freelancer</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="category" data-translate="registration.fields.category.label">Business Category</label>
                        <select id="category" onchange="trackFormProgress()">
                            <option value="" data-translate="registration.fields.category.placeholder">Select your business category</option>
                            <option value="boutique">üè™ Boutique & Fashion</option>
                            <option value="home-foods">üçõ Home Foods & Catering</option>
                            <option value="salons">üíÑ Salons & Beauty</option>
                            <option value="grocery">üõí Grocery & Provisions</option>
                            <option value="furniture">üõãÔ∏è Furniture & Home Decor</option>
                            <option value="electronics">üì± Electronics & Gadgets</option>
                            <option value="jewellery">üíç Jewellery & Accessories</option>
                            <option value="restaurants">üçΩÔ∏è Restaurants & Cafes</option>
                            <option value="fitness">üí™ Fitness & Wellness</option>
                            <option value="education">üìö Education & Training</option>
                            <option value="automotive">üöó Automotive Services</option>
                            <option value="healthcare">üè• Healthcare Services</option>
                            <option value="professional">üíº Professional Services</option>
                            <option value="arts-crafts">üé® Arts & Crafts</option>
                            <option value="travel">‚úàÔ∏è Travel & Tourism</option>
                            <option value="pet-services">üêæ Pet Services & Supplies</option>
                            <option value="real-estate">üè† Real Estate Services</option>
                            <option value="event-services">üéâ Event & Wedding Services</option>
                            <option value="agriculture">üåæ Agriculture & Farming</option>
                            <option value="others">üîß Others</option>
                        </select>
                    </div>

                    <button class="submit-button" onclick="submitRegistration()" 
                            data-translate="registration.submitButton">
                        Show my Business online
                    </button>
                </div>
            </section>

            <!-- Qualifying Questions Screen -->
            <section class="screen" id="qualifying-questions">
                <div class="content-card">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;" 
                            id="qualifyingTitle" data-translate="qualifying.title">
                            Let's setup things for you
                        </h2>
                        <p style="color: #553c9a; font-size: 1rem; font-weight: 500;" 
                           data-translate="qualifying.subtitle">
                            Just need a couple of details about your business
                        </p>
                    </div>

                    <!-- Question 1: Online Presence -->
                    <div class="qualifying-question">
                        <h3 data-translate="qualifying.questions.onlinePresence.title">Do you currently have any online presence?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="presence-none" name="online_presence" value="none" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-none" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.onlinePresence.options.none">No online presence at all</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-whatsapp" name="online_presence" value="whatsapp" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-whatsapp" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.onlinePresence.options.whatsapp">Only WhatsApp Business</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-social" name="online_presence" value="social" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-social" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.onlinePresence.options.social">Social media pages (Facebook/Instagram)</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-basic" name="online_presence" value="basic_website" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-basic" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.onlinePresence.options.basicWebsite">Basic website</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="presence-full" name="online_presence" value="full_website" class="radio-input" onchange="updateQualifyingData()">
                                <label for="presence-full" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.onlinePresence.options.fullWebsite">Full website with online ordering</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 2: Budget -->
                    <div class="qualifying-question">
                        <h3 data-translate="qualifying.questions.budget.title">To meet your business goals, how much budget can you allocate per year?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="budget-low" name="budget" value="5000-10000" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-low" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.budget.options.low">‚Çπ5,000 to ‚Çπ10,000</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="budget-medium" name="budget" value="10000-25000" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-medium" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.budget.options.medium">‚Çπ10,000 to ‚Çπ25,000</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="budget-high" name="budget" value="25000+" class="radio-input" onchange="updateQualifyingData()">
                                <label for="budget-high" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.budget.options.high">More than ‚Çπ25,000</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 3: Decision Maker -->
                    <div class="qualifying-question">
                        <h3 data-translate="qualifying.questions.decisionMaker.title">Are you the decision maker for your business?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="decision-yes" name="decision_maker" value="yes" class="radio-input" onchange="updateQualifyingData()">
                                <label for="decision-yes" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.decisionMaker.options.yes">Yes</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="decision-no" name="decision_maker" value="no" class="radio-input" onchange="updateQualifyingData()">
                                <label for="decision-no" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.decisionMaker.options.no">No</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4: Timeline -->
                    <div class="qualifying-question">
                        <h3 data-translate="qualifying.questions.timeline.title">How soon do you want to get started?</h3>
                        <div class="radio-options">
                            <div class="radio-option">
                                <input type="radio" id="timeline-immediate" name="timeline" value="immediately" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-immediate" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.timeline.options.immediately">Immediately</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-week" name="timeline" value="within_week" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-week" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.timeline.options.withinWeek">Within a week</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-month" name="timeline" value="this_month" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-month" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.timeline.options.thisMonth">This month</span>
                                </label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="timeline-checking" name="timeline" value="just_checking" class="radio-input" onchange="updateQualifyingData()">
                                <label for="timeline-checking" class="radio-card">
                                    <div class="radio-icon"></div>
                                    <span data-translate="qualifying.questions.timeline.options.justChecking">Just checking</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <button class="submit-button" onclick="proceedToCategories()" 
                            id="qualifyingNextBtn" disabled style="opacity: 0.5;"
                            data-translate="qualifying.nextButton">
                        Create my Business üöÄ
                    </button>
                </div>
            </section>

            <!-- Categories Screen -->
            <section class="screen" id="categories">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" 
                        id="categoriesTitle" data-translate="categories.title">Select Your Business Categories</h2>
                    <p style="text-align: center; margin-bottom: 2rem;" 
                       data-translate="categories.subtitle">Choose specific categories and subcategories that best describe your business</p>
                    
                    <!-- Selection Summary -->
                    <div class="selection-summary" id="selectionSummary" style="display: none;">
                        <div style="display: flex; gap: 2rem; align-items: flex-start;">
                            <div style="flex: 1;">
                                <div class="summary-title" data-translate="categories.selectionSummary.title">üìä Your Selection Summary</div>
                                <div class="summary-content">
                                    <div class="summary-item">
                                        <span data-translate="categories.selectionSummary.categories">Categories: </span>
                                        <span class="summary-count" id="categoriesCount">0</span>
                                    </div>
                                    <div class="summary-item">
                                        <span data-translate="categories.selectionSummary.subcategories">Subcategories: </span>
                                        <span class="summary-count" id="subcategoriesCount">0</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Dynamic Motivational Messages -->
                            <div class="motivational-messages" id="motivationalMessages" style="min-width: 280px; max-width: 300px; height: 120px; background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border: 2px solid #10b981; border-radius: 12px; padding: 1rem; position: relative; overflow: hidden;">
                                <div class="motivational-message active loading">
                                    üîÑ Loading personalized messages for Perfect...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="categoriesContainer">
                        <!-- Categories will be populated dynamically -->
                    </div>

                    <button class="submit-button" onclick="proceedToProducts()" 
                            id="categoryNextBtn" disabled data-translate="categories.nextButton">
                        Continue to Add Products
                    </button>
                </div>
            </section>

            <!-- Products Screen -->
            <section class="screen" id="products">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" 
                        id="productsTitle" data-translate="products.title">Add Your Products</h2>
                    <p style="text-align: center; margin-bottom: 2rem;" 
                       data-translate="products.subtitle">Choose products or add your own custom products</p>
                    
                    <!-- Help Section -->
                    <div class="products-help-section" id="productsHelpSection" onclick="requestFollowup()">
                        <div class="help-title" id="productsHelpTitle" 
                             data-translate="products.helpSection.title">üéØ Free Professional Setup Available!</div>
                        <div class="help-progress">
                            <div class="help-progress-fill" id="productsHelpProgressFill"></div>
                        </div>
                        <div class="help-text" id="productsHelpText">
                            <span data-translate="products.helpSection.text" 
                                  data-translate-vars='{"count": "47", "month": "January"}'>Topiko is helping with free setup for 75 businesses every month. 47 claimed for January. Click here for help!</span>
                        </div>
                    </div>

                    <!-- Product Selection Mode Toggle -->
                    <div class="product-mode-toggle">
                        <div class="toggle-options">
                            <button class="toggle-option active" id="selectMode" onclick="switchProductMode('select')">
                                <span class="toggle-icon">üõçÔ∏è</span>
                                <span data-translate="products.modes.select">Select Products</span>
                            </button>
                            <button class="toggle-option" id="customMode" onclick="switchProductMode('custom')">
                                <span class="toggle-icon">‚ûï</span>
                                <span data-translate="products.modes.custom">Add Custom Product</span>
                            </button>
                        </div>
                    </div>

                    <!-- Product Selector Section -->
                    <div class="product-selector-section" id="productSelectorSection">
                        
                        <!-- Helper Buttons -->
                        <div class="product-helpers">
                            <button onclick="selectPopularProducts()" class="helper-btn">
                                <span data-translate="products.helpers.selectPopular">‚ú® Select Popular Items</span>
                            </button>
                            <button onclick="clearAllSelections()" class="helper-btn secondary">
                                <span data-translate="products.helpers.clearAll">üóëÔ∏è Clear All</span>
                            </button>
                        </div>
                        
                        <!-- Quick Filters with proper container structure -->
                        <div class="quick-filters-container" id="quickFiltersContainer">
                            <div class="quick-filters" id="quickFilters">
                                <button class="quick-filter active" data-category="all" onclick="applyQuickFilter('all', this)">All Products</button>
                                <button class="quick-filter" data-category="boutique" onclick="applyQuickFilter('boutique', this)">Fashion</button>
                                <button class="quick-filter" data-category="homefoods" onclick="applyQuickFilter('homefoods', this)">Home Foods</button>
                                <button class="quick-filter" data-category="grocery" onclick="applyQuickFilter('grocery', this)">Grocery</button>
                                <button class="quick-filter" data-category="electronics" onclick="applyQuickFilter('electronics', this)">Electronics</button>
                                <button class="quick-filter" data-category="fitness" onclick="applyQuickFilter('fitness', this)">Fitness</button>
                                <button class="quick-filter" data-category="restaurant" onclick="applyQuickFilter('restaurant', this)">Restaurant</button>
                            </div>
                        </div>
                        
                        <!-- Search & Filter Controls -->
                        <div class="product-controls">
                            <div class="search-box">
                                <input type="text" id="productSearch" 
                                       data-translate="products.filters.search" 
                                       placeholder="Search products..." />
                                <span class="search-icon">üîç</span>
                            </div>
                            
                            <select id="categoryFilter" class="filter-select">
                                <option value="all" data-translate="products.filters.allCategories">All Categories</option>
                                <option value="boutique">Boutique & Fashion</option>
                                <option value="homefoods">Home Foods</option>
                                <option value="grocery">Grocery & Provisions</option>
                                <option value="electronics">Electronics & Gadgets</option>
                                <option value="fitness">Fitness & Wellness</option>
                                <option value="restaurant">Restaurant & Food</option>
                            </select>
                            
                            <select id="sortBy" class="sort-select">
                                <option value="name" data-translate="products.filters.sortByName">Sort by Name</option>
                                <option value="price-low" data-translate="products.filters.sortByPriceLow">Price: Low to High</option>
                                <option value="price-high" data-translate="products.filters.sortByPriceHigh">Price: High to Low</option>
                                <option value="category" data-translate="products.filters.sortByCategory">Category</option>
                            </select>
                            
                            <div class="products-count">
                                <span id="productsCount">500</span> products
                            </div>
                        </div>

                        <!-- Price Range -->
                        <div class="price-range">
                            <label>Price Range: ‚Çπ<span id="priceRangeDisplay">0 - ‚Çπ5000</span></label>
                            <div class="price-inputs">
                                <input type="number" id="minPrice" placeholder="Min" value="0" min="0" max="5000">
                                <span>to</span>
                                <input type="number" id="maxPrice" placeholder="Max" value="5000" min="0" max="5000">
                            </div>
                        </div>
                        
                        <!-- Products Grid -->
                        <div class="products-grid with-variants" id="productsGrid">
                            <div class="loading" data-translate="common.loading">Loading products...</div>
                        </div>
                    </div>

                    <!-- Custom Product Form (Modified to be toggleable) -->
                    <div class="product-form" id="customProductForm" style="display: none;">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;" 
                            id="productFormTitle" data-translate="products.customForm.title">Add Custom Product/Service</h3>
                        
                        <div class="form-group">
                            <label for="productName" data-translate="products.customForm.fields.name.label">Product/Service Name</label>
                            <input type="text" id="productName" 
                                   data-translate="products.customForm.fields.name.placeholder"
                                   placeholder="e.g., Cotton Kurta, Masala Dosa, Haircut">
                        </div>
                        
                        <div class="form-group">
                            <label for="productPrice" data-translate="products.customForm.fields.price.label">Price (‚Çπ)</label>
                            <input type="number" id="productPrice" 
                                   data-translate="products.customForm.fields.price.placeholder"
                                   placeholder="e.g., 899">
                        </div>

                        <div class="form-group">
                            <label for="productCategory" data-translate="products.customForm.fields.category.label">Category</label>
                            <select id="productCategory">
                                <option value="" data-translate="products.customForm.fields.category.placeholder">Select from your chosen categories</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="productSubcategory" data-translate="products.customForm.fields.subcategory.label">Subcategory (Optional)</label>
                            <select id="productSubcategory">
                                <option value="" data-translate="products.customForm.fields.subcategory.placeholder">Select a subcategory</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productDescription" data-translate="products.customForm.fields.description.label">Description</label>
                            <textarea id="productDescription" rows="3" 
                                      data-translate="products.customForm.fields.description.placeholder"
                                      placeholder="Brief description of your product or service"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="productImage" data-translate="products.customForm.fields.imageUrl.label">Product Image URL (optional)</label>
                            <input type="url" id="productImage" 
                                   data-translate="products.customForm.fields.imageUrl.placeholder"
                                   placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <button type="button" onclick="addCustomProduct()" 
                                class="btn-secondary" style="width: auto; margin-top: 1rem;"
                                data-translate="products.customForm.addButton">
                            ‚ûï Add Custom Product
                        </button>
                    </div>

                    <!-- Selected Products Summary -->
                    <div class="selected-products-summary" id="selectedProductsSection" style="display: none;">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;">
                            <span style="margin-right: 0.5rem;">üéØ</span>
                            <span data-translate="products.selectedProducts.title" 
                                  data-translate-vars='{"count": "0"}'>Selected Products (0)</span>
                        </h3>
                        <div id="selectedProductsList"></div>
                    </div>

                 <!-- Products List (now shows all selected products) 
                    <div class="products-list">
                        <h3 style="color: #6b46c1; margin-bottom: 1rem; font-size: 1.1rem;">
                            <span data-translate="products.selectedProducts.catalogTitle" 
                                  data-translate-vars='{"count": "0"}'>Your Product Catalog (0)</span>
                        </h3>
                        
                        <div class="product-grid" id="productsList">
                            <div style="text-align: center; padding: 2rem; color: #64748b; background: rgba(255, 255, 255, 0.5); border-radius: 12px;">
                                <div style="font-size: 3rem; margin-bottom: 1rem;">üì¶</div>
                                <p data-translate="products.selectedProducts.emptyMessage">No products selected yet. Choose products above or add custom products!</p>
                            </div>
                        </div>
                    </div> -->

                    <!-- Navigation buttons -->
                    <div class="flex-buttons">
                        <button onclick="navigateToStep('categories')" class="btn-secondary">
                            <span data-translate="products.navigation.backButton">‚Üê Back to Categories</span>
                        </button>
                        <button onclick="proceedToThemes()" class="submit-button">
                            <span data-translate="products.navigation.nextButton">Choose Theme üé®</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Theme Selection Screen -->
            <section class="screen" id="themes">
                <div class="content-card">
                    <h2 style="text-align: center; margin-bottom: 0.5rem;" 
                        id="themesTitle" data-translate="themes.title">Choose Your Business Theme</h2>
                    <p style="text-align: center; margin-bottom: 2rem;" 
                       data-translate="themes.subtitle">Select a theme that represents your business style. See how your products will look!</p>
                    
                    <div class="theme-grid">
                        <!-- Modern & Minimalist Theme -->
                        <!-- Modern & Minimalist Theme -->
                        <div class="theme-option" onclick="selectTheme('modern', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">‚ú®</span>
                                    <span data-translate="themes.options.modern.title">Modern & Minimalist</span>
                                </h3>
                                <p data-translate="themes.options.modern.description">Clean, simple design that focuses on your products</p>
                            </div>
                            <div class="theme-preview">
                                <img src="images/themes/modern.jpg" alt="Modern Theme Preview" class="theme-image" id="modern-preview">
                            </div>
                        </div>

                        <!-- Colorful & Vibrant Theme -->
                        <!-- Colorful & Vibrant Theme -->
                            <div class="theme-option" onclick="selectTheme('vibrant', this)">
                                <div class="theme-header">
                                    <h3>
                                        <span style="margin-right: 0.5rem;">üåà</span>
                                        <span data-translate="themes.options.vibrant.title">Colorful & Vibrant</span>
                                    </h3>
                                    <p data-translate="themes.options.vibrant.description">Bold colors and energetic design to attract customers</p>
                                </div>
                                <div class="theme-preview">
                                    <img src="images/themes/vibrant.jpg" alt="Vibrant Theme Preview" class="theme-image" id="vibrant-preview">
                                </div>
                            </div>

                       <!-- Professional & Corporate Theme -->
                            <div class="theme-option" onclick="selectTheme('professional', this)">
                                <div class="theme-header">
                                    <h3>
                                        <span style="margin-right: 0.5rem;">üíº</span>
                                        <span data-translate="themes.options.professional.title">Professional & Corporate</span>
                                    </h3>
                                    <p data-translate="themes.options.professional.description">Sophisticated design that builds trust and credibility</p>
                                </div>
                                <div class="theme-preview">
                                    <img src="images/themes/professional.jpg" alt="Professional Theme Preview" class="theme-image" id="professional-preview">
                                </div>
                            </div>

                       <!-- Traditional & Classic Theme -->
                            <div class="theme-option" onclick="selectTheme('traditional', this)">
                                <div class="theme-header">
                                    <h3>
                                        <span style="margin-right: 0.5rem;">üèõÔ∏è</span>
                                        <span data-translate="themes.options.traditional.title">Traditional & Classic</span>
                                    </h3>
                                    <p data-translate="themes.options.traditional.description">Timeless design with warm, welcoming feel</p>
                                </div>
                                <div class="theme-preview">
                                    <img src="images/themes/traditional.jpg" alt="Traditional Theme Preview" class="theme-image" id="traditional-preview">
                                </div>
                            </div>

                     <!-- Creative & Artistic Theme -->
                            <div class="theme-option" onclick="selectTheme('creative', this)">
                                <div class="theme-header">
                                    <h3>
                                        <span style="margin-right: 0.5rem;">üé®</span>
                                        <span data-translate="themes.options.creative.title">Creative & Artistic</span>
                                    </h3>
                                    <p data-translate="themes.options.creative.description">Unique, artistic design that showcases creativity</p>
                                </div>
                                <div class="theme-preview">
                                    <img src="images/themes/creative.jpg" alt="Creative Theme Preview" class="theme-image" id="creative-preview">
                                </div>
                            </div>

                        <!-- Elegant & Luxury Theme -->
                       <!-- Elegant & Luxury Theme -->
                        <div class="theme-option" onclick="selectTheme('luxury', this)">
                            <div class="theme-header">
                                <h3>
                                    <span style="margin-right: 0.5rem;">üíé</span>
                                    <span data-translate="themes.options.luxury.title">Elegant & Luxury</span>
                                </h3>
                                <p data-translate="themes.options.luxury.description">Premium design for high-end products and services</p>
                            </div>
                            <div class="theme-preview">
                                <img src="images/themes/luxury.jpg" alt="Luxury Theme Preview" class="theme-image" id="luxury-preview">
                            </div>
                        </div>

                    <div style="text-align: center; margin: 1.5rem 0; display: none;" id="selectedThemeDisplay">
                        <p style="color: #6b7280; font-size: 0.8rem; margin-bottom: 1rem;">
                            <span id="selectedThemeName">No theme selected</span> | 
                            <span data-translate="themes.note">You can change this anytime later</span>
                        </p>
                    </div>

                    <div class="flex-buttons">
                        <button onclick="navigateToStep('products')" class="btn-secondary">
                            <span data-translate="themes.navigation.backButton">‚Üê Back to Products</span>
                        </button>
                            <!-- NEW PREVIEW BUTTON -->
                            <button onclick="generatePreviewData()" class="btn-secondary" id="previewDataBtn">
                                <span>üîç Preview Data</span>
                            </button>
                        <button onclick="completeSetup()" id="themeNextBtn" disabled style="opacity: 0.5;">
                            <span data-translate="themes.navigation.nextButton">Complete Setup üöÄ</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- COMPLETION SCREEN - FIXED VERSION WITH WORKING OFFERS -->
            <section class="screen" id="completion">
                <div class="content-card">
                    <div style="text-align: center;">
                        <div style="font-size: 4rem; margin-bottom: 1rem; animation: bounce 2s infinite;">üéâ</div>
                        
                        <h2 style="color: #059669; font-size: 2.2rem; font-weight: 700; margin-bottom: 1rem;"
                            data-translate="completion.title" data-translate-vars='{"businessName": "Your Business"}'>
                            Congratulations, <span id="completionBusinessName">Your Business</span> is all set for the final touches!
                        </h2>
                        
                        <p style="color: #064e3b; font-size: 1.1rem; margin-bottom: 2rem; line-height: 1.6;"
                           data-translate="completion.subtitle">
                            Your business setup is complete! Our team will now create your professional online presence.
                        </p>

                        <!-- TODAY'S SPECIAL OFFERS SECTION - SELECTABLE -->
                        <div class="offers-section-background">
                            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem;">
                                <div style="font-size: 2rem; margin-right: 0.5rem;">üéÅ</div>
                                <h3 style="color: #d97706; font-size: 1.4rem; margin: 0; font-weight: 700;"
                                   data-translate="completion.offers.title">Choose Your FREE Bonus Offer!</h3>
                            </div>
                            
                            <p style="color: #92400e; font-size: 0.9rem; margin-bottom: 1.5rem;"
                               data-translate="completion.offers.subtitle">Select one offer that interests you most:</p>
                            
                            <!-- Selectable Offers Container -->
                            <div id="specialOffersContainer">
                                <!-- Offers will be populated here by JavaScript -->
                                <div class="special-offer-item">
                                    <div class="offer-title">
                                        üéÅ Loading Special Offers...
                                        <span class="offer-value">FREE</span>
                                    </div>
                                    <div class="offer-description">Preparing personalized offers for your business</div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0; color: #059669; font-weight: 600; font-size: 0.9rem; text-align: center;">
                                <span data-translate="completion.offers.timer" data-translate-vars='{"time": "23:45:12"}'>üî• Limited Time: These offers expire in 23:45:12</span>
                            </div>

                            <!-- Selected Offer Display -->
                            <div id="selectedOfferDisplay" style="display: none; background: rgba(34, 197, 94, 0.1); border: 2px solid #10b981; border-radius: 12px; padding: 1rem; margin: 1rem 0;">
                                <div style="display: flex; align-items: center; justify-content: center; color: #047857; font-weight: 600; font-size: 0.9rem;">
                                    ‚úÖ Selected: <span id="selectedOfferName" style="margin-left: 0.5rem; font-weight: 700;"></span>
                                </div>
                            </div>
                        </div>

                        <!-- NEXT STEP ACTIONS -->
                        <div style="background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border: 2px solid #6366f1; border-radius: 16px; padding: 2rem; margin: 2rem 0;">
                            <h3 style="color: #4338ca; font-size: 1.3rem; margin-bottom: 1rem;"
                               data-translate="completion.actions.title">üéØ How would you like to proceed?</h3>
                            
                            <div style="display: grid; gap: 1rem;">
                                <button class="action-button claim-offer-btn" onclick="openCallScheduler()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 1.25rem; border: none; border-radius: 12px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s ease;">
                                    <span data-translate="completion.actions.scheduleCall.title">üìû Book a Call to Claim My Selected Offer</span>
                                    <div style="font-size: 0.8rem; opacity: 0.9; margin-top: 0.25rem;"
                                         data-translate="completion.actions.scheduleCall.subtitle">Schedule a convenient time with our team</div>
                                </button>
                                
                                <button class="action-button explore-btn" onclick="openExploreForm()" style="background: linear-gradient(135deg, #6366f1, #4f46e5); color: white; padding: 1.25rem; border: none; border-radius: 12px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s ease;">
                                    <span data-translate="completion.actions.explore.title">üöÄ I want to explore on my own</span>
                                    <div style="font-size: 0.8rem; opacity: 0.9; margin-top: 0.25rem;"
                                         data-translate="completion.actions.explore.subtitle">Tell us what you're looking for</div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODALS HTML STRUCTURES -->
    
    <!-- Goals Transition Modal -->
    <div class="modal-overlay" id="goalsTransitionModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('goalsTransitionModal')">√ó</button>
            
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem; animation: bounce 2s infinite;">üéØ</div>
                
                <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem; line-height: 1.3;"
                   data-translate="modals.goalsTransition.title">
                    Great! Your goals are set.
                </h2>
                
                <p style="color: #553c9a; font-size: 1rem; font-weight: 500; margin-bottom: 1.5rem; line-height: 1.6;">
                    <span data-translate="modals.goalsTransition.subtitle" data-translate-vars='{"goals": "your selected goals"}'>Now let's show you how Topiko can help with your selected goals for your business ‚Äî one step at a time</span>
                    <span id="selectedGoalsInlineText" style="display: block; margin: 0.5rem 0; color: #6b46c1; font-weight: 600;">your selected goals</span>
                </p>

                <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.3); border-radius: 12px; padding: 1rem; margin: 1rem 0; color: #059669; font-weight: 600; font-size: 0.9rem; text-align: left; line-height: 1.8;">
                    Topiko helped 5,500+ businesses reach their goals last month ‚Äî let's do the same for yours! 
                    
                    <div style="margin-top: 0.8rem; display: flex; flex-direction: column; gap: 0.3rem;">
                        <div style="display: flex; align-items: center;">
                            <span style="margin-right: 0.5rem;">‚ú®</span>
                            <span data-translate="modals.goalsTransition.benefits.0">No technical knowledge needed</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <span style="margin-right: 0.5rem;">‚úÖ</span>
                            <span data-translate="modals.goalsTransition.benefits.1">ZERO obligation to continue</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <span style="margin-right: 0.5rem;">üß™</span>
                            <span data-translate="modals.goalsTransition.benefits.2">Try before you decide</span>
                        </div>
                    </div>
                </div>

                <button class="submit-button" onclick="proceedFromGoalsModal()" 
                        style="animation: pulse 2s infinite; margin-top: 1rem;"
                        data-translate="modals.goalsTransition.button">
                    Get My Free Setup! üöÄ
                </button>
            </div>
        </div>
    </div>

    <!-- Setup Intro Modal -->
    <div class="modal-overlay" id="setupIntroModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('setupIntroModal')">√ó</button>
            
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚ú®</div>
                
                <h2 style="color: #059669; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;"
                   data-translate="modals.setupIntro.title" data-translate-vars='{"name": "there"}'>
                    Excellent, <span id="setupUserName">there</span>! üéâ
                </h2>
                
                <div style="background: rgba(34, 197, 94, 0.1); border: 2px solid rgba(34, 197, 94, 0.2); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;">
                    <p style="color: #059669; font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem;"
                       data-translate="modals.setupIntro.subtitle" data-translate-vars='{"business": "business"}'>
                        In just 3 simple steps, we'll show you exactly how your <span id="setupBusinessName">business</span> can look and work online ‚Äî the Topiko way!
                    </p>
                    <p style="color: #064e3b; font-size: 0.95rem; margin-bottom: 0;"
                       data-translate="modals.setupIntro.note">
                        üî• Businesses like yours are going live every hour ‚Äî don't miss the momentum!
                    </p>
                </div>

                <button class="submit-button" onclick="proceedFromSetupModal()" 
                        style="animation: pulse 2s infinite; font-size: 1.1rem;"
                        data-translate="modals.setupIntro.button">
                    Let's Create Something Amazing! üéØ
                </button>
            </div>
        </div>
    </div>

    <!-- OTP Verification Modal -->
    <div class="modal-overlay" id="otpVerificationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('otpVerificationModal')">√ó</button>
            
            <div style="text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üì±</div>
                
                <h2 style="color: #6b46c1; font-size: 1.8rem; font-weight: 700; margin-bottom: 1rem;"
                   data-translate="modals.otpVerification.title">
                    Verify Your Phone Number
                </h2>
                
                <p style="color: #553c9a; font-size: 1rem; margin-bottom: 1.5rem;"
                   data-translate="modals.otpVerification.subtitle">
                    We've sent a 4-digit code to your phone. Enter it below to secure your account.
                </p>

                <div class="otp-input-group">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 0)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 1)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 2)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                    <input type="text" class="otp-input" maxlength="1" oninput="handleOtpInput(this, 3)" onkeyup="if(event.key==='Backspace' && !this.value && this.previousElementSibling) this.previousElementSibling.focus()">
                </div>

                <p style="color: #6b7280; font-size: 0.8rem; margin-bottom: 1.5rem;">
                    <span data-translate="modals.otpVerification.resend">Didn't receive the code? Resend OTP</span>
                </p>

                <button class="submit-button" id="verifyOtpBtn" onclick="verifyOtp()" 
                        disabled style="opacity: 0.5;"
                        data-translate="modals.otpVerification.button">
                    Verify & Continue
                </button>
            </div>
        </div>
    </div>

    <!-- Enhanced Call Scheduler Modal -->
    <div class="modal-overlay" id="dateTimeModal">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('dateTimeModal')">√ó</button>
            
            <div style="text-align: center; margin-bottom: 2rem;">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">üìÖ</div>
                <h3 style="color: #6b46c1; margin-bottom: 0.5rem;"
                   data-translate="modals.callScheduler.title">Schedule Your Call to Claim Offer</h3>
                <div id="schedulerSelectedOffer" style="background: rgba(16, 185, 129, 0.1); border: 1px solid #10b981; border-radius: 8px; padding: 0.75rem; margin: 1rem 0; color: #047857; font-weight: 600; font-size: 0.9rem;">
                    Selected Offer: <span id="schedulerOfferName">Free Logo Design</span>
                </div>
                <p style="color: #64748b; font-size: 0.9rem;"
                   data-translate="modals.callScheduler.subtitle">Select a convenient time for our team to contact you:</p>
            </div>
            
            <div class="time-slots-grid" id="timeSlotsGrid">
                <!-- Today -->
                <div class="time-slot" onclick="selectTimeSlot(this, 'today-10am')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.today">Today</div>
                    <div class="slot-time">10:00 AM</div>
                </div>
                <div class="time-slot" onclick="selectTimeSlot(this, 'today-2pm')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.today">Today</div>
                    <div class="slot-time">2:00 PM</div>
                </div>
                <div class="time-slot" onclick="selectTimeSlot(this, 'today-4pm')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.today">Today</div>
                    <div class="slot-time">4:00 PM</div>
                </div>
                
                <!-- Tomorrow -->
                <div class="time-slot" onclick="selectTimeSlot(this, 'tomorrow-9am')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.tomorrow">Tomorrow</div>
                    <div class="slot-time">9:00 AM</div>
                </div>
                <div class="time-slot" onclick="selectTimeSlot(this, 'tomorrow-11am')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.tomorrow">Tomorrow</div>
                    <div class="slot-time">11:00 AM</div>
                </div>
                <div class="time-slot" onclick="selectTimeSlot(this, 'tomorrow-3pm')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.tomorrow">Tomorrow</div>
                    <div class="slot-time">3:00 PM</div>
                </div>
                
                <!-- Day After Tomorrow -->
                <div class="time-slot" onclick="selectTimeSlot(this, 'dayafter-10am')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.dayAfter">Day After</div>
                    <div class="slot-time">10:00 AM</div>
                </div>
                <div class="time-slot" onclick="selectTimeSlot(this, 'dayafter-1pm')">
                    <div class="slot-date" data-translate="modals.callScheduler.timeSlots.dayAfter">Day After</div>
                    <div class="slot-time">1:00 PM</div>
                </div>
            </div>
            
            <div style="margin-top: 2rem; text-align: center; display: flex; gap: 1rem;">
                <button onclick="confirmScheduleAndComplete()" id="confirmScheduleBtn" disabled 
                        style="flex: 1; background: #10b981; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; opacity: 0.5; font-weight: 600;"
                        data-translate="modals.callScheduler.button">
                    Complete & Schedule Call
                </button>
                <button onclick="closeModal('dateTimeModal')" 
                        style="flex: 1; background: #64748b; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;"
                        data-translate="modals.callScheduler.close">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Enhanced Explore Form Modal -->
    <div class="modal-overlay" id="reasonModal">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('reasonModal')">√ó</button>
            
            <div style="text-align: center; margin-bottom: 2rem;">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">üí≠</div>
                <h3 style="color: #6b46c1; margin-bottom: 1rem;"
                   data-translate="modals.exploreForm.title">Tell us what you're looking for</h3>
                <p style="color: #64748b; font-size: 0.9rem;"
                   data-translate="modals.exploreForm.subtitle">Help us understand your business needs better:</p>
            </div>
            
            <div class="reason-options" style="margin-bottom: 1.5rem;">
                <div class="reason-option" onclick="selectReason('budget', this)">
                    <div class="reason-icon">üí∞</div>
                    <div class="reason-text" data-translate="modals.exploreForm.reasons.budget">Budget considerations</div>
                </div>
                <div class="reason-option" onclick="selectReason('timing', this)">
                    <div class="reason-icon">‚è∞</div>
                    <div class="reason-text" data-translate="modals.exploreForm.reasons.timing">Need more time to decide</div>
                </div>
                <div class="reason-option" onclick="selectReason('looking_else', this)">
                    <div class="reason-icon">üîç</div>
                    <div class="reason-text" data-translate="modals.exploreForm.reasons.lookingElse">Looking for something specific</div>
                </div>
                <div class="reason-option" onclick="selectReason('just_browsing', this)">
                    <div class="reason-icon">üëÄ</div>
                    <div class="reason-text" data-translate="modals.exploreForm.reasons.justBrowsing">Just browsing for now</div>
                </div>
            </div>
            
            <!-- Comment section for specific needs -->
            <div id="reasonComments" style="margin-bottom: 1.5rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #374151; font-weight: 500;"
                       data-translate="modals.exploreForm.commentLabel">Additional details (optional):</label>
                <textarea id="reasonText" rows="3" 
                          style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; resize: vertical; font-family: inherit;"
                          data-translate="modals.exploreForm.commentPlaceholder"
                          placeholder="Tell us more about what you're looking for..."></textarea>
            </div>
            
            <div style="text-align: center; display: flex; gap: 1rem;">
                <button onclick="submitReasonAndComplete()" id="submitReasonBtn" 
                        style="flex: 1; background: #6366f1; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;"
                        data-translate="modals.exploreForm.button">
                    Complete Submission
                </button>
                <button onclick="closeModal('reasonModal')" 
                        style="flex: 1; background: #64748b; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;"
                        data-translate="modals.exploreForm.close">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- SCRIPT LOADING ORDER - CRITICAL -->
    <script src="js/config_js.js"></script>     <!-- FIRST - Configuration -->
    <script src="js/utils_js.js"></script>      <!-- SECOND - Utilities -->  
    <script src="translations.js"></script>     <!-- THIRD - Translation System -->
    <script src="js/script_js.js"></script>     <!-- FOURTH - Main Application -->

    <!-- Additional Initialization Script -->
    <script>
    // Additional initialization and safety checks
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üîß Running HTML compatibility fixes...');
        
        // Fix 1: Ensure completion screen business name is populated
        setTimeout(() => {
            const completionBusinessName = document.getElementById('completionBusinessName');
            if (completionBusinessName && window.topikoApp && window.topikoApp.businessName) {
                completionBusinessName.textContent = window.topikoApp.businessName;
            }
        }, 1000);
        
        // Fix 2: Initialize product mode correctly
        setTimeout(() => {
            if (typeof switchProductMode === 'function') {
                try {
                    switchProductMode('select');
                    console.log('‚úÖ Product mode initialized');
                } catch (error) {
                    console.warn('‚ö†Ô∏è Product mode initialization failed:', error);
                }
            }
        }, 2000);
        
        // Fix 3: Initialize translations
        if (window.TopikoTranslations && window.TopikoTranslations.initializeTranslations) {
            window.TopikoTranslations.initializeTranslations();
            console.log('‚úÖ Translation system initialized');
        }
        
        console.log('‚úÖ HTML compatibility fixes completed');
    });

    // Global function to close modals
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('show');
        }
    }

    // Update lead score widget to ensure text displays
    function updateLeadScoreWidget() {
        const scoreValue = document.getElementById('leadScoreValue');
        const scoreLabel = document.getElementById('scoreLabel');
        if (scoreValue && !scoreValue.textContent) {
            scoreValue.textContent = '0';
        }
        if (scoreLabel && !scoreLabel.textContent) {
            scoreLabel.textContent = 'Score';
        }
    }

    // Update goals display in modal to show inline with line breaks
    function updateGoalsModal(selectedGoals) {
        const goalsInlineText = document.getElementById('selectedGoalsInlineText');
        if (goalsInlineText && selectedGoals && selectedGoals.length > 0) {
            const goalIcons = {
                'ecommerce': 'üõí Sell Online',
                'customers': 'üìà Reach More Customers', 
                'manage': 'üë• Manage Customers',
                'search': 'üîç Appear in Search Results',
                'brand': '‚≠ê Establish Brand'
            };
            
            // Create goals with line breaks
            const goalsText = selectedGoals.map(goal => goalIcons[goal] || goal).join('<br>');
            goalsInlineText.innerHTML = goalsText;
        }
    }

    // FOMO notification auto-show/hide functionality
    function initializeFOMONotifications() {
        const fomoNotification = document.getElementById('fomoNotification');
        if (!fomoNotification) return;

        // Show FOMO notification initially after 3 seconds
        setTimeout(() => {
            fomoNotification.style.transform = 'translateX(0)';
            
            // Hide after 5 seconds
            setTimeout(() => {
                fomoNotification.style.transform = 'translateX(-400px)';
                
                // Show again every 30 seconds
                setInterval(() => {
                    fomoNotification.style.transform = 'translateX(0)';
                    setTimeout(() => {
                        fomoNotification.style.transform = 'translateX(-400px)';
                    }, 5000);
                }, 30000);
                
            }, 5000);
        }, 3000);
    }

    // Initialize categories when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        // Load categories when categories screen is shown
        const originalShowScreen = window.TopikoUtils?.showScreen;
        if (originalShowScreen) {
            window.TopikoUtils.showScreen = function(screenId) {
                originalShowScreen.call(this, screenId);
                if (screenId === 'categories') {
                    setTimeout(() => loadCategories(), 100);
                }
            };
        }
        
        // Initialize lead score widget text
        updateLeadScoreWidget();
        
        // Initialize FOMO notifications
        initializeFOMONotifications();
    });
    </script>
    <!-- Add this script right before </body> tag in lead-form.html -->
<script>
// EMERGENCY FIX for selectLanguageWithTranslation function
console.log('üö® Loading emergency language selection fix...');

// Check if function exists in TopikoTranslations
if (window.TopikoTranslations && window.TopikoTranslations.selectLanguageWithTranslation) {
    console.log('‚úÖ Found function in TopikoTranslations, making it global');
    window.selectLanguageWithTranslation = window.TopikoTranslations.selectLanguageWithTranslation;
} else {
    console.log('‚ö†Ô∏è Creating emergency selectLanguageWithTranslation function');
    
    // Emergency implementation
    window.selectLanguageWithTranslation = function(lang, element) {
        console.log('üö® Emergency language selection:', lang);
        
        try {
            // Basic validation
            if (!lang || !element) {
                console.error('Missing parameters');
                return;
            }
            
            // Update UI
            document.querySelectorAll('.language-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // Set language if TopikoTranslations is available
            if (window.TopikoTranslations && window.TopikoTranslations.setLanguage) {
                window.TopikoTranslations.setLanguage(lang);
            }
            
            // Store selection
            if (!window.topikoApp) window.topikoApp = {};
            window.topikoApp.selectedLanguage = lang;
            
            // Simple text updates for Hindi
            if (lang === 'hi') {
                setTimeout(() => {
                    // Update key elements manually
                    const tagline = document.querySelector('[data-translate="welcome.tagline"]');
                    if (tagline) {
                        tagline.textContent = '‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø SMBs ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡•â‡§∞‡•ç‡§Æ';
                    }
                    
                    const tryButton = document.querySelector('[data-translate="welcome.tryFreeButton"]');
                    if (tryButton) {
                        tryButton.textContent = '‡§Æ‡•Å‡§´‡•ç‡§§ ‡§Æ‡•á‡§Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç';
                    }
                }, 100);
            }
            
            // Navigate to goals screen
            setTimeout(() => {
                if (window.TopikoUtils && window.TopikoUtils.showScreen) {
                    window.TopikoUtils.showScreen('goals');
                } else {
                    // Manual navigation
                    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                    const goalsScreen = document.getElementById('goals');
                    if (goalsScreen) {
                        goalsScreen.classList.add('active');
                    }
                }
            }, 1500);
            
            console.log('‚úÖ Emergency language selection completed');
            
        } catch (error) {
            console.error('‚ùå Emergency function error:', error);
        }
    };
}

// Test the function
setTimeout(() => {
    if (typeof selectLanguageWithTranslation === 'function') {
        console.log('‚úÖ selectLanguageWithTranslation is now available globally');
    } else {
        console.error('‚ùå selectLanguageWithTranslation still not available');
    }
}, 2000);
</script>
</body>
</html>
